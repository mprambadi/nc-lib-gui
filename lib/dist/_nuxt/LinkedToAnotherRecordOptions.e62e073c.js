import{o as a,c as n,a as p,f as W,a5 as X,bb as Y,r as M,bF as Z,M as J,gY as K,g as R,gZ as ee,cG as te,b as m,w as r,ae as w,O as l,d as u,t as i,U as d,V as U,P as k,Q as le,W as ae,T as A,a0 as oe,a1 as ne,g_ as se}from"./entry.96205fa0.js";import{_ as ie}from"./TableIcon.vue.03001c7d.js";import{_ as re}from"./Tooltip.vue.00c0d0fb.js";import{b as ue,M as de}from"./EditOrAddProvider.vue.8b187915.js";import{M as me}from"./index.9b87fcff.js";import{a as pe}from"./bases.965a49bb.js";import{R as ce,_ as ve}from"./index.10eee714.js";import{C as fe}from"./index.0b4c0f1e.js";import{_ as _e}from"./FormItem.9f1f85f2.js";import{S as he,_ as ye}from"./index.b5e393d6.js";import"./Icon.vue.6d0583a0.js";import"./Button.vue.02ce6d5b.js";import"./index.9e8f59f4.js";import"./debounce.1d5af9bf.js";import"./toNumber.ed208f2f.js";import"./isSymbol.d46b4957.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./views.2c163cf7.js";import"./useSharedView.9e320acb.js";import"./validation.64563eeb.js";import"./index.0c5b3837.js";import"./index.886d43e1.js";import"./useSize.c98e621d.js";import"./identity.309e9ead.js";import"./_flatRest.ce557a88.js";import"./isPlainObject.631eb8fb.js";import"./_getPrototype.459a70cf.js";import"./FormItemContext.b19eb48c.js";import"./vuedraggable.umd.5a03c14e.js";import"./v3-infinite-loading.e5e5dc2d.js";import"./index.6c1d17b6.js";import"./Dropdown.1dedd322.js";import"./RightOutlined.3ce786f5.js";import"./index.1431a68b.js";import"./Input.3f1aaf0c.js";import"./antInputDirective.8ac36ea7.js";import"./SearchOutlined.c9794270.js";import"./TextArea.b81a19ed.js";import"./Password.803cc3dc.js";import"./cell.810c4fd3.js";import"./Checkbox.cf2cdba0.js";import"./createForOfIteratorHelper.f2005dfe.js";import"./Col.b3c5d725.js";import"./responsiveObserve.358bcfe9.js";import"./toArray.3561b70e.js";import"./isMobile.e2e89480.js";import"./useMemo.dbc63a5f.js";import"./useState.5a301439.js";import"./CheckOutlined.3b90c20d.js";const ke={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ce=p("path",{fill:"currentColor",d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m1 5h-2v4H7v2h4v4h2v-4h4v-2h-4z"},null,-1),Te=[Ce];function be(c,I){return a(),n("svg",ke,[...Te])}const ge={name:"mdi-plus-circle-outline",render:be},$e=oe(()=>ne(()=>import("./LinkOptions.6c8d0be8.js"),["./LinkOptions.6c8d0be8.js","./entry.96205fa0.js","./entry.d09b2482.css","./EditOrAddProvider.vue.8b187915.js","./Icon.vue.6d0583a0.js","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./views.2c163cf7.js","./bases.965a49bb.js","./index.0c5b3837.js","./useSharedView.9e320acb.js","./validation.64563eeb.js","./index.886d43e1.js","./FormItem.9f1f85f2.js","./identity.309e9ead.js","./_getPrototype.459a70cf.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./toArray.3561b70e.js","./FormItemContext.b19eb48c.js","./useSize.c98e621d.js","./_flatRest.ce557a88.js","./isPlainObject.631eb8fb.js","./vuedraggable.umd.5a03c14e.js","./v3-infinite-loading.e5e5dc2d.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./RightOutlined.3ce786f5.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c9794270.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./cell.810c4fd3.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./index.b5e393d6.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./useState.5a301439.js","./CheckOutlined.3b90c20d.js","./EditOrAddProvider.9247d0ff.css","./index.208c1883.js"],import.meta.url).then(c=>c.default||c)),we={class:"w-full flex flex-col mb-2 mt-4"},Ue={class:"border-2 p-6"},Ae={class:"flex w-full items-center gap-2"},Ie={class:"min-w-5 flex items-center justify-center"},De={key:0,class:"flex flex-col p-6 gap-4 border-2 mt-2"},Ee={class:"flex flex-row space-x-2"},Le={class:"flex flex-row"},Dt=W({__name:"LinkedToAnotherRecordOptions",props:{value:{}},emits:["update:value"],setup(c,{emit:I}){var L,S,N;const e=X(c,"value",I),_=Y(me,M()),{setAdditionalValidations:x,validateInfos:C,onDataTypeChange:h,sqlUi:D,isXcdbBase:E}=ue(),B=pe(),{tables:T}=Z(B),{t:V}=J();x({childId:[{required:!0,message:V("general.required")}]});const y=D===se?["NO ACTION"]:["NO ACTION","CASCADE","RESTRICT","SET NULL","SET DEFAULT"];e.value.parentId||(e.value.parentId=(L=_.value)==null?void 0:L.id),e.value.childId||(e.value.childId=null),e.value.childColumn||(e.value.childColumn=`${(S=_.value)==null?void 0:S.table_name}_id`),e.value.childTable||(e.value.childTable=(N=_.value)==null?void 0:N.table_name),e.value.parentTable||(e.value.parentTable=e.value.rtn||""),e.value.parentColumn||(e.value.parentColumn=e.value.rcn||""),e.value.type||(e.value.type="mm"),e.value.onUpdate||(e.value.onUpdate=y[0]),e.value.onDelete||(e.value.onDelete=y[0]),e.value.virtual||(e.value.virtual=D===K),e.value.alias||(e.value.alias=e.value.column_name);const v=M(!1),q=R(()=>!T.value||!T.value.length?[]:T.value.filter(o=>{var s;return o.type===ee.TABLE&&o.source_id===((s=_.value)==null?void 0:s.source_id)})),F=(o,s)=>s.key.toLowerCase().includes(o.toLowerCase()),P=R(()=>e.value.uidt===te.Links);return(o,s)=>{const O=ce,j=ve,f=_e,z=ie,G=re,b=he,g=ye,H=$e,Q=fe;return a(),n("div",we,[p("div",Ue,[m(f,w(l(C).type,{class:"nc-ltar-relation-type"}),{default:r(()=>[m(j,w({value:l(e).type,"onUpdate:value":s[0]||(s[0]=t=>l(e).type=t),name:"type"},l(C).type),{default:r(()=>[m(O,{value:"hm"},{default:r(()=>[u(i(o.$t("title.hasMany")),1)]),_:1}),m(O,{value:"mm"},{default:r(()=>[u(i(o.$t("title.manyToMany")),1)]),_:1})]),_:1},16,["value"])]),_:1},16),m(f,w({class:"flex w-full pb-2 mt-4 nc-ltar-child-table",label:o.$t("labels.childTable")},l(C).childId),{default:r(()=>[m(g,{value:l(e).childId,"onUpdate:value":s[1]||(s[1]=t=>l(e).childId=t),"show-search":"","filter-option":F,"dropdown-class-name":"nc-dropdown-ltar-child-table",onChange:l(h)},{default:r(()=>[(a(!0),n(d,null,U(l(q),t=>(a(),k(b,{key:t.title,value:t.id},{default:r(()=>[p("div",Ae,[p("div",Ie,[m(z,{meta:t,class:"text-gray-500"},null,8,["meta"])]),m(G,{class:"flex-1 truncate","show-on-truncate-only":""},{title:r(()=>[u(i(t.title),1)]),default:r(()=>[p("span",null,i(t.title),1)]),_:2},1024)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1},16,["label"])]),!l(E)||l(P)?(a(),n(d,{key:0},[p("div",{class:"text-xs cursor-pointer text-grey nc-more-options my-2 flex items-center gap-1 justify-end",onClick:s[2]||(s[2]=t=>v.value=!l(v))},[u(i(l(v)?o.$t("general.hideAll"):o.$t("general.showMore"))+" ",1),(a(),k(le(l(v)?l(de):l(ge))))]),l(v)?(a(),n("div",De,[m(H,{value:l(e),"onUpdate:value":s[3]||(s[3]=t=>ae(e)?e.value=t:null),class:"-my-2"},null,8,["value"]),l(E)?A("",!0):(a(),n(d,{key:0},[p("div",Ee,[m(f,{class:"flex w-1/2",label:o.$t("labels.onUpdate")},{default:r(()=>[m(g,{value:l(e).onUpdate,"onUpdate:value":s[4]||(s[4]=t=>l(e).onUpdate=t),disabled:l(e).virtual,name:"onUpdate","dropdown-class-name":"nc-dropdown-on-update",onChange:l(h)},{default:r(()=>[(a(!0),n(d,null,U(l(y),(t,$)=>(a(),k(b,{key:$,value:t},{default:r(()=>[t==="NO ACTION"?(a(),n(d,{key:0},[u(i(o.$t("title.links.noAction")),1)],64)):t==="CASCADE"?(a(),n(d,{key:1},[u(i(o.$t("title.links.cascade")),1)],64)):t==="RESTRICT"?(a(),n(d,{key:2},[u(i(o.$t("title.links.restrict")),1)],64)):t==="SET NULL"?(a(),n(d,{key:3},[u(i(o.$t("title.links.setNull")),1)],64)):t==="SET DEFAULT"?(a(),n(d,{key:4},[u(i(o.$t("title.links.setDefault")),1)],64)):(a(),n(d,{key:5},[u(i(t),1)],64))]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled","onChange"])]),_:1},8,["label"]),m(f,{class:"flex w-1/2",label:o.$t("labels.onDelete")},{default:r(()=>[m(g,{value:l(e).onDelete,"onUpdate:value":s[5]||(s[5]=t=>l(e).onDelete=t),disabled:l(e).virtual,name:"onDelete","dropdown-class-name":"nc-dropdown-on-delete",onChange:l(h)},{default:r(()=>[(a(!0),n(d,null,U(l(y),(t,$)=>(a(),k(b,{key:$,value:t},{default:r(()=>[t==="NO ACTION"?(a(),n(d,{key:0},[u(i(o.$t("title.links.noAction")),1)],64)):t==="CASCADE"?(a(),n(d,{key:1},[u(i(o.$t("title.links.cascade")),1)],64)):t==="RESTRICT"?(a(),n(d,{key:2},[u(i(o.$t("title.links.restrict")),1)],64)):t==="SET NULL"?(a(),n(d,{key:3},[u(i(o.$t("title.links.setNull")),1)],64)):t==="SET DEFAULT"?(a(),n(d,{key:4},[u(i(o.$t("title.links.setDefault")),1)],64)):(a(),n(d,{key:5},[u(i(t),1)],64))]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled","onChange"])]),_:1},8,["label"])]),p("div",Le,[m(f,null,{default:r(()=>[m(Q,{checked:l(e).virtual,"onUpdate:checked":s[6]||(s[6]=t=>l(e).virtual=t),name:"virtual",onChange:l(h)},{default:r(()=>[u(i(o.$t("title.virtualRelation")),1)]),_:1},8,["checked","onChange"])]),_:1})])],64))])):A("",!0)],64)):A("",!0)])}}});export{Dt as default};
