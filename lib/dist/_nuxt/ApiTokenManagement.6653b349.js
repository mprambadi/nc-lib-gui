import{o as a,c,a as t,f as H,M as J,bF as K,r as k,i as Z,b as o,w as s,d as y,t as i,O as r,W as B,S as ee,P as u,Q as g,R as T,U as te,V as oe,T as se,X as v,Y as D,gk as le,a8 as ne,ah as ae,af as ie,ce as re,cf as ce,C as de}from"./entry.5958c07b.js";import{a as pe}from"./bases.e6c8e3c4.js";import{u as me}from"./useCopy.0241e728.js";import{_ as _e}from"./baseline-more-vert.5cb1bc9f.js";import"./index.ae235b22.js";import{I as fe}from"./Input.dca3a2bc.js";import{F as ue}from"./index.b06c8b67.js";import{D as ve}from"./index.dc13a4d6.js";import{_ as xe}from"./Title.f2b907cf.js";import"./index.0feaca99.js";import"./SearchOutlined.a517903c.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.ddc65fa5.js";import"./Password.f52125e7.js";import"./FormItem.0bbf90a3.js";import"./identity.34c7640e.js";import"./isSymbol.114fe557.js";import"./Col.a97e3e76.js";import"./responsiveObserve.0baefba6.js";import"./toArray.fd74ce6f.js";import"./toNumber.e09cd85a.js";import"./useSize.fad35fe8.js";import"./_flatRest.39582a58.js";import"./debounce.7c24f171.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./CheckOutlined.1fe5f230.js";import"./useState.b891c8bb.js";const ye={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},he=t("path",{fill:"currentColor",d:"M12 16q1.875 0 3.188-1.312T16.5 11.5q0-1.875-1.312-3.187T12 7q-1.875 0-3.187 1.313T7.5 11.5q0 1.875 1.313 3.188T12 16m0-1.8q-1.125 0-1.912-.788T9.3 11.5q0-1.125.788-1.912T12 8.8q1.125 0 1.913.788T14.7 11.5q0 1.125-.787 1.913T12 14.2m0 4.8q-3.65 0-6.65-2.037T1 11.5q1.35-3.425 4.35-5.462T12 4q3.65 0 6.65 2.038T23 11.5q-1.35 3.425-4.35 5.463T12 19"},null,-1),we=[he];function ke(q,x){return a(),c("svg",ye,[...we])}const ge={name:"material-symbols-visibility",render:ke},Te={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},be=t("path",{fill:"currentColor",d:"m19.8 22.6l-4.2-4.15q-.875.275-1.762.413T12 19q-3.775 0-6.725-2.087T1 11.5q.525-1.325 1.325-2.463T4.15 7L1.4 4.2l1.4-1.4l18.4 18.4zM12 16q.275 0 .513-.025t.512-.1l-5.4-5.4q-.075.275-.1.513T7.5 11.5q0 1.875 1.313 3.188T12 16m7.3.45l-3.175-3.15q.175-.425.275-.862t.1-.938q0-1.875-1.312-3.187T12 7q-.5 0-.937.1t-.863.3L7.65 4.85q1.025-.425 2.1-.637T12 4q3.775 0 6.725 2.088T23 11.5q-.575 1.475-1.513 2.738T19.3 16.45m-4.625-4.6l-3-3q.7-.125 1.288.113t1.012.687q.425.45.613 1.038t.087 1.162"},null,-1),$e=[be];function qe(q,x){return a(),c("svg",Te,[...$e])}const Ce={name:"material-symbols-visibility-off",render:qe},Me={class:"relative flex flex-col h-full"},je={class:"flex flex-row justify-start w-full -mt-1 mb-3"},Be={class:"flex flex-row justify-end"},De={class:"flex flex-col h-full"},Ve=t("div",{class:"flex flex-row justify-center mt-2 text-center w-full text-base"},"This action will remove this API Token",-1),ze={class:"flex mt-6 justify-end space-x-2"},Ne={class:"flex flex-col px-10"},Se={class:"flex flex-row justify-end"},Ie={class:"flex flex-row space-x-1"},Re={class:"flex flex-row justify-center items-center caption capitalize space-x-1"},Fe={class:"text-gray-500"},Ae={class:"flex flex-row justify-center items-center caption capitalize space-x-1"},Ue={key:0,class:"w-full flex flex-col mt-2 px-1"},Le={class:"flex flex-row border-b-1 text-gray-600 text-xs pb-2 pt-2"},Ee={class:"flex w-4/10 pl-2"},Oe={class:"flex w-4/10 justify-center"},Pe={class:"flex w-2/10 justify-end pr-2"},Ge={class:"flex flex-row border-b-1 items-center px-2 py-2"},Qe={class:"flex flex-row w-4/10 flex-wrap overflow-ellipsis"},We={class:"flex w-4/10 justify-center flex-wrap overflow-ellipsis"},Xe={key:0},Ye={key:1},He={class:"flex flex-row w-2/10 justify-end"},Je={key:0},Ke={key:1},Ze={class:"flex flex-row items-center"},et={class:"flex flex-row items-center h-[1.2rem]"},tt=["onClick"],ot={class:"text-xs pl-2"},Nt=H({__name:"ApiTokenManagement",setup(q){const{t:x}=J(),{$api:b,$e:h}=de(),V=pe(),{base:_}=K(V),{copy:z}=me(),$=k([]),m=k(!1),f=k(!1),p=k({}),w=async()=>{var e;(e=_.value)!=null&&e.id&&($.value=(await b.apiToken.list(_.value.id)).list)},N=()=>{m.value=!0,h("c:api-token:generate")},S=async e=>{if(e){try{await z(e),v.info(x("msg.info.copiedToClipboard"))}catch(l){v.error(l.message)}h("c:api-token:copy")}},I=async()=>{var e;try{if(!((e=_.value)!=null&&e.id))return;await b.apiToken.create(_.value.id,p.value),m.value=!1,v.success(x("msg.success.tokenGenerated")),p.value={},await w()}catch(l){v.error(await D(l))}h("a:api-token:generate")},R=async()=>{var e;try{if(!((e=_.value)!=null&&e.id)||!p.value.token)return;await b.apiToken.delete(_.value.id,p.value.token),v.success(x("msg.success.tokenDeleted")),await w(),f.value=!1}catch(l){v.error(await D(l))}h("a:api-token:delete")},F=e=>{p.value=e,f.value=!0};return Z(()=>{w()}),(e,l)=>{const A=le,d=ne,U=xe,L=fe,E=ue,C=ae,O=Ce,P=ge,M=ie,G=_e,Q=re,W=ce,X=ve;return a(),c("div",null,[o(C,{visible:r(m),"onUpdate:visible":l[2]||(l[2]=n=>B(m)?m.value=n:null),class:ee({active:r(m)}),closable:!1,width:"28rem",centered:"",footer:null,"wrap-class-name":"nc-modal-generate-token"},{default:s(()=>[t("div",Me,[o(d,{type:"text",class:"!absolute top-0 right-0 rounded-md -mt-2 -mr-3",onClick:l[0]||(l[0]=n=>m.value=!1)},{icon:s(()=>[o(A,{class:"flex mx-auto"})]),_:1}),t("div",je,[o(U,{level:5},{default:s(()=>[y(i(e.$t("title.generateToken")),1)]),_:1})]),o(E,{ref:"form",model:r(p),name:"basic",layout:"vertical",class:"flex flex-col justify-center space-y-3","no-style":"",autocomplete:"off",onFinish:I},{default:s(()=>[o(L,{value:r(p).description,"onUpdate:value":l[1]||(l[1]=n=>r(p).description=n),size:"middle",placeholder:e.$t("labels.description")},null,8,["value","placeholder"]),t("div",Be,[o(d,{type:"primary","html-type":"submit",class:"!rounded-md"},{default:s(()=>[y(i(e.$t("general.generate")),1)]),_:1})])]),_:1},8,["model"])])]),_:1},8,["visible","class"]),o(C,{visible:r(f),"onUpdate:visible":l[5]||(l[5]=n=>B(f)?f.value=n:null),closable:!1,width:"28rem",centered:"",footer:null,"wrap-class-name":"nc-modal-delete-token"},{default:s(()=>[t("div",De,[Ve,t("div",ze,[o(d,{class:"!rounded-md",onClick:l[3]||(l[3]=n=>f.value=!1)},{default:s(()=>[y(i(e.$t("general.cancel")),1)]),_:1}),o(d,{class:"!rounded-md",type:"primary",danger:"",onClick:l[4]||(l[4]=n=>R())},{default:s(()=>[y(i(e.$t("general.confirm")),1)]),_:1})])])]),_:1},8,["visible"]),t("div",Ne,[t("div",Se,[t("div",Ie,[o(d,{size:"middle",type:"text",onClick:l[6]||(l[6]=n=>w())},{default:s(()=>[t("div",Re,[(a(),u(g(r(T).reload),{class:"text-gray-500"})),t("div",Fe,i(e.$t("general.reload")),1)])]),_:1}),o(d,{type:"primary",size:"middle",class:"!rounded-md",onClick:N},{default:s(()=>[t("div",Ae,[(a(),u(g(r(T).plus))),t("div",null,i(e.$t("activity.newToken")),1)])]),_:1})])]),r($)?(a(),c("div",Ue,[t("div",Le,[t("div",Ee,i(e.$t("labels.description")),1),t("div",Oe,i(e.$t("labels.token")),1),t("div",Pe,i(e.$t("labels.action")),1)]),(a(!0),c(te,null,oe(r($),(n,Y)=>(a(),c("div",{key:Y,class:"flex flex-col"},[t("div",Ge,[t("div",Qe,i(n.description),1),t("div",We,[n.show?(a(),c("span",Xe,i(n.token),1)):(a(),c("span",Ye,"****************************************"))]),t("div",He,[o(M,{placement:"bottom"},{title:s(()=>[n.show?(a(),c("span",Je,i(e.$t("general.hide")),1)):(a(),c("span",Ke,i(e.$t("general.show")),1))]),default:s(()=>[o(d,{type:"text",class:"!rounded-md",onClick:j=>n.show=!n.show},{icon:s(()=>[n.show?(a(),u(O,{key:0,class:"flex mx-auto h-[1.1rem]"})):(a(),u(P,{key:1,class:"flex mx-auto h-[1rem]"}))]),_:2},1032,["onClick"])]),_:2},1024),o(M,{placement:"bottom"},{title:s(()=>[y(i(e.$t("general.copy")),1)]),default:s(()=>[o(d,{type:"text",class:"!rounded-md",onClick:j=>S(n.token)},{icon:s(()=>[(a(),u(g(r(T).copy),{class:"flex mx-auto h-[1rem]"}))]),_:2},1032,["onClick"])]),_:2},1024),o(X,{trigger:["click"],class:"flex",placement:"bottomRight","overlay-class-name":"nc-dropdown-api-token-mgmt"},{overlay:s(()=>[o(W,null,{default:s(()=>[o(Q,null,{default:s(()=>[t("div",{class:"flex flex-row items-center py-4 h-[1rem]",onClick:j=>F(n)},[(a(),u(g(r(T).delete),{class:"flex"})),t("div",ot,i(e.$t("general.remove")),1)],8,tt)]),_:2},1024)]),_:2},1024)]),default:s(()=>[t("div",Ze,[o(d,{type:"text",class:"!px-0"},{default:s(()=>[t("div",et,[o(G)])]),_:1})])]),_:2},1024)])])]))),128))])):se("",!0)])])}}});export{Nt as default};
