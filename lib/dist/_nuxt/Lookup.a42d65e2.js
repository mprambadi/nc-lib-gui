import{f as P,bb as y,r as m,ba as k,g as b,H as A,cG as d,eX as I,o,c as s,a as S,O as e,U as x,eW as $,V,P as B,b as T,S as h,t as j,T as O,aK as K,a0 as M,a1 as R}from"./entry.96205fa0.js";import{C as X,M as N,o as q,x as J,z,H as Q,w as Y}from"./index.9b87fcff.js";import{o as c}from"./cell.810c4fd3.js";import{b as Z}from"./bases.965a49bb.js";import{u as ee}from"./useShowNotEditableWarning.3e25a59f.js";import"./index.0c5b3837.js";import"./index.a5de28c1.js";const le=M(()=>R(()=>import("./VirtualCell.e690dced.js"),["./VirtualCell.e690dced.js","./entry.96205fa0.js","./entry.d09b2482.css","./index.9b87fcff.js","./virtualCell.9142cfee.js","./cell.810c4fd3.js"],import.meta.url).then(_=>_.default||_)),te=M(()=>R(()=>import("./Cell.a619fa9b.js"),["./Cell.a619fa9b.js","./entry.96205fa0.js","./entry.d09b2482.css","./index.9b87fcff.js","./cell.810c4fd3.js","./bases.965a49bb.js","./index.0c5b3837.js","./useSmartsheetRowStore.9c7d6fc1.js","./deepCompare.d32ec333.js","./dataUtils.fb0a3616.js","./virtualCell.9142cfee.js","./index.e034edbd.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.f27da8af.css"],import.meta.url).then(_=>_.default||_)),oe={key:0,class:"flex h-full"},ae={key:0},ne={key:0,class:"text-left text-wrap mt-2 text-[#e65100] text-xs"},se={key:1,class:"text-left text-wrap mt-2 text-[#e65100] text-xs"},_e=P({__name:"Lookup",setup(_){const{metas:W,getMeta:D}=Z(),L=y(X,m()),F=y(N,m()),f=y(q,m()),G=y(J,m(!1)),w=m(1),u=y(z,m(1));k(z,w);const v=b(()=>{var t,a;return(a=(t=F.value)==null?void 0:t.columns)==null?void 0:a.find(i=>{var r,n;return i.id===((n=(r=L.value)==null?void 0:r.colOptions)==null?void 0:n.fk_relation_column_id)})});A(v,async t=>{t&&t.colOptions&&await D(t.colOptions.fk_related_model_id)},{immediate:!0});const E=b(()=>{var t;if(v.value&&((t=v.value)!=null&&t.colOptions))return W.value[v.value.colOptions.fk_related_model_id]}),l=b(()=>{var t,a;return(a=(t=E.value)==null?void 0:t.columns)==null?void 0:a.find(i=>{var r,n;return i.id===((n=(r=L.value)==null?void 0:r.colOptions)==null?void 0:n.fk_lookup_column_id)})});A([l,u],()=>{l.value&&!c(l.value)?w.value=1:w.value=u.value});const p=b(()=>{var t,a,i;return f.value?((t=l.value)==null?void 0:t.uidt)===d.Attachment&&((i=(a=v.value)==null?void 0:a.colOptions)==null?void 0:i.type)===I.BELONGS_TO?[f.value]:Array.isArray(f.value)?f.value.filter(r=>r!==null):[f.value]:[]});k(N,E),k(Q,m(!0)),k(Y,m(!0));const{showEditNonEditableFieldWarning:H,showClearNonEditableFieldWarning:U,activateShowEditNonEditableFieldWarning:C}=ee();return(t,a)=>{const i=le,r=te;return o(),s("div",{class:"h-full w-full nc-lookup-cell",tabindex:"-1",style:K({height:e(G)?void 0:e(u)&&e(u)!==1?`${e(u)*2}rem`:"2.85rem"}),onDblclick:a[0]||(a[0]=(...n)=>e(C)&&e(C)(...n))},[S("div",{class:h(["h-full w-full flex gap-1",{"!overflow-x-auto nc-cell-lookup-scroll nc-scrollbar-x-md !overflow-y-hidden":e(u)===1}])},[e(l)?(o(),s(x,{key:0},[e($)(e(l))?(o(),s("div",oe,[e(l).uidt!==e(d).LinkToAnotherRecord||e(l).uidt===e(d).LinkToAnotherRecord&&e(l).colOptions.type===e(I).BELONGS_TO?(o(!0),s(x,{key:0},V(e(p),(n,g)=>(o(),B(i,{key:g,"edit-enabled":!1,"model-value":n,column:e(l),"read-only":!0},null,8,["model-value","column"]))),128)):(o(),B(i,{key:1,"edit-enabled":!1,"read-only":!0,"model-value":e(p),column:e(l)},null,8,["model-value","column"]))])):(o(),s(x,{key:1},[e(c)(e(l))&&e(p)[0]&&!Array.isArray(e(p)[0])&&typeof e(p)[0]=="object"?(o(),s("div",ae,[T(r,{"model-value":e(p),column:e(l),"edit-enabled":!1,"read-only":!0},null,8,["model-value","column"])])):(o(),s("div",{key:1,class:h(["max-h-full max-w-full w-full nc-cell-lookup-scroll",{"nc-scrollbar-md ":e(u)!==1&&!e(c)(e(l))}])},[S("div",{class:h(["flex items-start gap-1.5 w-full h-full py-[3px]",{"flex-wrap":e(u)!==1&&!e(c)(e(l)),"!overflow-x-auto nc-cell-lookup-scroll nc-scrollbar-x-md !overflow-y-hidden":e(u)===1||e(c)(e(l))}])},[(o(!0),s(x,null,V(e(p),(n,g)=>(o(),s("div",{key:g,class:h({"bg-gray-100 rounded-full":!e(c)(e(l)),"border-gray-200 rounded border-1":![e(d).Attachment,e(d).MultiSelect,e(d).SingleSelect,e(d).User,e(d).CreatedBy,e(d).LastModifiedBy].includes(e(l).uidt),"min-h-0 min-w-0":e(c)(e(l))})},[T(r,{"model-value":n,column:e(l),"edit-enabled":!1,virtual:!0,"read-only":!0,class:h({"min-h-0 min-w-0":e(c)(e(l)),"!min-w-20 !w-auto pl-2":!e(c)(e(l))})},null,8,["model-value","column","class"])],2))),128))],2),e(H)?(o(),s("div",ne,j(t.$t("msg.info.computedFieldEditWarning")),1)):O("",!0),e(U)?(o(),s("div",se,j(t.$t("msg.info.computedFieldDeleteWarning")),1)):O("",!0)],2))],64))],64)):O("",!0)],2)],36)}}});export{_e as default};
