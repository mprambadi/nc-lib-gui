import{f as Ue,a5 as qe,$ as Ye,bb as T,bF as Ge,r as w,M as He,H as de,g as ue,eZ as ce,eX as O,gs as me,ad as Ke,c9 as Qe,o,P as m,w as $,O as e,T as v,a as r,S as pe,b as i,cb as Xe,au as Ze,d as fe,t as y,c as h,U as _e,V as ve,d4 as We,W as ye,a0 as j,a1 as B,n as M,X as Je,cZ as et,C as tt}from"./entry.5958c07b.js";import{_ as st}from"./Button.vue.c3ca0e8f.js";import{_ as at}from"./Pagination.c0f166a7.js";import{_ as lt}from"./Modal.vue.0f13e4cb.js";import{a as ot}from"./bases.e6c8e3c4.js";import{C as nt,b as it,c as rt,p as dt,F as ge}from"./index.9b87fcff.js";import{o as xe,A as ut}from"./cell.165313cd.js";import{a as ct}from"./useLTARStore.59a45d45.js";import{a as mt}from"./useSmartsheetRowStore.5b92cc1b.js";import{e as pt}from"./dataUtils.3f874ca1.js";import{_ as ft}from"./plus.dc1af860.js";import{_ as _t}from"./magnify.3b643360.js";import{I as vt}from"./inbox.954d1e59.js";import"./index.ae235b22.js";import{I as yt}from"./Input.dca3a2bc.js";import{_ as gt}from"./Image.c63a7a56.js";import"./index.36af7517.js";import{_ as xt}from"./Input.8209df88.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Icon.vue.129448d5.js";import"./Tooltip.vue.971897f4.js";import"./index.5c6e4286.js";import"./toArray.fd74ce6f.js";import"./antInputDirective.8ac36ea7.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";import"./SearchOutlined.a517903c.js";import"./FormItemContext.ddc65fa5.js";import"./index.0feaca99.js";import"./index.e61e381a.js";import"./useSharedView.e8f68616.js";import"./deepCompare.d32ec333.js";import"./virtualCell.427fa223.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./Password.f52125e7.js";import"./Element.a1e4f356.js";const wt=j(()=>B(()=>import("./Header.941366bc.js"),["./Header.941366bc.js","./Tooltip.vue.971897f4.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Tooltip.b86f91a1.css"],import.meta.url).then(u=>u.default||u)),ht=j(()=>B(()=>import("./ListItem.a1950751.js"),["./ListItem.a1950751.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./fileUtils.43128440.js","./useAttachment.6cac8464.js","./urlUtils.18c797fa.js","./index.f98c1d80.js","./index.912f77e8.js","./Dropdown.041b2468.js","./useState.b891c8bb.js","./useRefs.40c81887.js","./identity.34c7640e.js","./_flatRest.39582a58.js","./isMobile.e2e89480.js","./index.357e1bba.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./index.bed897b5.js","./ListItem.65cb6b25.css"],import.meta.url).then(u=>u.default||u)),kt=j(()=>B(()=>import("./index.caa4cb22.js").then(u=>u.i),["./index.caa4cb22.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Icon.vue.129448d5.js","./Menu.vue.6c65c050.js","./Menu.eff4a609.css","./Divider.7b1fba82.js","./index.07078df6.js","./Divider.3e739d27.css","./Dropdown.vue.0d2ed10f.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./DivDataCell.7c09732c.js","./index.9b87fcff.js","./DivDataCell.1a716a1e.css","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./UserIcon.74e37fbe.js","./UserIcon.fda3e825.css","./config.c8203633.js","./sidebar.f5d81718.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./views.4281cbf1.js","./useSharedView.e8f68616.js","./dataUtils.3f874ca1.js","./index.e61e381a.js","./useKanbanViewStore.9f7f1dc5.js","./deepCompare.d32ec333.js","./useSmartsheetStore.f1a70558.js","./useSmartsheetRowStore.5b92cc1b.js","./virtualCell.427fa223.js","./iconify.e2b5aaa4.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./FormItemContext.ddc65fa5.js","./SearchOutlined.a517903c.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./Modal.vue.0f13e4cb.js","./DeleteModal.7ab6f524.css","./DeleteModal.vue.0320a9db.js","./Modal.vue.ee5af191.js","./useDashboard.7eae7d45.js","./index.c35df397.js","./Input.8209df88.js","./Element.a1e4f356.js","./index.35cd520e.css"],import.meta.url).then(u=>u.default||u)),bt={class:"flex mt-2 mb-2 items-center gap-2"},It=r("div",{class:"flex-1"},null,-1),Rt={class:"flex items-center gap-1 px-4"},zt={key:1,class:"overflow-scroll nc-scrollbar-md pr-1 cursor-pointer flex flex-col flex-grow"},Lt={class:"flex flex-col m-[.5rem] gap-2 flex-grow justify-center"},Nt={class:"flex flex-row gap-6 w-10/12"},Ct={class:"flex flex-col gap-0.5"},Vt={class:"flex flex-col gap-0.5"},At={class:"flex flex-col gap-0.5"},Et={class:"flex flex-col gap-0.5"},St={key:2,class:"my-auto py-2 flex flex-col gap-3 items-center justify-center text-gray-500"},Tt={key:3,class:"flex flex-row justify-center items-center w-full my-2"},$t=r("div",{class:"mb-2 bg-gray-50 border-gray-50 border-b-2"},null,-1),Ft={class:"flex flex-row justify-between items-center bg-white relative pt-1"},Pt={key:0,class:"flex items-center justify-center px-2 rounded-md text-gray-500 bg-brand-50 h-9.5"},Ot={class:"!xs:hidden flex absolute -mt-0.75 items-center py-2 justify-center w-full"},As=Ue({__name:"ListItems",props:{modelValue:{type:Boolean},column:{}},emits:["update:modelValue","addNewRecord"],setup(u,{emit:we}){const g=qe(u,"modelValue",we),{isMobileMode:k}=Ye(),c=T(nt),{isSharedBase:he}=Ge(ot()),ke=w(),{t:D}=He(),{$e:U}=tt(),{childrenExcludedList:b,isChildrenExcludedListLinked:N,isChildrenExcludedListLoading:be,isChildrenExcludedLoading:q,childrenListCount:Y,loadChildrenExcludedList:G,loadChildrenList:H,childrenExcludedListPagination:n,relatedTableDisplayValueProp:K,displayValueTypeAndFormatProp:Ie,link:Re,relatedTableMeta:d,meta:Q,unlink:ze,row:p,headerDisplayValue:Le}=ct(),{addLTARRef:Ne,isNew:F,removeLTARRef:Ce,state:X}=mt(),Ve=T(it,w(!1)),C=w(!1);q.value=!0;const R=T(rt,w(!1)),Z=T(dt,()=>{}),P=w(!1),Ae=async(s,t)=>{F.value?(Ne(s,c==null?void 0:c.value),N.value[t]=!0,Z(),U("a:links:link")):await Re(s,{},!1,t)},Ee=async(s,t)=>{F.value?(Ce(s,c==null?void 0:c.value),N.value[t]=!1,Z(),U("a:links:unlink")):await ze(s,{},!1,t)};de(g,(s,t)=>{s&&!t&&(n.query="",n.page=1,R.value||H(),G(X.value))},{immediate:!0});const f=w(!1),z=w({}),Se=ue(()=>{var V,A,E,L;if(F.value)return{};const s=(V=c==null?void 0:c.value)==null?void 0:V.colOptions,t=(E=(A=d==null?void 0:d.value)==null?void 0:A.columns)==null?void 0:E.find(I=>{if(!ce(I))return!1;const l=I==null?void 0:I.colOptions;return(l==null?void 0:l.fk_related_model_id)!==Q.value.id?!1:s.type===O.MANY_TO_MANY&&(l==null?void 0:l.type)===O.MANY_TO_MANY?s.fk_parent_column_id===l.fk_child_column_id&&s.fk_child_column_id===l.fk_parent_column_id:s.fk_parent_column_id===l.fk_parent_column_id&&s.fk_child_column_id===l.fk_child_column_id});if(!t)return{};const x=t==null?void 0:t.colOptions;return x?x.type===O.BELONGS_TO?{[t.title]:(L=p==null?void 0:p.value)==null?void 0:L.row}:{[t.title]:(p==null?void 0:p.value)&&[p.value.row]}:{}}),Te=me(ge,s=>(d.value.columns??[]).filter(t=>xe(t))[0]),$e=me(ge,s=>(d.value.columns??[]).filter(t=>!et(t)&&!ut(t)&&!ce(t)&&!xe(t)).slice(0,k.value?1:4)),W=ue(()=>{var s,t;return(t=(s=c.value)==null?void 0:s.colOptions)==null?void 0:t.type});de(f,()=>{f.value||(C.value=!1,R.value||H(),G(X.value))}),Ke("Escape",()=>{g.value=!1});const Fe=(s,t)=>{he.value||(N.value[Number.parseInt(t)]?Ee(s,Number.parseInt(t)):Ae(s,Number.parseInt(t)))},Pe=()=>{z.value={},f.value=!0,C.value=!0},Oe=s=>{var x;const t=M("div",{class:"ml-1 inline-flex flex-col gap-1 items-start"},[M("span",{class:"font-semibold"},D("activity.recordCreatedLinked")),M("span",{class:"text-gray-500"},D("activity.gotSavedLinkedSuccessfully",{tableName:(x=d.value)==null?void 0:x.title,recordTitle:s[K.value]}))]);Je.success(t)};return(s,t)=>{const x=wt,V=_t,A=yt,E=ft,L=st,I=gt,l=xt,Me=ht,J=at,je=kt,Be=lt,De=Qe("e");return o(),m(Be,{visible:e(g),"onUpdate:visible":t[11]||(t[11]=S=>ye(g)?g.value=S:null),class:pe({active:e(g)}),footer:null,width:e(R)?600:800,closable:!1,"body-style":{"max-height":"640px",height:"85vh"},"wrap-class-name":"nc-modal-link-record"},{default:$(()=>{var S,ee,te,se,ae,le,oe,ne,ie,re;return[e(R)?v("",!0):(o(),m(x,{key:0,relation:e(W),"table-title":(S=e(Q))==null?void 0:S.title,"related-table-title":(ee=e(d))==null?void 0:ee.title,"display-value":e(Le),header:s.$t("activity.addNewLink")},null,8,["relation","table-title","related-table-title","display-value","header"])),r("div",bt,[r("div",{class:pe(["flex items-center border-1 p-1 rounded-md w-full border-gray-200",{"!border-primary":e(n).query.length!==0||e(P)}])},[i(V,{class:"w-5 h-5 ml-2 text-gray-500"}),i(A,{ref_key:"filterQueryRef",ref:ke,value:e(n).query,"onUpdate:value":t[0]||(t[0]=a=>e(n).query=a),placeholder:`${s.$t("general.searchIn")} ${(te=e(d))==null?void 0:te.title}`,class:"w-full !rounded-md nc-excluded-search xs:min-h-8",size:"small",bordered:!1,onFocus:t[1]||(t[1]=a=>P.value=!0),onBlur:t[2]||(t[2]=a=>P.value=!1),onKeydownCapture:t[3]||(t[3]=Xe(()=>{},["stop"])),onChange:t[4]||(t[4]=a=>e(n).page=1)},null,8,["value","placeholder"])],2),It,e(Ve)?v("",!0):Ze((o(),m(L,{key:0,type:"secondary",size:e(k)?"medium":"small",class:"!text-brand-500",onClick:Pe},{default:$(()=>[r("div",Rt,[e(k)?v("",!0):(o(),m(E,{key:0})),fe(" "+y(s.$t("activity.newRecord")),1)])]),_:1},8,["size"])),[[De,["c:row-expand:open"]]])]),(ae=(se=e(b))==null?void 0:se.pageInfo)!=null&&ae.totalRows?(o(),h("div",zt,[e(q)?(o(!0),h(_e,{key:0},ve(Array.from({length:10}),(a,_)=>(o(),h("div",{key:_,class:"!border-2 flex flex-row gap-2 mb-2 transition-all !rounded-xl relative !border-gray-200 hover:bg-gray-50"},[i(I,{class:"h-24 w-24 !rounded-xl"}),r("div",Lt,[i(l,{class:"!xs:w-30 !w-48 !rounded-xl",active:"",size:"small"}),r("div",Nt,[r("div",Ct,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})]),r("div",Vt,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})]),r("div",At,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})]),r("div",Et,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})])])])]))),128)):(o(!0),h(_e,{key:1},ve(((le=e(b))==null?void 0:le.list)??[],(a,_)=>(o(),m(Me,{key:_,"data-testid":"nc-excluded-list-item",row:a,fields:e($e),attachment:e(Te),"related-table-display-value-prop":e(K),"display-value-type-and-format-prop":e(Ie),"is-loading":e(be)[Number.parseInt(_)],"is-linked":e(N)[Number.parseInt(_)],onExpand:()=>{z.value=a,f.value=!0},onClick:()=>Fe(a,_)},null,8,["row","fields","attachment","related-table-display-value-prop","display-value-type-and-format-prop","is-loading","is-linked","onExpand","onClick"]))),128))])):(o(),h("div",St,[i(e(vt),{class:"w-16 h-16 mx-auto"}),r("p",null,y(s.$t("msg.thereAreNoRecordsInTable"))+" "+y((oe=e(d))==null?void 0:oe.title),1)])),e(k)?(o(),h("div",Tt,[(ne=e(b))!=null&&ne.pageInfo?(o(),m(J,{key:0,current:e(n).page,"onUpdate:current":t[5]||(t[5]=a=>e(n).page=a),"page-size":e(n).size,"onUpdate:pageSize":t[6]||(t[6]=a=>e(n).size=a),total:+e(b).pageInfo.totalRows,"entity-name":"links-excluded-list"},null,8,["current","page-size","total"])):v("",!0)])):v("",!0),$t,r("div",Ft,[e(R)?v("",!0):(o(),h("div",Pt,y(e(W)==="bt"?e(p).row[(ie=e(d))==null?void 0:ie.title]?"1":0:e(Y)??"No")+" "+y(e(k)?"":s.$t("objects.records"))+" "+y(!e(k)&&e(Y)!==0?"are":"")+" "+y(s.$t("general.linked")),1)),r("div",Ot,[(re=e(b))!=null&&re.pageInfo?(o(),m(J,{key:0,current:e(n).page,"onUpdate:current":t[7]||(t[7]=a=>e(n).page=a),"page-size":e(n).size,"onUpdate:pageSize":t[8]||(t[8]=a=>e(n).size=a),total:+e(b).pageInfo.totalRows,"entity-name":"links-excluded-list",mode:"simple"},null,8,["current","page-size","total"])):v("",!0)]),i(L,{class:"nc-close-btn ml-auto",type:"ghost",onClick:t[9]||(t[9]=a=>g.value=!1)},{default:$(()=>[fe(y(s.$t("general.finish")),1)]),_:1})]),(o(),m(We,null,{default:$(()=>{var a;return[e(f)?(o(),m(je,{key:0,modelValue:e(f),"onUpdate:modelValue":t[10]||(t[10]=_=>ye(f)?f.value=_:null),meta:e(d),row:{row:e(z),oldRow:{},rowMeta:Object.keys(e(z)).length>0?{}:{new:!0}},"row-id":("extractPkFromRow"in s?s.extractPkFromRow:e(pt))(e(z),e(d).columns),state:e(Se),"use-meta-fields":"","close-after-save":e(C),"new-record-header":e(C)?s.$t("activity.tableNameCreateNewRecord",{tableName:(a=e(d))==null?void 0:a.title}):void 0,onCreatedRecord:Oe},null,8,["modelValue","meta","row","row-id","state","close-after-save","new-record-header"])):v("",!0)]}),_:1}))]}),_:1},8,["visible","class","width"])}}});export{As as default};
