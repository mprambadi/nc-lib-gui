import{f as D,c8 as T,$ as z,L as B,M,r as O,N as W,o as n,P,w as m,a0 as H,ca as Q,a as o,b as t,O as e,t as i,c as l,cl as J,T as p,d as c,U as x,Q as K,R as X,a1 as Y,D as k}from"./entry.96205fa0.js";import{_ as Z}from"./nuxt-link.672ede79.js";import{u as ee}from"./index.b578efc7.js";import{v as se}from"./validation.64563eeb.js";import{_ as te,a as oe}from"./google-gmail.b490c174.js";import{_ as ne}from"./warning.9842a9cd.js";import"./index.1431a68b.js";import{I as ae}from"./Input.3f1aaf0c.js";import{F as ie}from"./index.886d43e1.js";import{_ as re}from"./FormItem.9f1f85f2.js";import{_ as le}from"./Password.803cc3dc.js";import"./SearchOutlined.c9794270.js";import"./isPlainObject.631eb8fb.js";import"./_getPrototype.459a70cf.js";import"./TextArea.b81a19ed.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.b19eb48c.js";import"./useSize.c98e621d.js";import"./identity.309e9ead.js";import"./isSymbol.d46b4957.js";import"./_flatRest.ce557a88.js";import"./debounce.1d5af9bf.js";import"./toNumber.ed208f2f.js";import"./Col.b3c5d725.js";import"./responsiveObserve.358bcfe9.js";import"./toArray.3561b70e.js";const me=H(()=>Y(()=>import("./NocoIcon.2cfd3c6b.js"),["./NocoIcon.2cfd3c6b.js","./NocoIcon.vue.b3a11080.js","./entry.96205fa0.js","./entry.d09b2482.css","./256x256-trans.d5e230ff.js","./256x256.c010f1d6.js"],import.meta.url).then(g=>g.default||g)),ce={"data-testid":"nc-form-signin",class:"md:bg-primary bg-opacity-5 signin h-full min-h-[600px] flex flex-col justify-center items-center nc-form-signin"},pe={class:"bg-white mt-[60px] relative flex flex-col justify-center gap-2 w-full max-w-[500px] mx-auto p-8 md:rounded-lg md:border-1 md:border-gray-200 md:shadow-xl"},de={class:"prose-2xl font-bold self-center my-4"},ue={key:0,class:"self-center mb-4 bg-red-500 text-white rounded-lg w-3/4 mx-auto p-1"},_e={class:"flex items-center gap-2 justify-center"},ge={class:"break-words"},fe={class:"hidden md:block text-right"},he={class:"self-center flex flex-col flex-wrap gap-4 items-center mt-4 justify-center"},ye={key:0,"data-testid":"nc-form-signin__submit",class:"scaling-btn bg-opacity-100",type:"submit"},be={class:"flex items-center gap-2"},ve=["href"],we={class:"flex items-center gap-2"},xe={key:2,class:"self-center flex flex-col flex-wrap gap-4 items-center mt-4 justify-center"},ke=["href"],Ie={type:"button",class:"scaling-btn bg-opacity-100"},Ue={class:"flex items-center gap-2"},$e={key:3,class:"text-end prose-sm"},Ee={key:4,class:"md:hidden"},es=D({__name:"signin",setup(g){const f=T(),{signIn:q,appInfo:a}=z(),{api:A,isLoading:R,error:u}=B({useGlobalInstance:!0}),{t:_}=M();ee("nc-left-sidebar",{hasSidebar:!1});const I=O(),d=W({email:"",password:""}),U={email:[{required:!0,message:_("msg.error.signUpRules.emailRequired")},{validator:(s,r)=>new Promise((y,b)=>{if(!(r!=null&&r.length)||se(r))return y();b(new Error(_("msg.error.signUpRules.emailInvalid")))}),message:_("msg.error.signUpRules.emailInvalid")}],password:[{required:!0,message:_("msg.error.signUpRules.passwdRequired")}]};async function C(){I.value.validate()&&(h(),A.auth.signin(d).then(async({token:s})=>{q(s),await k({path:"/",query:f.query})}))}function h(){u.value&&(u.value=null)}function N(){k({path:"/signup",query:f.query})}function $(){k({path:"/forgot-password",query:f.query})}return(s,r)=>{const y=me,b=ne,S=ae,E=re,F=le,v=Z,L=te,V=oe,G=ie,j=Q;return n(),P(j,null,{default:m(()=>[o("div",ce,[o("div",pe,[t(y,{class:"color-transition hover:ring hover:ring-accent hover:ring-opacity-100",animate:e(R)},null,8,["animate"]),o("h1",de,i(s.$t("general.signIn")),1),t(G,{ref_key:"formValidator",ref:I,model:e(d),layout:"vertical","no-style":"",onFinish:C},{default:m(()=>[e(a).disableEmailAuth?p("",!0):(n(),l(x,{key:0},[t(J,{name:"layout"},{default:m(()=>[e(u)?(n(),l("div",ue,[o("div",_e,[t(b),o("div",ge,i(e(u)),1)])])):p("",!0)]),_:1}),t(E,{label:s.$t("labels.email"),name:"email",rules:U.email},{default:m(()=>[t(S,{value:e(d).email,"onUpdate:value":r[0]||(r[0]=w=>e(d).email=w),"data-testid":"nc-form-signin__email",size:"large",placeholder:s.$t("msg.info.signUp.workEmail"),onFocus:h},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),t(E,{label:s.$t("labels.password"),name:"password",rules:U.password},{default:m(()=>[t(F,{value:e(d).password,"onUpdate:value":r[1]||(r[1]=w=>e(d).password=w),"data-testid":"nc-form-signin__password",size:"large",class:"password",placeholder:s.$t("msg.info.signUp.enterPassword"),onFocus:h},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),o("div",fe,[t(v,{class:"prose-sm",onClick:$},{default:m(()=>[c(i(s.$t("msg.info.signUp.forgotPassword")),1)]),_:1})])],64)),o("div",he,[e(a).disableEmailAuth?p("",!0):(n(),l("button",ye,[o("span",be,[(n(),P(K(e(X).signin))),c(" "+i(s.$t("general.signIn")),1)])])),e(a).googleAuthEnabled?(n(),l("a",{key:1,href:`${e(a).ncSiteUrl}/auth/google`,class:"scaling-btn bg-opacity-100 !after:bg-white !text-primary !no-underline"},[o("span",we,[t(L),c(" "+i(s.$t("labels.signInWithProvider",{provider:"Google"})),1)])],8,ve)):p("",!0),e(a).oidcAuthEnabled?(n(),l("div",xe,[o("a",{href:`${e(a).ncSiteUrl}/auth/oidc`,class:"!text-primary !no-underline"},[o("button",Ie,[o("span",Ue,[t(V),e(a).disableEmailAuth?(n(),l(x,{key:1},[c(i(s.$t("general.signIn")),1)],64)):(n(),l(x,{key:0},[c(i(s.$t("labels.signUpWithProvider",{provider:e(a).oidcProviderName||"OpenID Connect"})),1)],64))])])],8,ke)])):p("",!0),e(a).inviteOnlySignup?p("",!0):(n(),l("div",$e,[c(i(s.$t("msg.info.signUp.dontHaveAccount"))+" ",1),t(v,{onClick:N},{default:m(()=>[c(i(s.$t("general.signUp")),1)]),_:1})])),e(a).disableEmailAuth?p("",!0):(n(),l("div",Ee,[t(v,{class:"prose-sm",onClick:$},{default:m(()=>[c(i(s.$t("msg.info.signUp.forgotPassword")),1)]),_:1})]))])]),_:1},8,["model"])])])]),_:1})}}});export{es as default};
