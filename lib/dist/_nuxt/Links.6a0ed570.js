import{f as Y,bb as a,r as s,bA as Z,fi as _,aM as ee,M as te,H as P,c9 as le,o as v,c as B,a as M,au as oe,P as x,w as ne,d as ae,t as se,O as l,S as O,cb as k,bv as K,Q as re,T as C,a0 as S,a1 as z}from"./entry.5958c07b.js";import{o as ie,C as ue,n as ce,B as de,c as pe,i as me,H as ve,l as fe,m as _e}from"./index.9b87fcff.js";import{a as ke}from"./useSmartsheetRowStore.5b92cc1b.js";import{u as ge}from"./useLTARStore.59a45d45.js";import{u as ye}from"./index.c35df397.js";import{_ as he}from"./plus.dc1af860.js";import"./deepCompare.d32ec333.js";import"./dataUtils.3f874ca1.js";import"./virtualCell.427fa223.js";import"./bases.e6c8e3c4.js";import"./index.0feaca99.js";import"./index.e61e381a.js";import"./useSharedView.e8f68616.js";const we=S(()=>z(()=>import("./ListItems.aa19e1cf.js"),["./ListItems.aa19e1cf.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Pagination.c0f166a7.js","./Icon.vue.129448d5.js","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./index.5c6e4286.js","./toArray.fd74ce6f.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./SearchOutlined.a517903c.js","./FormItemContext.ddc65fa5.js","./Pagination.fabf8b70.css","./Modal.vue.0f13e4cb.js","./DeleteModal.7ab6f524.css","./bases.e6c8e3c4.js","./index.0feaca99.js","./index.9b87fcff.js","./cell.165313cd.js","./useLTARStore.59a45d45.js","./index.e61e381a.js","./useSharedView.e8f68616.js","./useSmartsheetRowStore.5b92cc1b.js","./deepCompare.d32ec333.js","./dataUtils.3f874ca1.js","./virtualCell.427fa223.js","./plus.dc1af860.js","./magnify.3b643360.js","./inbox.954d1e59.js","./index.ae235b22.js","./Input.dca3a2bc.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./Image.c63a7a56.js","./Element.a1e4f356.js","./index.36af7517.js","./Input.8209df88.js","./ListItems.d8bb4ba4.css"],import.meta.url).then(u=>u.default||u)),xe=S(()=>z(()=>import("./ListChildItems.1dbe126e.js"),["./ListChildItems.1dbe126e.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Pagination.c0f166a7.js","./Icon.vue.129448d5.js","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./index.5c6e4286.js","./toArray.fd74ce6f.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./SearchOutlined.a517903c.js","./FormItemContext.ddc65fa5.js","./Pagination.fabf8b70.css","./Modal.vue.0f13e4cb.js","./DeleteModal.7ab6f524.css","./bases.e6c8e3c4.js","./index.0feaca99.js","./index.9b87fcff.js","./cell.165313cd.js","./useLTARStore.59a45d45.js","./index.e61e381a.js","./useSharedView.e8f68616.js","./useSmartsheetRowStore.5b92cc1b.js","./deepCompare.d32ec333.js","./dataUtils.3f874ca1.js","./virtualCell.427fa223.js","./plus.dc1af860.js","./magnify.3b643360.js","./inbox.954d1e59.js","./index.ae235b22.js","./Input.dca3a2bc.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./Image.c63a7a56.js","./Element.a1e4f356.js","./Input.8209df88.js","./ListChildItems.7a5d47c9.css"],import.meta.url).then(u=>u.default||u)),Ce={class:"block flex-shrink truncate"},Le=M("div",{class:"flex-grow"},null,-1),Ie=["onKeydown"],Se=Y({__name:"Links",setup(u){const c=a(ie,s(0)),r=a(ue),U=a(ce),$=a(de,Z()),i=a(pe),H=a(me,s(!1)),g=a(ve,s(!1)),N=a(fe,s(!1)),L=_(()=>{var e;return((e=r.value)==null?void 0:e.title)||""}),o=s(!1),n=s(!1),{isUIAllowed:Q}=ee(),{t:f}=te(),{state:d,isNew:I}=ke(),{relatedTableMeta:q,loadRelatedTableMeta:F,relatedTableDisplayValueProp:G}=ge(r,U,I,$.trigger),b=_(()=>{var e,t;return(t=(e=q.value)==null?void 0:e.columns)==null?void 0:t.find(p=>p.title===G.value)});F();const R=_(()=>{var t,p,y,h,w,m,E,A;if(i!=null&&i.value||I.value)return(p=(t=d.value)==null?void 0:t[L.value])!=null&&p.length?`${+((h=(y=d.value)==null?void 0:y[L.value])==null?void 0:h.length)} ${f("msg.recordsLinked")}`:f("msg.noRecordsLinked");const e=+(c==null?void 0:c.value)||0;return e?e===1?`1 ${((m=(w=r.value)==null?void 0:w.meta)==null?void 0:m.singular)||f("general.link")}`:`${e} ${((A=(E=r.value)==null?void 0:E.meta)==null?void 0:A.plural)||f("general.links")}`:f("msg.noRecordsLinked")}),J=_(()=>{var e,t;return i!=null&&i.value?(t=(e=d.value)==null?void 0:e[L.value])==null?void 0:t.length:+(c==null?void 0:c.value)||0}),W=()=>{n.value=!1,o.value=!0},V=()=>{g.value||(n.value=!0)};ye(a(_e,s(!1)),e=>{switch(e.key){case"Enter":if(o.value)return;n.value=!0,e.stopPropagation();break}});const X=_(()=>{var e;return I.value?((e=d==null?void 0:d.value)==null?void 0:e[r==null?void 0:r.value.title])??[]:[]}),D=()=>{g.value||(o.value=!0)},T=s(null),j=s(null);return P([n],()=>{var e;n.value||(e=j.value)==null||e.focus()}),P([o],()=>{var e;o.value||(e=T.value)==null||e.focus()}),(e,t)=>{const p=he,y=we,h=xe,w=le("e");return v(),B("div",{class:O(["flex w-full group items-center nc-links-wrapper py-1",{"px-2":l(N)}]),onDblclick:k(V,["stop"])},[M("div",Ce,[oe((v(),x(re(l(g)?"span":"a"),{ref_key:"childListDlgRef",ref:j,title:l(R),class:O(["text-center nc-datatype-link underline-transparent",{"!text-gray-300":!l(R)}]),tabindex:"0",onClick:k(V,["stop","prevent"]),onKeydown:K(k(V,["stop","prevent"]),["enter"])},{default:ne(()=>[ae(se(l(R)),1)]),_:1},40,["title","class","onKeydown"])),[[w,["c:cell:links:modal:open"]]])]),Le,l(g)?C("",!0):(v(),B("div",{key:0,ref_key:"plusBtnRef",ref:T,tabindex:"0",class:"!xs:hidden flex group justify-end group-hover:flex items-center",onKeydown:K(k(D,["stop"]),["enter"])},[!l(H)&&l(Q)("dataEdit")||l(i)?(v(),x(p,{key:0,class:"select-none !text-md text-gray-700 nc-action-icon nc-plus invisible group-hover:visible group-focus:visible",onClick:k(D,["stop"])})):C("",!0)],40,Ie)),o.value||n.value?(v(),x(y,{key:1,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=m=>o.value=m),column:l(b)},null,8,["modelValue","column"])):C("",!0),o.value||n.value?(v(),x(h,{key:2,modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=m=>n.value=m),items:l(J),column:l(b),"cell-value":l(X),onAttachRecord:W},null,8,["modelValue","items","column","cell-value"])):C("",!0)],34)}}});export{Se as default};
