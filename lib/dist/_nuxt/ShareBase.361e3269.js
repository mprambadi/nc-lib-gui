import{_ as I}from"./View.2de570b5.js";import{f as V,r as v,bF as W,$ as j,g as B,i as L,c9 as M,o as h,c as b,a as u,t as k,au as $,b as _,O as s,W as P,T as S,X as i,Y as l,C as F}from"./entry.5958c07b.js";import{a as O,e as X}from"./bases.e6c8e3c4.js";import{u as Y}from"./useDashboard.7eae7d45.js";import{_ as q}from"./index.b076ba21.js";import"./Tooltip.vue.971897f4.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./useSmartsheetStore.f1a70558.js";import"./views.4281cbf1.js";import"./useSharedView.e8f68616.js";import"./index.9b87fcff.js";import"./index.e61e381a.js";import"./index.025c8e21.js";import"./Password.f52125e7.js";import"./Input.dca3a2bc.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.ddc65fa5.js";import"./index.5c6e4286.js";import"./toArray.fd74ce6f.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";import"./SearchOutlined.a517903c.js";import"./ProjectIcon.07026955.js";import"./Icon.vue.129448d5.js";import"./Button.vue.c3ca0e8f.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./useCopy.0241e728.js";import"./share.ce661e57.js";import"./v3-infinite-loading.660bd977.js";import"./index.122d98ae.js";import"./useBreakpoint.cbf2ba72.js";import"./responsiveObserve.0baefba6.js";import"./useSize.fad35fe8.js";import"./eagerComputed.ab57921b.js";import"./index.9c85d421.js";import"./index.0feaca99.js";const z={class:"flex flex-col py-2 px-3 gap-2 w-full","data-testid":"nc-share-base-sub-modal"},H={class:"flex flex-col w-full p-3 border-1 border-gray-100 rounded-md"},J={class:"flex flex-row w-full justify-between"},K={class:"text-gray-900 font-medium"},Q={key:0,class:"flex flex-col w-full mt-3 border-t-1 pt-3 border-gray-100"},Z={key:0,class:"flex flex-row justify-between mt-3 bg-gray-50 px-3 py-2 rounded-md"},ee={class:"text-black"},Fe=V({__name:"ShareBase",setup(ae){const{dashboardUrl:U}=Y(),{$api:d,$e:g}=F(),a=v(null),{base:r}=W(O()),{getBaseUrl:C,appInfo:w}=j(),R=X(),p=B(()=>{var o;if(!a.value||!a.value.uuid)return"";const e=C(R.activeWorkspaceId);let t=U.value;return e&&(t=`${e}${(o=w.value)==null?void 0:o.dashboardPath}`),encodeURI(`${t}#/base/${a.value.uuid}`)}),D=async()=>{try{if(!r.value.id)return;const e=await d.base.sharedBaseGet(r.value.id);a.value={uuid:e.uuid,url:e.url,role:e.roles}}catch(e){i.error(await l(e))}},m=async(e="viewer")=>{try{if(!r.value.id)return;const t=await d.base.sharedBaseUpdate(r.value.id,{roles:e});a.value=t??{},a.value.role=e,r.value.uuid=t.uuid}catch(t){i.error(await l(t))}g("a:shared-base:enable",{role:e})},T=async()=>{try{if(!r.value.id)return;await d.base.sharedBaseDisable(r.value.id),a.value=null,r.value.uuid=void 0}catch(e){i.error(await l(e))}g("a:shared-base:disable")};L(()=>{a.value||D()});const f=B(()=>{var e;return!!((e=a.value)!=null&&e.uuid)}),n=v(!1),c=v(!1),N=async()=>{if(!n.value){n.value=!0;try{f.value?await T():await m()}catch(e){i.error(await l(e))}finally{n.value=!1}}},A=async()=>{if(a.value&&!c.value){c.value=!0;try{a.value.role==="viewer"?await m("editor"):await m("viewer")}catch(e){i.error(await l(e))}finally{c.value=!1}}};return(e,t)=>{var x;const o=q,E=I,y=M("e");return h(),b("div",z,[u("div",H,[u("div",J,[u("div",K,k(e.$t("activity.enablePublicAccess")),1),$(_(o,{checked:s(f),loading:s(n),class:"ml-2",onClick:N},null,8,["checked","loading"]),[[y,["c:share:base:enable:toggle"]]])]),s(f)?(h(),b("div",Q,[_(E,{url:s(p),"onUpdate:url":t[0]||(t[0]=G=>P(p)?p.value=G:null)},null,8,["url"]),s(w).ee?S("",!0):(h(),b("div",Z,[u("div",ee,k(e.$t("activity.editingAccess")),1),$(_(o,{loading:s(c),checked:((x=s(a))==null?void 0:x.role)==="editor",class:"ml-2",onClick:A},null,8,["loading","checked"]),[[y,["c:share:base:role:toggle"]]])]))])):S("",!0)])])}}});export{Fe as default};
