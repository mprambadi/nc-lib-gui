import{o as a,c as n,a as p,f as W,a5 as X,bb as Z,r as M,bF as J,M as K,gZ as Y,g as R,g_ as ee,cG as te,b as m,w as r,ae as w,O as l,d as u,t as i,U as d,V as U,P as k,Q as le,W as ae,T as A,a0 as oe,a1 as ne,g$ as se}from"./entry.5958c07b.js";import{_ as ie}from"./TableIcon.vue.694329e0.js";import{_ as re}from"./Tooltip.vue.971897f4.js";import{b as ue,M as de}from"./EditOrAddProvider.vue.31035ffc.js";import{M as me}from"./index.9b87fcff.js";import{a as pe}from"./bases.e6c8e3c4.js";import{R as ce,_ as ve}from"./index.781e7bb1.js";import{C as fe}from"./index.5e1434a7.js";import{_ as _e}from"./FormItem.0bbf90a3.js";import{S as he,_ as ye}from"./index.5c6e4286.js";import"./Icon.vue.129448d5.js";import"./Button.vue.c3ca0e8f.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./views.4281cbf1.js";import"./useSharedView.e8f68616.js";import"./validation.2de04583.js";import"./index.0feaca99.js";import"./index.b06c8b67.js";import"./useSize.fad35fe8.js";import"./identity.34c7640e.js";import"./_flatRest.39582a58.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./FormItemContext.ddc65fa5.js";import"./vuedraggable.umd.00f5fccc.js";import"./v3-infinite-loading.660bd977.js";import"./index.dc13a4d6.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./index.ae235b22.js";import"./Input.dca3a2bc.js";import"./antInputDirective.8ac36ea7.js";import"./SearchOutlined.a517903c.js";import"./TextArea.9074ff05.js";import"./Password.f52125e7.js";import"./cell.165313cd.js";import"./Checkbox.2e7b0035.js";import"./createForOfIteratorHelper.33de41ba.js";import"./Col.a97e3e76.js";import"./responsiveObserve.0baefba6.js";import"./toArray.fd74ce6f.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";const ke={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ce=p("path",{fill:"currentColor",d:"M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8s8 3.59 8 8s-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m1 5h-2v4H7v2h4v4h2v-4h4v-2h-4z"},null,-1),Te=[Ce];function be(c,I){return a(),n("svg",ke,[...Te])}const ge={name:"mdi-plus-circle-outline",render:be},$e=oe(()=>ne(()=>import("./LinkOptions.88e397f9.js"),["./LinkOptions.88e397f9.js","./entry.5958c07b.js","./entry.bdecbb78.css","./EditOrAddProvider.vue.31035ffc.js","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./views.4281cbf1.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./useSharedView.e8f68616.js","./validation.2de04583.js","./index.b06c8b67.js","./FormItem.0bbf90a3.js","./identity.34c7640e.js","./_getPrototype.c1f3bae2.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./toArray.fd74ce6f.js","./FormItemContext.ddc65fa5.js","./useSize.fad35fe8.js","./_flatRest.39582a58.js","./isPlainObject.ccda79fe.js","./vuedraggable.umd.00f5fccc.js","./v3-infinite-loading.660bd977.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.a517903c.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./cell.165313cd.js","./index.5e1434a7.js","./Checkbox.2e7b0035.js","./createForOfIteratorHelper.33de41ba.js","./index.5c6e4286.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./EditOrAddProvider.9247d0ff.css","./index.357e1bba.js"],import.meta.url).then(c=>c.default||c)),we={class:"w-full flex flex-col mb-2 mt-4"},Ue={class:"border-2 p-6"},Ae={class:"flex w-full items-center gap-2"},Ie={class:"min-w-5 flex items-center justify-center"},De={key:0,class:"flex flex-col p-6 gap-4 border-2 mt-2"},Ee={class:"flex flex-row space-x-2"},Le={class:"flex flex-row"},Dt=W({__name:"LinkedToAnotherRecordOptions",props:{value:{}},emits:["update:value"],setup(c,{emit:I}){var L,S,N;const e=X(c,"value",I),_=Z(me,M()),{setAdditionalValidations:x,validateInfos:C,onDataTypeChange:h,sqlUi:D,isXcdbBase:E}=ue(),B=pe(),{tables:T}=J(B),{t:V}=K();x({childId:[{required:!0,message:V("general.required")}]});const y=D===se?["NO ACTION"]:["NO ACTION","CASCADE","RESTRICT","SET NULL","SET DEFAULT"];e.value.parentId||(e.value.parentId=(L=_.value)==null?void 0:L.id),e.value.childId||(e.value.childId=null),e.value.childColumn||(e.value.childColumn=`${(S=_.value)==null?void 0:S.table_name}_id`),e.value.childTable||(e.value.childTable=(N=_.value)==null?void 0:N.table_name),e.value.parentTable||(e.value.parentTable=e.value.rtn||""),e.value.parentColumn||(e.value.parentColumn=e.value.rcn||""),e.value.type||(e.value.type="mm"),e.value.onUpdate||(e.value.onUpdate=y[0]),e.value.onDelete||(e.value.onDelete=y[0]),e.value.virtual||(e.value.virtual=D===Y),e.value.alias||(e.value.alias=e.value.column_name);const v=M(!1),q=R(()=>!T.value||!T.value.length?[]:T.value.filter(o=>{var s;return o.type===ee.TABLE&&o.source_id===((s=_.value)==null?void 0:s.source_id)})),F=(o,s)=>s.key.toLowerCase().includes(o.toLowerCase()),P=R(()=>e.value.uidt===te.Links);return(o,s)=>{const O=ce,j=ve,f=_e,z=ie,G=re,b=he,g=ye,H=$e,Q=fe;return a(),n("div",we,[p("div",Ue,[m(f,w(l(C).type,{class:"nc-ltar-relation-type"}),{default:r(()=>[m(j,w({value:l(e).type,"onUpdate:value":s[0]||(s[0]=t=>l(e).type=t),name:"type"},l(C).type),{default:r(()=>[m(O,{value:"hm"},{default:r(()=>[u(i(o.$t("title.hasMany")),1)]),_:1}),m(O,{value:"mm"},{default:r(()=>[u(i(o.$t("title.manyToMany")),1)]),_:1})]),_:1},16,["value"])]),_:1},16),m(f,w({class:"flex w-full pb-2 mt-4 nc-ltar-child-table",label:o.$t("labels.childTable")},l(C).childId),{default:r(()=>[m(g,{value:l(e).childId,"onUpdate:value":s[1]||(s[1]=t=>l(e).childId=t),"show-search":"","filter-option":F,"dropdown-class-name":"nc-dropdown-ltar-child-table",onChange:l(h)},{default:r(()=>[(a(!0),n(d,null,U(l(q),t=>(a(),k(b,{key:t.title,value:t.id},{default:r(()=>[p("div",Ae,[p("div",Ie,[m(z,{meta:t,class:"text-gray-500"},null,8,["meta"])]),m(G,{class:"flex-1 truncate","show-on-truncate-only":""},{title:r(()=>[u(i(t.title),1)]),default:r(()=>[p("span",null,i(t.title),1)]),_:2},1024)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1},16,["label"])]),!l(E)||l(P)?(a(),n(d,{key:0},[p("div",{class:"text-xs cursor-pointer text-grey nc-more-options my-2 flex items-center gap-1 justify-end",onClick:s[2]||(s[2]=t=>v.value=!l(v))},[u(i(l(v)?o.$t("general.hideAll"):o.$t("general.showMore"))+" ",1),(a(),k(le(l(v)?l(de):l(ge))))]),l(v)?(a(),n("div",De,[m(H,{value:l(e),"onUpdate:value":s[3]||(s[3]=t=>ae(e)?e.value=t:null),class:"-my-2"},null,8,["value"]),l(E)?A("",!0):(a(),n(d,{key:0},[p("div",Ee,[m(f,{class:"flex w-1/2",label:o.$t("labels.onUpdate")},{default:r(()=>[m(g,{value:l(e).onUpdate,"onUpdate:value":s[4]||(s[4]=t=>l(e).onUpdate=t),disabled:l(e).virtual,name:"onUpdate","dropdown-class-name":"nc-dropdown-on-update",onChange:l(h)},{default:r(()=>[(a(!0),n(d,null,U(l(y),(t,$)=>(a(),k(b,{key:$,value:t},{default:r(()=>[t==="NO ACTION"?(a(),n(d,{key:0},[u(i(o.$t("title.links.noAction")),1)],64)):t==="CASCADE"?(a(),n(d,{key:1},[u(i(o.$t("title.links.cascade")),1)],64)):t==="RESTRICT"?(a(),n(d,{key:2},[u(i(o.$t("title.links.restrict")),1)],64)):t==="SET NULL"?(a(),n(d,{key:3},[u(i(o.$t("title.links.setNull")),1)],64)):t==="SET DEFAULT"?(a(),n(d,{key:4},[u(i(o.$t("title.links.setDefault")),1)],64)):(a(),n(d,{key:5},[u(i(t),1)],64))]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled","onChange"])]),_:1},8,["label"]),m(f,{class:"flex w-1/2",label:o.$t("labels.onDelete")},{default:r(()=>[m(g,{value:l(e).onDelete,"onUpdate:value":s[5]||(s[5]=t=>l(e).onDelete=t),disabled:l(e).virtual,name:"onDelete","dropdown-class-name":"nc-dropdown-on-delete",onChange:l(h)},{default:r(()=>[(a(!0),n(d,null,U(l(y),(t,$)=>(a(),k(b,{key:$,value:t},{default:r(()=>[t==="NO ACTION"?(a(),n(d,{key:0},[u(i(o.$t("title.links.noAction")),1)],64)):t==="CASCADE"?(a(),n(d,{key:1},[u(i(o.$t("title.links.cascade")),1)],64)):t==="RESTRICT"?(a(),n(d,{key:2},[u(i(o.$t("title.links.restrict")),1)],64)):t==="SET NULL"?(a(),n(d,{key:3},[u(i(o.$t("title.links.setNull")),1)],64)):t==="SET DEFAULT"?(a(),n(d,{key:4},[u(i(o.$t("title.links.setDefault")),1)],64)):(a(),n(d,{key:5},[u(i(t),1)],64))]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled","onChange"])]),_:1},8,["label"])]),p("div",Le,[m(f,null,{default:r(()=>[m(Q,{checked:l(e).virtual,"onUpdate:checked":s[6]||(s[6]=t=>l(e).virtual=t),name:"virtual",onChange:l(h)},{default:r(()=>[u(i(o.$t("title.virtualRelation")),1)]),_:1},8,["checked","onChange"])]),_:1})])],64))])):A("",!0)],64)):A("",!0)])}}});export{Dt as default};
