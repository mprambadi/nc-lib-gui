import{a as he,u as ke}from"./bases.965a49bb.js";import{f as K,ai as te,eJ as F,an as le,b as m,ak as Y,am as X,bP as ce,bt as we,aw as Ce,b7 as xe,aj as ae,cf as Z,av as Se,$ as $e,bF as Ne,bb as Ae,g as G,M as ue,H as ie,r as H,i as Ie,c9 as de,o as d,c as E,a as k,au as Q,P as h,w as b,d as I,t as A,O as o,W as R,X as Re,a5 as q,aF as Be,ba as Me,R as J,Q as T,U as se,V as ne,T as W,cB as Pe,S as oe,C as je,a8 as Te,ce as Ee,ah as De,p as Oe,e as Fe}from"./entry.96205fa0.js";import{k as me}from"./index.9b87fcff.js";import{C as Ue}from"./index.0b4c0f1e.js";import{D as Ke}from"./index.6c1d17b6.js";import{D as Ve}from"./index.b5e393d6.js";import{_ as Le}from"./Title.26f92384.js";import{L as ze,a as Je,_ as We}from"./index.955e0908.js";import{_ as Ge}from"./index.c968c966.js";import{_ as He}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.0c5b3837.js";import"./Checkbox.cf2cdba0.js";import"./FormItemContext.b19eb48c.js";import"./createForOfIteratorHelper.f2005dfe.js";import"./Dropdown.1dedd322.js";import"./RightOutlined.3ce786f5.js";import"./toArray.3561b70e.js";import"./antInputDirective.8ac36ea7.js";import"./isMobile.e2e89480.js";import"./useMemo.dbc63a5f.js";import"./useState.5a301439.js";import"./CheckOutlined.3b90c20d.js";import"./SearchOutlined.c9794270.js";import"./TextArea.b81a19ed.js";import"./Input.3f1aaf0c.js";import"./LeftOutlined.5e2085dd.js";var Qe=["class","style"],Xe=function(){return{prefixCls:String,href:String,separator:X.any,overlay:X.any,onClick:Function}};const U=K({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Xe(),slots:["separator","overlay"],setup:function(n,f){var u=f.slots,r=f.attrs,C=te("breadcrumb",n),c=C.prefixCls,x=function(_,i){var a=F(u,n,"overlay");return a?m(Ke,{overlay:a,placement:"bottom"},{default:function(){return[m("span",{class:"".concat(i,"-overlay-link")},[_,m(Ve,null,null)])]}}):_};return function(){var S,_=(S=F(u,n,"separator"))!==null&&S!==void 0?S:"/",i=F(u,n),a=r.class,p=r.style,e=le(r,Qe),s;return n.href!==void 0?s=m("a",Y({class:"".concat(c.value,"-link"),onClick:n.onClick},e),[i]):s=m("span",Y({class:"".concat(c.value,"-link"),onClick:n.onClick},e),[i]),s=x(s,c.value),i?m("span",{class:a,style:p},[s,_&&m("span",{class:"".concat(c.value,"-separator")},[_])]):null}}});var qe=function(){return{prefixCls:String,routes:{type:Array},params:X.any,separator:X.any,itemRender:{type:Function}}};function Ye(l,n){if(!l.breadcrumbName)return null;var f=Object.keys(n).join("|"),u=l.breadcrumbName.replace(new RegExp(":(".concat(f,")"),"g"),function(r,C){return n[C]||r});return u}function re(l){var n=l.route,f=l.params,u=l.routes,r=l.paths,C=u.indexOf(n)===u.length-1,c=Ye(n,f);return C?m("span",null,[c]):m("a",{href:"#/".concat(r.join("/"))},[c])}const D=K({compatConfig:{MODE:3},name:"ABreadcrumb",props:qe(),slots:["separator","itemRender"],setup:function(n,f){var u=f.slots,r=te("breadcrumb",n),C=r.prefixCls,c=r.direction,x=function(a,p){return a=(a||"").replace(/^\//,""),Object.keys(p).forEach(function(e){a=a.replace(":".concat(e),p[e])}),a},S=function(a,p,e){var s=Se(a),v=x(p||"",e);return v&&s.push(v),s},_=function(a){var p=a.routes,e=p===void 0?[]:p,s=a.params,v=s===void 0?{}:s,y=a.separator,w=a.itemRender,M=w===void 0?re:w,g=[];return e.map(function(t){var B=x(t.path,v);B&&g.push(B);var P=[].concat(g),O=null;return t.children&&t.children.length&&(O=m(Z,null,{default:function(){return[t.children.map(function(j){return m(Z.Item,{key:j.path||j.breadcrumbName},{default:function(){return[M({route:j,params:v,routes:e,paths:S(P,j.path,v)})]}})})]}})),m(U,{overlay:O,separator:y,key:B||t.breadcrumbName},{default:function(){return[M({route:t,params:v,routes:e,paths:P})]}})})};return function(){var i,a,p,e=n.routes,s=n.params,v=s===void 0?{}:s,y=ce(F(u,n)),w=(i=F(u,n,"separator"))!==null&&i!==void 0?i:"/",M=n.itemRender||u.itemRender||re;e&&e.length>0?p=_({routes:e,params:v,separator:w,itemRender:M}):y.length&&(p=y.map(function(t,B){return we(Ce(t.type)==="object"&&(t.type.__ANT_BREADCRUMB_ITEM||t.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),xe(t,{separator:w,key:B})}));var g=(a={},ae(a,C.value,!0),ae(a,"".concat(C.value,"-rtl"),c.value==="rtl"),a);return m("div",{class:g},[p])}}});var Ze=["separator","class"],et=function(){return{prefixCls:String}};const ee=K({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:et(),setup:function(n,f){var u=f.slots,r=f.attrs,C=te("breadcrumb",n),c=C.prefixCls;return function(){var x;r.separator;var S=r.class,_=le(r,Ze),i=ce((x=u.default)===null||x===void 0?void 0:x.call(u));return m("span",Y({class:["".concat(c.value,"-separator"),S]},_),[i.length>0?i:"/"])}}});D.Item=U;D.Separator=ee;D.install=function(l){return l.component(D.name,D),l.component(U.name,U),l.component(ee.name,ee),l};const tt={class:"flex flex-row w-full"},at={class:"flex flex-col w-full"},st={class:"flex flex-row items-center w-full mb-4 gap-2"},nt=k("br",null,null,-1),ot={class:"text-gray-500"},rt={class:"flex flex-row items-center w-full mb-4 gap-2"},lt=k("br",null,null,-1),ct={class:"text-gray-500"},ut={class:"flex flex-row items-center w-full mb-4 gap-2"},it=k("br",null,null,-1),dt={class:"text-gray-500"},mt=K({__name:"Misc",setup(l){const{includeM2M:n,showNull:f}=$e(),u=he(),r=ke(),{loadTables:C,hasEmptyOrNullFilters:c}=u,{base:x}=Ne(u),S=Ae(me,void 0),_=G(()=>{var e;return(S==null?void 0:S.value)??((e=x.value)==null?void 0:e.id)}),{t:i}=ue();ie(n,async()=>await C());const a=H();Ie(async()=>{var e;await r.loadProject(_.value,!0),a.value=(e=r.getProjectMeta(_.value))==null?void 0:e.showNullAndEmptyInFilter});async function p(e){const s=r.bases.get(_.value);if(!s)throw new Error(`Base ${_.value} not found`);const v=r.getProjectMeta(_.value)??{};e.target.checked||await c()&&(a.value=!0,Re.warning(i("msg.error.nullFilterExists")));const y={...v,showNullAndEmptyInFilter:a.value};s.meta=y,await r.updateProject(_.value,{meta:JSON.stringify(y)})}return(e,s)=>{const v=Ue,y=de("e");return d(),E("div",tt,[k("div",at,[k("div",st,[Q((d(),h(v,{checked:o(n),"onUpdate:checked":s[0]||(s[0]=w=>R(n)?n.value=w:null),class:"nc-settings-meta-misc"},{default:b(()=>[I(A(e.$t("msg.info.showM2mTables"))+" ",1),nt,k("span",ot,A(e.$t("msg.info.showM2mTablesDesc")),1)]),_:1},8,["checked"])),[[y,["c:themes:show-m2m-tables"]]])]),k("div",rt,[Q((d(),h(v,{checked:o(f),"onUpdate:checked":s[1]||(s[1]=w=>R(f)?f.value=w:null),class:"nc-settings-show-null"},{default:b(()=>[I(A(e.$t("msg.info.showNullInCells"))+" ",1),lt,k("span",ct,A(e.$t("msg.info.showNullInCellsDesc")),1)]),_:1},8,["checked"])),[[y,["c:settings:show-null"]]])]),k("div",ut,[Q((d(),h(v,{checked:o(a),"onUpdate:checked":s[2]||(s[2]=w=>R(a)?a.value=w:null),class:"nc-settings-show-null-and-empty-in-filter",onChange:p},{default:b(()=>[I(A(e.$t("msg.info.showNullAndEmptyInFilter"))+" ",1),it,k("span",dt,A(e.$t("msg.info.showNullAndEmptyInFilterDesc")),1)]),_:1},8,["checked"])),[[y,["c:settings:show-null-and-empty-in-filter"]]])])])])}}}),pt=l=>(Oe("data-v-8f0fa7c7"),l=l(),Fe(),l),ft={class:"flex flex-row justify-between w-full items-center mb-1"},_t=["onClick"],vt={class:"select-none"},bt={key:1},yt={class:"flex items-center"},gt=pt(()=>k("a",{class:"!no-underline"},"Data Sources",-1)),ht={key:0,class:"flex flex-row justify-end items-center w-full gap-1"},kt={key:0,class:"flex items-center gap-2 font-light"},wt={class:"flex items-center gap-2 text-gray-600 font-light"},Ct={class:"h-[600px]"},xt=K({__name:"Modal",props:{modelValue:{type:Boolean},openKey:{},dataSourcesState:{},baseId:{}},emits:["update:modelValue","update:openKey","update:dataSourcesState"],setup(l,{emit:n}){const f=l,u=n,r=q(f,"modelValue",u),C=q(f,"openKey",u),c=q(f,"dataSourcesState",u),x=Be(f,"baseId");Me(me,x);const{$e:S}=je(),{t:_}=ue(),i=H(!1),a=H(!1),p={baseSettings:{title:_("labels.projectSettings"),icon:J.settings,subTabs:{misc:{key:"Misc",title:_("general.misc"),body:mt}},onClick:()=>{S("c:settings:base-settings")}}},e=g=>Object.keys(g)[0],s=G({get:()=>[Object.keys(p).find(g=>g===C.value)||e(p)],set:g=>{C.value=g[0]}}),v=G(()=>p[s.value[0]]),y=H([e(v.value.subTabs)]),w=G(()=>v.value.subTabs[y.value[0]]),M=g=>{a.value=g};return ie(()=>s.value[0],g=>{y.value=[e(p[g].subTabs)]}),(g,t)=>{const B=Le,P=Te,O=Ee,V=Z,j=ze,L=U,pe=D,fe=Ge,_e=Je,ve=We,be=De,ye=de("e");return d(),h(be,{visible:o(r),"onUpdate:visible":t[9]||(t[9]=$=>R(r)?r.value=$:null),class:oe({active:o(r)}),footer:null,width:"max(90vw, 600px)",closable:!1,"wrap-class-name":"nc-modal-settings",onCancel:t[10]||(t[10]=$=>u("update:modelValue",!1))},{default:b(()=>[k("div",ft,[m(B,{class:"ml-4 select-none",type:"secondary",level:5},{default:b(()=>[I(A(g.$t("activity.settings")),1)]),_:1}),m(P,{type:"text",class:"!rounded-md border-none !px-1.5","data-testid":"settings-modal-close-button",onClick:t[0]||(t[0]=$=>r.value=!1)},{default:b(()=>[(d(),h(T(o(J).close),{class:"cursor-pointer nc-modal-close w-4"}))]),_:1})]),m(ve,{class:"mt-3 h-[75vh] overflow-y-auto flex"},{default:b(()=>[m(j,null,{default:b(()=>[m(V,{"selected-keys":o(s),"onUpdate:selectedKeys":t[1]||(t[1]=$=>R(s)?s.value=$:null),class:"tabs-menu h-full","open-keys":[]},{default:b(()=>[(d(),E(se,null,ne(p,($,z)=>m(O,{key:z,class:"!active:ring-0 !hover:bg-primary !hover:bg-opacity-25"},{default:b(()=>[k("div",{class:"flex items-center space-x-2",onClick:$.onClick},[(d(),h(T($.icon))),k("div",vt,A($.title),1)],8,_t)]),_:2},1024)),64))]),_:1},8,["selected-keys"])]),_:1}),m(_e,{class:"h-auto px-4 scrollbar-thumb-gray-500"},{default:b(()=>{var $,z;return[o(s)[0]!=="dataSources"?(d(),h(V,{key:0,selectedKeys:o(y),"onUpdate:selectedKeys":t[2]||(t[2]=N=>R(y)?y.value=N:null),"open-keys":[],mode:"horizontal"},{default:b(()=>[(d(!0),E(se,null,ne(o(v).subTabs,(N,ge)=>(d(),h(O,{key:ge,class:"!active:ring-0 select-none",onClick:N.onClick},{default:b(()=>[I(A(N.title),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["selectedKeys"])):(d(),E("div",bt,[k("div",yt,[m(pe,{class:"w-full cursor-pointer"},{default:b(()=>[o(c)!==""?(d(),h(L,{key:0,onClick:t[3]||(t[3]=N=>c.value="")},{default:b(()=>[gt]),_:1})):(d(),h(L,{key:1,onClick:t[4]||(t[4]=N=>c.value="")},{default:b(()=>[I("Data Sources")]),_:1})),o(c)!==""?(d(),h(L,{key:2},{default:b(()=>[I(A(o(c)),1)]),_:1})):W("",!0)]),_:1}),o(c)===""?(d(),E("div",ht,[o(a)?(d(),h(P,{key:0,type:"primary",class:"self-start !rounded-md nc-btn-new-datasource",onClick:t[5]||(t[5]=N=>c.value=o(Pe).New)},{default:b(()=>[o(c)===""?(d(),E("div",kt,[(d(),h(T(o(J).plusCircle),{class:"group-hover:text-accent"})),I(" New ")])):W("",!0)]),_:1})):W("",!0),Q((d(),h(P,{type:"text",class:"self-start !rounded-md nc-btn-metasync-reload",onClick:t[6]||(t[6]=N=>i.value=!0)},{default:b(()=>[k("div",wt,[(d(),h(T(o(J).reload),{class:oe({"animate-infinite animate-spin !text-success":o(i)})},null,8,["class"])),I(" "+A(g.$t("general.reload")),1)])]),_:1})),[[ye,["a:proj-meta:data-sources:reload"]]])])):W("",!0)]),m(fe,{style:{margin:"10px 0"}})])),k("div",Ct,[o(y)[0]==="dataSources"?(d(),h(T(($=o(w))==null?void 0:$.body),{key:0,state:o(c),"onUpdate:state":t[7]||(t[7]=N=>R(c)?c.value=N:null),reload:o(i),"onUpdate:reload":t[8]||(t[8]=N=>R(i)?i.value=N:null),class:"px-2 pb-2","data-testid":`nc-settings-subtab-${o(w).key}`,"base-id":o(x),onAwaken:M},null,40,["state","reload","data-testid","base-id"])):(d(),h(T((z=o(w))==null?void 0:z.body),{key:1,class:"px-2 py-6","base-id":o(x),"data-testid":`nc-settings-subtab-${o(w).key}`},null,8,["base-id","data-testid"]))])]}),_:1})]),_:1})]),_:1},8,["visible","class"])}}});const qt=He(xt,[["__scopeId","data-v-8f0fa7c7"]]);export{qt as default};
