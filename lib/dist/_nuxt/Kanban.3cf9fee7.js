import{f as xt,r as m,bb as L,bA as kt,ba as W,u as It,bF as Ct,aM as Rt,$ as Vt,g as O,a7 as Me,l as St,H as Oe,eN as Dt,c9 as Lt,o as l,c as p,a as c,aK as le,O as e,U as J,V as we,P as s,dy as be,w as r,b as _,au as Q,Q as z,R as $,d as R,t as f,T as y,W as P,S as F,eW as he,d4 as Pe,a0 as V,a1 as S,ce as zt,cf as $t,p as jt,e as At,fk as Et}from"./entry.5958c07b.js";import{_ as Tt}from"./DeleteModal.vue.0320a9db.js";import{M as Mt,A as Ot,R as Pt,h as Ft,O as Ut,f as Ht,b as Bt,z as Nt,c as qt,y as Kt,q as Gt,j as Wt,F as Jt}from"./index.9b87fcff.js";import{u as Qt}from"./views.4281cbf1.js";import{A as Yt}from"./cell.165313cd.js";import{e as ne}from"./dataUtils.3f874ca1.js";import{i as Xt}from"./fileUtils.43128440.js";import{u as Zt}from"./useAttachment.6cac8464.js";import{a as eo}from"./useKanbanViewStore.9f7f1dc5.js";import{f as to}from"./bases.e6c8e3c4.js";import{_ as oo}from"./chevron-right.ec8c7e51.js";import{_ as ao,a as lo}from"./FileIconImageBox.f602208f.js";import{D as Fe}from"./vuedraggable.umd.00f5fccc.js";import{D as no}from"./index.dc13a4d6.js";import{C as so}from"./index.f98c1d80.js";import{_ as ro}from"./Input.8209df88.js";import{b as io,a as uo,_ as co}from"./index.99a44a23.js";import{_ as mo}from"./index.bed897b5.js";import{_ as po}from"./index.07078df6.js";import{_ as _o}from"./_plugin-vue_export-helper.c27b6911.js";import"./Button.vue.c3ca0e8f.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./Modal.vue.ee5af191.js";import"./useSharedView.e8f68616.js";import"./urlUtils.18c797fa.js";import"./deepCompare.d32ec333.js";import"./useSmartsheetStore.f1a70558.js";import"./index.e61e381a.js";import"./index.0feaca99.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./index.912f77e8.js";import"./useState.b891c8bb.js";import"./useRefs.40c81887.js";import"./identity.34c7640e.js";import"./_flatRest.39582a58.js";import"./isMobile.e2e89480.js";import"./index.357e1bba.js";import"./Col.a97e3e76.js";import"./responsiveObserve.0baefba6.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./Element.a1e4f356.js";import"./LeftOutlined.1d2f193f.js";const fo=V(()=>S(()=>import("./TruncateText.e4dca382.js"),["./TruncateText.e4dca382.js","./TruncateText.vue.104d33b8.js","./entry.5958c07b.js","./entry.bdecbb78.css"],import.meta.url).then(n=>n.default||n)),vo=V(()=>S(()=>import("./Image.36097f59.js"),["./Image.36097f59.js","./entry.5958c07b.js","./entry.bdecbb78.css"],import.meta.url).then(n=>n.default||n)),go=V(()=>S(()=>import("./VirtualCell.3d02a7f6.js"),["./VirtualCell.3d02a7f6.js","./entry.5958c07b.js","./entry.bdecbb78.css","./index.9b87fcff.js","./virtualCell.427fa223.js","./cell.165313cd.js"],import.meta.url).then(n=>n.default||n)),yo=V(()=>S(()=>import("./Cell.2a47fcd0.js"),["./Cell.2a47fcd0.js","./entry.5958c07b.js","./entry.bdecbb78.css","./index.9b87fcff.js","./cell.165313cd.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./useSmartsheetRowStore.5b92cc1b.js","./deepCompare.d32ec333.js","./dataUtils.3f874ca1.js","./virtualCell.427fa223.js","./index.e61e381a.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.f27da8af.css"],import.meta.url).then(n=>n.default||n)),wo=V(()=>S(()=>import("./VirtualCell.276a28e0.js"),["./VirtualCell.276a28e0.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./EditOrAddProvider.vue.31035ffc.js","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./views.4281cbf1.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./useSharedView.e8f68616.js","./validation.2de04583.js","./index.b06c8b67.js","./FormItem.0bbf90a3.js","./identity.34c7640e.js","./_getPrototype.c1f3bae2.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./toArray.fd74ce6f.js","./FormItemContext.ddc65fa5.js","./useSize.fad35fe8.js","./_flatRest.39582a58.js","./isPlainObject.ccda79fe.js","./vuedraggable.umd.00f5fccc.js","./v3-infinite-loading.660bd977.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.a517903c.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./cell.165313cd.js","./index.5e1434a7.js","./Checkbox.2e7b0035.js","./createForOfIteratorHelper.33de41ba.js","./index.5c6e4286.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./EditOrAddProvider.9247d0ff.css","./virtualCell.427fa223.js","./VirtualCell.ff98befc.css"],import.meta.url).then(n=>n.default||n)),bo=V(()=>S(()=>import("./Cell.0991f33c.js"),["./Cell.0991f33c.js","./entry.5958c07b.js","./entry.bdecbb78.css","./CellIcon.b1340151.js","./index.9b87fcff.js","./cell.165313cd.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./EditOrAddProvider.vue.31035ffc.js","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./views.4281cbf1.js","./useSharedView.e8f68616.js","./validation.2de04583.js","./index.b06c8b67.js","./FormItem.0bbf90a3.js","./identity.34c7640e.js","./_getPrototype.c1f3bae2.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./toArray.fd74ce6f.js","./FormItemContext.ddc65fa5.js","./useSize.fad35fe8.js","./_flatRest.39582a58.js","./isPlainObject.ccda79fe.js","./vuedraggable.umd.00f5fccc.js","./v3-infinite-loading.660bd977.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.a517903c.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./index.5e1434a7.js","./Checkbox.2e7b0035.js","./createForOfIteratorHelper.33de41ba.js","./index.5c6e4286.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./EditOrAddProvider.9247d0ff.css","./Cell.14116970.css"],import.meta.url).then(n=>n.default||n)),ho=V(()=>S(()=>import("./Row.3bf51c0f.js"),["./Row.3bf51c0f.js","./index.9b87fcff.js","./useSmartsheetRowStore.5b92cc1b.js","./entry.5958c07b.js","./entry.bdecbb78.css","./deepCompare.d32ec333.js","./dataUtils.3f874ca1.js","./virtualCell.427fa223.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./index.e61e381a.js","./useSmartsheetStore.f1a70558.js","./views.4281cbf1.js","./useSharedView.e8f68616.js"],import.meta.url).then(n=>n.default||n)),xo=V(()=>S(()=>import("./Pagination.cfda58a8.js"),["./Pagination.cfda58a8.js","./Pagination.c0f166a7.js","./Icon.vue.129448d5.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./index.5c6e4286.js","./toArray.fd74ce6f.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./SearchOutlined.a517903c.js","./FormItemContext.ddc65fa5.js","./Pagination.fabf8b70.css","./views.4281cbf1.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./useSharedView.e8f68616.js","./index.9b87fcff.js","./sidebar.f5d81718.js","./index.025c8e21.js","./index.36af7517.js","./Element.a1e4f356.js","./Input.8209df88.js","./Image.c63a7a56.js","./index.ae235b22.js","./Input.dca3a2bc.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./Pagination.9422c247.css"],import.meta.url).then(n=>n.default||n)),ko=V(()=>S(()=>import("./index.caa4cb22.js").then(n=>n.i),["./index.caa4cb22.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Icon.vue.129448d5.js","./Menu.vue.6c65c050.js","./Menu.eff4a609.css","./Divider.7b1fba82.js","./index.07078df6.js","./Divider.3e739d27.css","./Dropdown.vue.0d2ed10f.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./DivDataCell.7c09732c.js","./index.9b87fcff.js","./DivDataCell.1a716a1e.css","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./UserIcon.74e37fbe.js","./UserIcon.fda3e825.css","./config.c8203633.js","./sidebar.f5d81718.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./views.4281cbf1.js","./useSharedView.e8f68616.js","./dataUtils.3f874ca1.js","./index.e61e381a.js","./useKanbanViewStore.9f7f1dc5.js","./deepCompare.d32ec333.js","./useSmartsheetStore.f1a70558.js","./useSmartsheetRowStore.5b92cc1b.js","./virtualCell.427fa223.js","./iconify.e2b5aaa4.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./FormItemContext.ddc65fa5.js","./SearchOutlined.a517903c.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./Modal.vue.0f13e4cb.js","./DeleteModal.7ab6f524.css","./DeleteModal.vue.0320a9db.js","./Modal.vue.ee5af191.js","./useDashboard.7eae7d45.js","./index.c35df397.js","./Input.8209df88.js","./Element.a1e4f356.js","./index.35cd520e.css"],import.meta.url).then(n=>n.default||n)),Ue=n=>(jt("data-v-519f1825"),n=n(),At(),n),Io={key:0,class:"flex flex-row min-h-full gap-x-2"},Co={key:0,class:"mt-2.5 px-3 !w-full"},Ro={class:"nc-kanban-stack-head font-medium flex items-center"},Vo={key:0,class:"w-full flex w-[15px]"},So={class:"py-2 flex gap-2 items-center"},Do={class:"py-2 flex gap-1.8 items-center"},Lo={class:"py-2 flex gap-2 items-center"},zo=["data-stack-title"],$o={class:"nc-kanban-item py-2 pl-3 pr-2"},jo=Ue(()=>c("a",null,[c("div",{class:"pt-[12px]"},[c("div")])],-1)),Ao={class:"z-10 arrow"},Eo={class:"z-10 arrow"},To={key:1,class:"h-52 w-full !flex flex-row !border-b-1 !border-gray-200 items-center justify-center"},Mo=Ue(()=>c("img",{class:"object-contain w-[48px] h-[48px]",src:lo},null,-1)),Oo=[Mo],Po={key:0,class:"text-base mt-3 mx-3 font-bold"},Fo={class:"flex flex-col first:mt-3 ml-2 !pr-3.5 !mb-[0.75rem] rounded-lg w-full"},Uo={class:"flex flex-row w-full justify-start scale-75"},Ho={class:"w-full pb-1 text-gray-300"},Bo={key:0,class:"flex flex-row w-full text-gray-700 px-1 mt-[-0.25rem] items-center justify-start"},No={key:1,class:"flex flex-row w-full h-[1.375rem] pl-1 items-center justify-start"},qo={class:"!rounded-lg !px-3 pt-3"},Ko={key:0,class:"text-center"},Go={class:"nc-kanban-data-count text-gray-500"},Wo=["onClick"],Jo=["onClick"],Qo={key:0,class:"mt-4 px-3 !w-full"},Yo={key:1,class:"nc-kanban-data-count mt-[12px] mx-[10px]"},Xo={class:"nc-base-menu-item nc-kanban-context-menu-item"},Zo={class:"nc-base-menu-item nc-kanban-context-menu-item"},ea={key:0,class:"flex flex-row items-center py-2 px-2.25 bg-gray-100 rounded-lg text-gray-700 mb-4"},ta={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},oa=100,aa=xt({__name:"Kanban",setup(n){const se=m(),h=L(Mt,m()),Y=L(Ot,m()),re=L(Pt),ie=L(Ft),E=L(Ut,kt()),w=L(Ht,m(!1)),x=L(Bt,m(!1)),U=m(!1),de=m(),xe=m();W(Nt,m(1));const H=m(!1),X=m(""),ke=m(0),ue=It(),B=ue.currentRoute,{getPossibleAttachmentSrc:He}=Zt(),{loadKanbanData:Ie,loadMoreKanbanData:Be,loadKanbanMeta:ce,kanbanMetaData:me,formattedData:j,updateOrSaveRow:Ne,updateKanbanMeta:qe,addEmptyRow:Ke,groupingFieldColOptions:v,updateKanbanStackMeta:Ge,groupingField:Ce,countByStack:g,deleteStack:We,shouldScrollToRight:Re,deleteRow:Je,moveHistory:Ve}=eo(),{isViewDataLoading:Z}=Ct(Qt()),{isUIAllowed:Qe}=Rt(),{appInfo:Ye}=Vt(),{addUndo:Xe,defineViewScope:Ze}=to();W(qt,m(!1)),W(Kt,m(!1)),W(Gt,m(!1)),W(Wt,m(!0));const k=O(()=>Qe("dataEdit")),Se=L(Jt,m([])),et=O(()=>Se.value.filter(t=>!Yt(t))),D=O(()=>{var t,o;return((o=(t=h.value)==null?void 0:t.columns)==null?void 0:o.find(d=>d.pv&&Se.value.includes(d)))??null}),N=O(()=>{var t,o;return(t=h.value)!=null&&t.columnsById?h.value.columnsById[(o=me.value)==null?void 0:o.fk_cover_image_col_id]:{}}),pe=m(),ee=m(""),tt=(t,o)=>{const d=t.row[o.title];return d?Array.isArray(d)&&d.length===0:!0};re==null||re.on(async()=>{await ce(),await Ie()});const _e=t=>{var o;try{return(o=N.value)!=null&&o.title&&t.row[N.value.title]?typeof t.row[N.value.title]=="string"?JSON.parse(t.row[N.value.title]):t.row[N.value.title]:[]}catch{return[]}},fe=m(!1);ie==null||ie.on(async()=>{await ce(),fe.value=!0,Me(()=>{fe.value=!1})});const ve=(t,o)=>{const d=ne(t.row,h.value.columns);d?ue.push({query:{...B.value.query,rowId:d}}):(de.value=t,xe.value=o,U.value=!0)},De=m(!1),T=O({get:()=>De.value,set:t=>{k.value&&(De.value=t)}}),M=m(null),ot=(t,o)=>{t.preventDefault(),o&&(M.value=o)},te=O({get(){return!!B.value.query.rowId},set(t){t||ue.push({query:{...B.value.query,rowId:void 0}})}}),at=async(t,o)=>{const d=t.target;d.closest(".arrow")||d.closest(".slick-dots")||t.target&&ve(o)};function lt(t){if(t.draggedContext.futureIndex===0)return!1}async function ge(t,o=!1){if(t.moved){const{oldIndex:d,newIndex:b}=t.moved,{fk_grp_col_id:I,meta:oe}=me.value;v.value[d].order=b,v.value[b].order=d;const q=JSON.parse(oe)||{};q[I]=v.value,await qe({meta:q}),o||Xe({undo:{fn:async C=>{const K=v.value.splice(C.moved.newIndex,1);v.value.splice(C.moved.oldIndex,0,K[0]),await ge(C,!0)},args:[{moved:{oldIndex:d,newIndex:b}}]},redo:{fn:async C=>{const K=v.value.splice(C.moved.oldIndex,1);v.value.splice(C.moved.newIndex,0,K[0]),await ge(C,!0)},args:[{moved:{oldIndex:d,newIndex:b}},!0]},scope:Ze({view:Y.value})})}}async function nt(t,o){if(t.added){const d=t.added.element;Ve.value.unshift({op:"added",pk:ne(t.added.element.row,h.value.columns),index:t.added.newIndex,stack:o}),d.row[Ce.value]=o,g.value.set(o,g.value.get(o)+1),await Ne(d)}else t.removed&&(g.value.set(o,g.value.get(o)-1),Ve.value.unshift({op:"removed",pk:ne(t.removed.element.row,h.value.columns),index:t.removed.oldIndex,stack:o}))}const Le=Et(async t=>{if(t.target.scrollTop+t.target.clientHeight+oa>=t.target.scrollHeight){const o=t.target.getAttribute("data-stack-title"),d=Ye.value.defaultLimit||25,b=j.value.get(o);if(b){const I=Math.ceil(b.length/d);await Be(o,{offset:I*d})}}}),st=t=>{t&&(t.removeEventListener("scroll",Le),t.addEventListener("scroll",Le))},rt=(t,o)=>{H.value=!0,X.value=t,ke.value=o},it=async()=>{await We(X.value,ke.value),H.value=!1},ze=async t=>{v.value[t].collapsed=!v.value[t].collapsed,x.value||await Ge()},$e=async()=>{const t=await Ke();t.row={[Ce.value]:ee.value===""?null:ee.value},g.value.set(null,g.value.get(null)+1),ve(t)};E==null||E.on($e),St(()=>E.off($e)),Oe(T,()=>{T.value||(M.value=null)}),Oe(Y,async t=>{if((t==null?void 0:t.type)===Dt.KANBAN){Z.value=!0;try{await ce(),Z.value=!1,await Ie(),Me(()=>{Re.value&&(pe.value.scrollTo({left:pe.value.scrollWidth,behavior:"smooth"}),Re.value=!1)})}catch(o){console.error(o),Z.value=!1}}},{immediate:!0});const dt=t=>{const o=ne(t.row,h.value.columns);return o?`row-${o}`:""};return(t,o)=>{const d=ro,b=fo,I=zt,oe=$t,q=no,C=io,K=ao,ut=oo,ct=vo,mt=mo,je=go,Ae=yo,pt=wo,_t=bo,ye=so,ft=ho,vt=uo,gt=co,yt=po,wt=xo,Ee=ko,bt=Tt,G=Lt("e");return l(),p(J,null,[c("div",{class:"flex flex-col w-full bg-white","data-testid":"nc-kanban-wrapper",style:le({minHeight:"calc(100vh - var(--topbar-height))"})},[c("div",{ref_key:"kanbanContainerRef",ref:pe,class:"nc-kanban-container flex mt-4 pb-4 px-4 overflow-y-hidden w-full nc-scrollbar-x-lg",style:le({minHeight:"calc(100vh - var(--topbar-height) - 4.1rem)",maxHeight:"calc(100vh - var(--topbar-height) - 4.1rem)"})},[e(Z)?(l(),p("div",Io,[(l(!0),p(J,null,we(Array(20),a=>(l(),s(d,{key:a,class:"!min-w-80 !min-h-full !rounded-xl overflow-hidden"}))),128))])):(l(),s(q,{key:1,visible:e(T),"onUpdate:visible":o[9]||(o[9]=a=>P(T)?T.value=a:null),trigger:["contextmenu"],"overlay-class-name":"nc-dropdown-kanban-context-menu"},be({default:r(()=>[_(e(Fe),{modelValue:e(v),"onUpdate:modelValue":o[2]||(o[2]=a=>P(v)?v.value=a:null),class:"flex gap-4","item-key":"id",group:"kanban-stack",draggable:".nc-kanban-stack",filter:".not-draggable",move:lt,onStart:o[3]||(o[3]=a=>a.target.classList.add("grabbing")),onEnd:o[4]||(o[4]=a=>a.target.classList.remove("grabbing")),onChange:o[5]||(o[5]=a=>ge(a))},{item:r(({element:a,index:ae})=>[c("div",{class:F(["nc-kanban-stack",{"w-[50px]":a.collapsed}])},[a.collapsed?(l(),s(ye,{key:`${a.id}-collapsed`,style:le(`background-color: ${a.color} !important`),class:F(["nc-kanban-collapsed-stack mx-4 flex items-center w-[300px] h-[50px] !rounded-xl cursor-pointer h-full !pr-[10px] overflow-hidden",{"not-draggable":a.title===null||e(w)||e(x)||!e(k)}]),"body-style":{padding:"0px",height:"100%",width:"100%",background:"#f0f2f5 !important"}},{default:r(()=>[c("div",{class:"items-center justify-between",onClick:i=>ze(ae)},[!e(j).get(a.title)||!e(g)?(l(),p("div",Qo,[_(d,{active:!0,class:"!w-full !h-4 !rounded-lg overflow-hidden"})])):(l(),p("div",Yo,[c("div",{class:F(["float-right flex gap-2 items-center cursor-pointer font-bold",{capitalize:a.title===null}])},[_(b,null,{default:r(()=>[R(f(a.title??"uncategorized"),1)]),_:2},1024),(l(),s(z(e($).arrowDown),{class:"text-grey text-lg"}))],2),R(f(e(j).get(a.title).length)+" / "+f(e(g).get(a.title))+" "+f(e(g).get(a.title)!==1?t.$t("objects.records"):t.$t("objects.record")),1)]))],8,Jo)]),_:2},1032,["style","class"])):(l(),s(ye,{key:`${a.id}-${ae}`,class:F(["mx-4 !bg-gray-100 flex flex-col w-80 h-full !rounded-xl overflow-y-hidden",{"not-draggable":a.title===null||e(w)||e(x)||!e(k),"!cursor-default":e(w)||!e(k)}]),"head-style":{paddingBottom:"0px"},"body-style":{padding:"0px",height:"100%",borderRadius:"0.75rem !important",paddingBottom:"0rem"}},{default:r(()=>[c("div",{style:le(`background-color: ${a.color}`),class:"nc-kanban-stack-head-color h-[10px] mt-3 mx-3 rounded-full"},null,4),!e(j).get(a.title)||!e(g)?(l(),p("div",Co,[_(d,{active:!0,class:"!w-full !h-9.75 !rounded-lg overflow-hidden"})])):(l(),s(gt,{key:1,class:"!bg-gray-100"},{default:r(()=>[_(C,null,{default:r(()=>[c("div",Ro,[_(q,{trigger:["click"],"overlay-class-name":"nc-dropdown-kanban-stack-context-menu",class:"bg-white !rounded-lg"},be({default:r(()=>[c("div",{class:F(["flex items-center w-full mx-2 px-3 py-1",{capitalize:a.title===null,"cursor-pointer":!e(w)}])},[_(b,null,{default:r(()=>[R(f(a.title??"uncategorized"),1)]),_:2},1024),e(w)?y("",!0):(l(),p("span",Vo,[(l(),s(z(e($).arrowDown),{class:"text-grey text-lg ml-auto"}))]))],2)]),_:2},[e(w)?void 0:{name:"overlay",fn:r(()=>[_(oe,{class:"ml-6 !text-sm !px-0 !py-2 !rounded"},{default:r(()=>[e(k)&&!e(x)&&!e(w)?Q((l(),s(I,{key:0,onClick:()=>{ee.value=a.title,e(E).trigger(a.title)}},{default:r(()=>[c("div",So,[(l(),s(z(e($).plus),{class:"text-gray-500"})),R(" "+f(t.$t("activity.addNewRecord")),1)])]),_:2},1032,["onClick"])),[[G,["c:kanban:add-new-record"]]]):y("",!0),Q((l(),s(I,{onClick:i=>ze(ae)},{default:r(()=>[c("div",Do,[(l(),s(z(e($).arrowCollapse),{class:"text-gray-500"})),R(" "+f(t.$t("activity.kanban.collapseStack")),1)])]),_:2},1032,["onClick"])),[[G,["c:kanban:collapse-stack"]]]),a.title!==null&&!e(x)&&e(k)?Q((l(),s(I,{key:1,onClick:i=>rt(a.title,ae)},{default:r(()=>[c("div",Lo,[(l(),s(z(e($).delete),{class:"text-gray-500"})),R(" "+f(t.$t("activity.kanban.deleteStack")),1)])]),_:2},1032,["onClick"])),[[G,["c:kanban:delete-stack"]]]):y("",!0)]),_:2},1024)]),key:"0"}]),1024)])]),_:2},1024),_(vt,{class:"overflow-y-hidden mt-1",style:{"max-height":"calc(100% - 11rem)"}},{default:r(()=>[c("div",{ref:st,class:"nc-kanban-list h-full nc-scrollbar-dark-md","data-stack-title":a.title},[_(e(Fe),{list:e(j).get(a.title),"item-key":"row.Id",draggable:".nc-kanban-item",group:"kanban-card",class:"h-full",filter:".not-draggable",onStart:o[0]||(o[0]=i=>i.target.classList.add("grabbing")),onEnd:o[1]||(o[1]=i=>i.target.classList.remove("grabbing")),onChange:i=>nt(i,a.title)},{item:r(({element:i,index:ht})=>[c("div",$o,[_(ft,{row:i},{default:r(()=>{var Te;return[(l(),s(ye,{key:`${dt(i)}-${ht}`,class:F(["!rounded-lg h-full border-gray-200 border-1 group overflow-hidden break-all max-w-[450px] shadow-sm hover:shadow-md cursor-pointer",{"not-draggable":e(w)||!e(k)||e(x),"!cursor-default":e(w)||!e(k)||e(x)}]),"body-style":{padding:"0px"},"data-stack":a.title,"data-testid":`nc-gallery-card-${i.row.id}`,onClick:u=>at(u,i),onContextmenu:u=>ot(u,i)},be({default:r(()=>[e(D)?(l(),p("h2",Po,[e(he)(e(D))?(l(),s(je,{key:0,modelValue:i.row[e(D).title],"onUpdate:modelValue":u=>i.row[e(D).title]=u,class:"!text-brand-500",column:e(D),row:i},null,8,["modelValue","onUpdate:modelValue","column","row"])):(l(),s(Ae,{key:1,modelValue:i.row[e(D).title],"onUpdate:modelValue":u=>i.row[e(D).title]=u,class:"!text-brand-500",column:e(D),"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"]))])):y("",!0),(l(!0),p(J,null,we(e(et),u=>(l(),p("div",{key:`record-${i.row.id}-${u.id}`},[c("div",Fo,[c("div",Uo,[c("div",Ho,[e(he)(u)?(l(),s(pt,{key:0,column:u,"hide-menu":!0,"hide-icon":!0},null,8,["column"])):(l(),s(_t,{key:1,column:u,"hide-menu":!0,"hide-icon":!0},null,8,["column"]))])]),tt(i,u)?(l(),p("div",No,"-")):(l(),p("div",Bo,[e(he)(u)?(l(),s(je,{key:0,modelValue:i.row[u.title],"onUpdate:modelValue":A=>i.row[u.title]=A,column:u,row:i},null,8,["modelValue","onUpdate:modelValue","column","row"])):(l(),s(Ae,{key:1,modelValue:i.row[u.title],"onUpdate:modelValue":A=>i.row[u.title]=A,column:u,"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"]))]))])]))),128))]),_:2},[(Te=e(me))!=null&&Te.fk_cover_image_col_id?{name:"cover",fn:r(()=>[!e(fe)&&_e(i).length?(l(),s(mt,{key:_e(i).reduce((u,A)=>u+(A==null?void 0:A.path),""),class:"gallery-carousel !border-b-1 !border-gray-200"},{customPaging:r(()=>[jo]),prevArrow:r(()=>[c("div",Ao,[_(K,{class:"text-gray-700 w-6 h-6 absolute left-1.5 bottom-[-90px] !opacity-0 !group-hover:opacity-100 !bg-white border-1 border-gray-200 rounded-md transition"})])]),nextArrow:r(()=>[c("div",Eo,[_(ut,{class:"text-gray-700 w-6 h-6 absolute right-1.5 bottom-[-90px] !opacity-0 !group-hover:opacity-100 !bg-white border-1 border-gray-200 rounded-md transition"})])]),default:r(()=>[(l(!0),p(J,null,we(_e(i),u=>(l(),p(J,null,[e(Xt)(u.title,u.mimetype??u.type)?(l(),s(ct,{key:u.path,class:"h-52 object-cover",srcs:e(He)(u)},null,8,["srcs"])):y("",!0)],64))),256))]),_:2},1024)):(l(),p("div",To,Oo))]),key:"0"}:void 0]),1032,["data-stack","data-testid","class","onClick","onContextmenu"]))]}),_:2},1032,["row"])])]),_:2},1032,["list","onChange"])],8,zo)]),_:2},1024),c("div",qo,[e(j).get(a.title)?(l(),p("div",Ko,[c("div",Go,f(e(j).get(a.title).length)+" / "+f(e(g).get(a.title)??0)+" "+f(e(g).get(a.title)!==1?t.$t("objects.records"):t.$t("objects.record")),1),c("div",{class:"flex flex-row w-full mt-3 justify-between items-center cursor-pointer bg-white px-4 py-2 rounded-lg border-gray-100 border-1 shadow-sm shadow-gray-100",onClick:()=>{ee.value=a.title,e(E).trigger(a.title)}},[R(" Add Record "),!e(x)&&!e(w)?(l(),s(z(e($).plus),{key:0,class:""})):y("",!0)],8,Wo)])):y("",!0)])]),_:2},1024))]),_:2},1032,["class"]))],2)]),_:1},8,["modelValue"])]),_:2},[!e(w)&&!e(x)&&e(k)?{name:"overlay",fn:r(()=>[_(oe,{class:"shadow !rounded !py-0",onClick:o[8]||(o[8]=a=>T.value=!1)},{default:r(()=>[e(M)?(l(),s(I,{key:0,onClick:o[6]||(o[6]=a=>ve(e(M)))},{default:r(()=>[Q((l(),p("div",Xo,[(l(),s(z(e($).expand),{class:"flex"})),R(f(t.$t("activity.expandRecord")),1)])),[[G,["a:kanban:expand-record"]]])]),_:1})):y("",!0),_(yt,{class:"!m-0 !p-0"}),e(M)?(l(),s(I,{key:1,onClick:o[7]||(o[7]=a=>e(Je)(e(M)))},{default:r(()=>[Q((l(),p("div",Zo,[(l(),s(z(e($).delete),{class:"flex"})),R(f(t.$t("activity.deleteRecord")),1)])),[[G,["a:kanban:delete-record"]]])]),_:1})):y("",!0)]),_:1})]),key:"0"}:void 0]),1032,["visible"]))],4),_(wt,{"pagination-data":e(se),"onUpdate:paginationData":o[10]||(o[10]=a=>P(se)?se.value=a:null),"align-count-on-right":"","hide-pagination":"",class:"!py-4"},null,8,["pagination-data"])],4),(l(),s(Pe,null,{default:r(()=>[e(de)&&e(U)?(l(),s(Ee,{key:0,modelValue:e(U),"onUpdate:modelValue":o[11]||(o[11]=a=>P(U)?U.value=a:null),row:e(de),state:e(xe),meta:e(h),view:e(Y)},null,8,["modelValue","row","state","meta","view"])):y("",!0)]),_:1})),(l(),s(Pe,null,{default:r(()=>[e(te)?(l(),s(Ee,{key:e(B).query.rowId,modelValue:e(te),"onUpdate:modelValue":o[12]||(o[12]=a=>P(te)?te.value=a:null),row:{row:{},oldRow:{},rowMeta:{}},meta:e(h),"row-id":e(B).query.rowId,view:e(Y)},null,8,["modelValue","meta","row-id","view"])):y("",!0)]),_:1})),_(bt,{visible:e(H),"onUpdate:visible":o[13]||(o[13]=a=>P(H)?H.value=a:null),"entity-name":"Stack","on-delete":it},{"entity-preview":r(()=>[e(X)?(l(),p("div",ea,[c("div",ta,f(e(X)),1)])):y("",!0)]),_:1},8,["visible"])],64)}}});const Ya=_o(aa,[["__scopeId","data-v-519f1825"]]);export{Ya as default};
