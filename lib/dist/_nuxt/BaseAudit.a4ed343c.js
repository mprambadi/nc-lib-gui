import{f as z,bF as M,M as $,r as l,$ as D,i as L,n as p,cy as P,af as V,o as y,c as w,O as e,T as j,a as d,t as h,b as u,w as I,P as G,Q as U,R as F,S as H,d as O,_ as k,W as R,a8 as Q,C as W}from"./entry.5958c07b.js";import{a as q}from"./bases.e6c8e3c4.js";import{_ as J}from"./index.712855bf.js";import{_ as K}from"./index.023e2de7.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.0feaca99.js";import"./eagerComputed.ab57921b.js";import"./useState.b891c8bb.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./toArray.fd74ce6f.js";import"./index.5c6e4286.js";import"./antInputDirective.8ac36ea7.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./CheckOutlined.1fe5f230.js";import"./SearchOutlined.a517903c.js";import"./FormItemContext.ddc65fa5.js";import"./index.0771e4e8.js";import"./index.5e1434a7.js";import"./Checkbox.2e7b0035.js";import"./createForOfIteratorHelper.33de41ba.js";import"./index.dc13a4d6.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./index.781e7bb1.js";import"./index.ae235b22.js";import"./Input.dca3a2bc.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./Password.f52125e7.js";import"./useBreakpoint.cbf2ba72.js";import"./responsiveObserve.0baefba6.js";import"./LeftOutlined.1d2f193f.js";const Y={class:"flex flex-col gap-4 w-full"},Z={key:0,class:"text-red-500"},tt={class:"flex flex-row justify-between items-center"},et={class:"mb-4 first-letter:capital font-bold"},at={class:"flex items-center gap-2 text-gray-600 font-light"},ot={class:"flex flex-row justify-center items-center"},st=z({__name:"BaseAudit",props:{sourceId:{}},setup(A){const g=A,B=q(),{base:x}=M(B),{$api:C}=W(),{t:o}=$(),c=l(!1),m=l(null),v=l(0),s=l(1),n=l(25),{appInfo:S}=D();async function _(t=s.value,a=n.value){try{if(!g.sourceId)return;c.value=!0;const{list:r,pageInfo:f}=await C.base.auditList(x.value.id,{offset:a*(t-1),limit:a,sourceId:g.sourceId});m.value=r,v.value=f.totalRows??0}catch(r){console.error(r)}finally{c.value=!1}}L(async()=>{m.value===null&&await _(s.value,n.value)});const i=t=>()=>p("div",{class:"text-gray-500"},t),E=[{title:i(o("labels.operationType")),dataIndex:"op_type",key:"op_type",width:120},{title:i(o("labels.operationSubType")),dataIndex:"op_sub_type",key:"op_sub_type",width:160},{title:i(o("labels.description")),dataIndex:"description",key:"description",customRender:t=>p("pre",{},t.text),width:350},{title:i(o("objects.user")),dataIndex:"user",key:"user",customRender:t=>p("div",{},t.text||"Shared base"),width:200},{title:i(o("labels.created")),dataIndex:"created_at",key:"created_at",sort:"desc",customRender:t=>p(V,{placement:"bottom",title:p("span",{},t.text)},()=>P(t.text)),width:"13%"}];return(t,a)=>{const r=Q,f=k,T=J,N=K;return y(),w("div",Y,[e(S).auditEnabled?j("",!0):(y(),w("div",Z,"Audit logs are currently disabled by administrators.")),d("div",tt,[d("h6",et,"Audit : "+h(e(x).title),1),u(r,{class:"self-start !rounded-md",onClick:_},{default:I(()=>[d("div",at,[(y(),G(U(e(F).reload),{class:H({"animate-infinite animate-spin !text-success":e(c)})},null,8,["class"])),O(" "+h(t.$t("general.reload")),1)])]),_:1})]),u(T,{class:"nc-audit-table w-full",size:"small","data-source":e(m)??[],columns:E,pagination:!1,loading:e(c),"data-testid":"audit-tab-table"},{emptyText:I(()=>[u(f,{image:e(k).PRESENTED_IMAGE_SIMPLE,description:t.$t("labels.noData")},null,8,["image","description"])]),_:1},8,["data-source","loading"]),d("div",ot,[u(N,{current:e(s),"onUpdate:current":a[0]||(a[0]=b=>R(s)?s.value=b:null),"page-size":e(n),"onUpdate:pageSize":a[1]||(a[1]=b=>R(n)?n.value=b:null),total:+e(v),"show-less-items":"",class:"pagination",onChange:_},null,8,["current","page-size","total"])])])}}});const Ut=X(st,[["__scopeId","data-v-95a4d4f3"]]);export{Ut as default};
