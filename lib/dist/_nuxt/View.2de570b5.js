import{o as r,c as v,a,f as oe,a5 as Ae,r as P,t as u,O as t,b as i,w as g,d as R,S as se,P as Q,U as ae,$ as Be,bb as Oe,g as V,eN as N,X as H,Y as G,c9 as De,au as J,W as E,T as j,cl as we,fn as Re,eV as te,C as ge,fo as ze,a0 as be,a1 as xe,L as Ee,bF as X,V as He,ae as We,a8 as $e,p as ke,e as Ce,n as Je,a3 as Ge,H as Ke,Q as Ye,fy as ye,aK as qe,ah as Qe}from"./entry.5958c07b.js";import{_ as Xe}from"./Tooltip.vue.971897f4.js";import{_ as ue}from"./_plugin-vue_export-helper.c27b6911.js";import{a as Se}from"./useSmartsheetStore.f1a70558.js";import{u as Me}from"./useDashboard.7eae7d45.js";import{u as Ue}from"./views.4281cbf1.js";import{b as Ze,e as et,a as Ve}from"./bases.e6c8e3c4.js";import{f as tt}from"./index.9b87fcff.js";import{i as st}from"./index.025c8e21.js";import{_ as at}from"./index.b076ba21.js";import{_ as ot}from"./Password.f52125e7.js";import{S as lt,_ as Le}from"./index.5c6e4286.js";import{_ as nt}from"./ProjectIcon.07026955.js";import{_ as it}from"./Button.vue.c3ca0e8f.js";import{u as rt}from"./useCopy.0241e728.js";import{u as de}from"./share.ce661e57.js";import{u as ct}from"./index.e61e381a.js";import{K as dt}from"./v3-infinite-loading.660bd977.js";import{A as ut}from"./index.122d98ae.js";import{S as Te}from"./index.55641318.js";const vt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pt=a("path",{fill:"currentColor",d:"M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"},null,-1),_t=[pt];function mt(d,p){return r(),v("svg",vt,[..._t])}const Ne={name:"mdi-content-copy",render:mt},ft={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ht=a("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),wt=[ht];function yt(d,p){return r(),v("svg",ft,[...wt])}const Fe={name:"mdi-check",render:yt},gt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},bt=a("path",{fill:"currentColor",d:"m14.6 16.6l4.6-4.6l-4.6-4.6L16 6l6 6l-6 6zm-5.2 0L4.8 12l4.6-4.6L8 6l-6 6l6 6z"},null,-1),xt=[bt];function $t(d,p){return r(),v("svg",gt,[...xt])}const kt={name:"mdi-code-tags",render:$t},Ct={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},St=a("path",{fill:"currentColor",d:"M10 6v2H5v11h11v-5h2v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm11-3v8h-2V6.413l-7.793 7.794l-1.414-1.414L17.585 5H13V3z"},null,-1),Mt=[St];function Ut(d,p){return r(),v("svg",Ct,[...Mt])}const Vt={name:"ri-external-link-line",render:Ut},Lt={class:"flex flex-row items-center justify-end text-gray-600 gap-x-1.5 py-1.5 px-1.5 bg-gray-50 rounded-md border-1 border-gray-200"},Tt={class:"overflow-hidden whitespace-nowrap text-gray-500"},Nt={class:"flex flex-row gap-x-1"},Ft={class:"flex text-xs",style:{fontWeight:500}},It=oe({__name:"CopyUrl",props:{url:{}},emits:["update:url"],setup(d,{emit:p}){const U=Ae(d,"url",p),$=P({link:!1,embed:!1}),A=async()=>{window.open(U.value,"_blank","noopener,noreferrer")},L=async()=>{await navigator.clipboard.writeText(`<iframe src="${U.value}" width="100%" height="100%" style="border: none;"></iframe>`),$.value.embed=!0},_=async()=>{$.value.link=!1,await navigator.clipboard.writeText(U.value),setTimeout(()=>{$.value.link=!0},100)};return(h,k)=>{const f=Vt,s=Xe,C=kt,F=Fe,z=Ne;return r(),v("div",Lt,[a("div",{class:"flex flex-row block flex-1 overflow-hidden pl-3 cursor-pointer",onClick:_},[a("div",Tt,u(t(U)),1)]),a("div",Nt,[i(s,null,{title:g(()=>[R(u(h.$t("activity.openInANewTab")),1)]),default:g(()=>[a("div",{class:"button",onClick:A},[i(f,{class:"h-3.75"})])]),_:1}),i(s,null,{title:g(()=>[R(u(h.$t("activity.copyIFrameCode")),1)]),default:g(()=>[a("div",{class:se(["button",{"!text-gray-300 !border-gray-200 !cursor-not-allowed":t($).embed}]),onClick:L},[i(C,{class:"h-4"})],2)]),_:1}),a("div",{class:"button","data-testid":"docs-share-page-copy-link",onClick:_},[t($).link?(r(),Q(F,{key:0,class:"h-3.5"})):(r(),Q(z,{key:1,class:"h-3.5"})),a("div",Ft,[t($).link?(r(),v(ae,{key:0},[R(u(h.$t("activity.copiedLink")),1)],64)):(r(),v(ae,{key:1},[R(u(h.$t("activity.copyUrl")),1)],64))])])])])}}});const jt=ue(It,[["__scopeId","data-v-2a8b3518"]]),Pt=be(()=>xe(()=>import("./ColorPicker.6829134a.js"),["./ColorPicker.6829134a.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Icon.vue.129448d5.js","./Tooltip.vue.092c15c5.js","./index.f98c1d80.js","./index.912f77e8.js","./Dropdown.041b2468.js","./useState.b891c8bb.js","./useRefs.40c81887.js","./identity.34c7640e.js","./isSymbol.114fe557.js","./_flatRest.39582a58.js","./isMobile.e2e89480.js","./index.357e1bba.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./_plugin-vue_export-helper.c27b6911.js","./ColorPicker.a103ccd5.css"],import.meta.url).then(d=>d.default||d)),At={class:"flex flex-col py-2 px-3 mb-1"},Bt={class:"flex flex-col w-full mt-2.5 px-3 py-2.5 border-gray-200 border-1 rounded-md gap-y-2"},Ot={class:"flex flex-row w-full justify-between py-0.5"},Dt={class:"text-gray-900 font-medium"},Rt={class:"mt-0.5 border-t-1 border-gray-100 pt-3"},zt={class:"flex flex-col justify-between mt-1 py-2 px-3 bg-gray-50 rounded-md"},Et={class:"flex flex-row justify-between"},Ht={class:"flex text-black"},Wt={key:0,class:"flex gap-2 mt-2 w-2/3"},Jt={class:"flex flex-col justify-between gap-y-3 mt-1 py-2 px-3 bg-gray-50 rounded-md"},Gt={key:0,class:"flex flex-row justify-between"},Kt={class:"flex text-black"},Yt={key:1,class:"flex flex-row justify-between"},qt={class:"text-black"},Qt={key:2,class:"flex flex-row justify-between"},Xt={class:"text-black"},Zt={key:3,class:"flex flex-col justify-between gap-y-1 bg-gray-50 rounded-md"},es={class:"flex flex-row justify-between"},ts={class:"text-black"},ss={key:0,class:"flex -ml-1"},as={key:4,class:"flex flex-col gap-3"},os={class:"text-black"},ls={class:"px-1 flex flex-col gap-2"},ns={class:"flex flex-row h-full justify-start items-center"},is={class:"flex flex-row h-full justify-start items-center"},rs={class:"flex flex-row h-full justify-start items-center"},cs={class:"flex flex-row h-full justify-start items-center"},ds=oe({__name:"SharePage",setup(d){const{view:p,$api:O}=Se(),{$e:b}=ge(),{getBaseUrl:U,appInfo:$}=Be(),{dashboardUrl:A}=Me(),L=Ue(),{metas:_}=Ze(),h=et(),k=Oe(tt,P(!1)),f=P({public:!1,password:!1,download:!1}),s=V({get:()=>{var e;return typeof((e=p.value)==null?void 0:e.meta)=="string"&&(p.value.meta=JSON.parse(p.value.meta)),p.value},set:e=>{var o;typeof((o=p.value)==null?void 0:o.meta)=="string"&&(p.value.meta=JSON.parse(p.value.meta)),typeof(e==null?void 0:e.meta)=="string"&&(e.meta=JSON.parse(e.meta)),p.value=e}}),C=V(()=>I()??""),F=V({get:()=>{var e;return((e=s.value)==null?void 0:e.meta.preFilledMode)||"default"},set:e=>{var o;(o=s.value)!=null&&o.meta&&(s.value.meta={...s.value.meta,preFilledMode:e},re())}}),z=P(!1),c=V(()=>{var e;return!!((e=s.value)!=null&&e.password)||z.value}),m=V({get:()=>{var e;return c.value?((e=s.value)==null?void 0:e.password)??"":""},set:async e=>{s.value&&(s.value={...s.value,password:c.value?e:null},T())}}),l=V({get:()=>{var e;return!!((e=s.value)!=null&&e.meta.withTheme)},set:e=>{var o;(o=s.value)!=null&&o.meta&&(s.value.meta={...s.value.meta,withTheme:e},Y())}}),n=async()=>{if(z.value=!c.value,!!s.value&&!f.value.password){f.value.password=!0;try{c.value?s.value={...s.value,password:null}:s.value={...s.value,password:""},await T()}finally{f.value.password=!1}}},w=V({get:()=>{var e,o,y,B;return(e=s.value)!=null&&e.meta?(typeof((o=s.value)==null?void 0:o.meta)=="string"&&(s.value.meta=JSON.parse(s.value.meta)),!!((B=(y=s.value)==null?void 0:y.meta)!=null&&B.rtl)):!1},set:e=>{var o,y;(o=s.value)!=null&&o.meta&&(typeof((y=s.value)==null?void 0:y.meta)=="string"&&(s.value.meta=JSON.parse(s.value.meta)),s.value.meta={...s.value.meta,rtl:e},T())}}),S=V({get:()=>{var e,o;return!!((o=(e=s.value)==null?void 0:e.meta)!=null&&o.allowCSVDownload)},set:async e=>{var o;if((o=s.value)!=null&&o.meta){f.value.download=!0;try{s.value.meta={...s.value.meta,allowCSVDownload:e},await ne()}finally{f.value.download=!1}}}}),x=V({get:()=>{var e;return!!((e=s.value)!=null&&e.meta.surveyMode)},set:e=>{var o;(o=s.value)!=null&&o.meta&&(s.value.meta={...s.value.meta,surveyMode:e},ie())}});function I(){var B;if(!s.value)return;let e;switch(s.value.type){case N.FORM:e="form";break;case N.KANBAN:e="kanban";break;case N.GALLERY:e="gallery";break;case N.MAP:e="map";break;default:e="view"}const o=U(h.activeWorkspaceId);let y=A.value;return o&&(y=`${o}${(B=$.value)==null?void 0:B.dashboardPath}`),encodeURI(`${y}#/nc/${e}/${s.value.uuid}`)}const D=async()=>{var e,o;if((e=s.value)!=null&&e.id)if((o=s.value)!=null&&o.uuid)await O.dbViewShare.delete(s.value.id),s.value={...s.value,uuid:void 0,password:void 0};else{const y=await O.dbViewShare.create(s.value.id);if(s.value={...s.value,...y},s.value.type===N.KANBAN){const B=_.value[L.activeView.fk_model_id].columns.find(ce=>ce.id===L.activeView.view.fk_grp_col_id);s.value.meta={...s.value.meta,groupingFieldColumn:B},await T()}}},le=async()=>{if(!f.value.public){f.value.public=!0;try{return await D()}catch(e){H.error(await G(e))}finally{f.value.public=!1}}};async function ne(){f.value.download=!0;try{await T(),b(`a:view:share:${S.value?"enable":"disable"}-csv-download`)}catch(e){H.error(await G(e))}f.value.download=!1}async function ie(){await T(),b(`a:view:share:${x.value?"enable":"disable"}-survey-mode`)}async function Y(){await T(),b(`a:view:share:${l.value?"enable":"disable"}-theme`)}async function re(){await T(),b(`a:view:share:${F.value}-prefilled-mode`)}async function T(){var e;try{if(!((e=s.value)!=null&&e.meta))return;const o=s.value.meta;await O.dbViewShare.update(s.value.id,{meta:o,password:s.value.password})}catch(o){H.error(await G(o))}return!0}function Z(e){var y;if(!((y=s.value)!=null&&y.meta))return;const o=ze(e);if(o.isValid()){const B=o.complement();s.value.meta.theme={primaryColor:e,accentColor:B.toHex8String()},Y()}}const q=V(()=>{var e;return!!((e=s.value)!=null&&e.uuid)});return(e,o)=>{var ve,pe,_e,me;const y=at,B=jt,ce=ot,je=Pt,ee=lt,Pe=Le,W=De("e");return r(),v("div",At,[a("div",Bt,[a("div",Ot,[a("div",Dt,u(e.$t("activity.enabledPublicViewing")),1),J(i(y,{"data-testid":"share-view-toggle",checked:t(q),loading:t(f).public,class:"share-view-toggle !mt-0.25",disabled:t(k),onClick:le},null,8,["checked","loading","disabled"]),[[W,["c:share:view:enable:toggle"]]])]),t(q)?(r(),v(ae,{key:0},[a("div",Rt,[i(B,{url:t(C),"onUpdate:url":o[0]||(o[0]=M=>E(C)?C.value=M:null)},null,8,["url"])]),a("div",zt,[a("div",Et,[a("div",Ht,u(e.$t("activity.restrictAccessWithPassword")),1),J(i(y,{"data-testid":"share-password-toggle",checked:t(c),loading:t(f).password,class:"share-password-toggle !mt-0.25",onClick:n},null,8,["checked","loading"]),[[W,["c:share:view:password:toggle"]]])]),i(we,{name:"layout",mode:"out-in"},{default:g(()=>[t(c)?(r(),v("div",Wt,[i(ce,{value:t(m),"onUpdate:value":o[1]||(o[1]=M=>E(m)?m.value=M:null),"data-testid":"nc-modal-share-view__password",class:"!rounded-lg !py-1 !bg-white",size:"small",type:"password",placeholder:e.$t("placeholder.password.enter")},null,8,["value","placeholder"])])):j("",!0)]),_:1})]),a("div",Jt,[t(s)&&(t(s).type===t(N).GRID||t(s).type===t(N).KANBAN||t(s).type===t(N).GALLERY||t(s).type===t(N).MAP)?(r(),v("div",Gt,[a("div",Kt,u(e.$t("activity.allowDownload")),1),J(i(y,{checked:t(S),"onUpdate:checked":o[2]||(o[2]=M=>E(S)?S.value=M:null),"data-testid":"share-download-toggle",loading:t(f).download,class:"public-password-toggle !mt-0.25"},null,8,["checked","loading"]),[[W,["c:share:view:allow-csv-download:toggle"]]])])):j("",!0),((ve=t(s))==null?void 0:ve.type)===t(N).FORM?(r(),v("div",Yt,[a("div",qt,u(e.$t("activity.surveyMode")),1),J(i(y,{checked:t(x),"onUpdate:checked":o[3]||(o[3]=M=>E(x)?x.value=M:null),"data-testid":"nc-modal-share-view__surveyMode"},null,8,["checked"]),[[W,["c:share:view:surver-mode:toggle"]]])])):j("",!0),((pe=t(s))==null?void 0:pe.type)===t(N).FORM&&("isEeUI"in e?e.isEeUI:t(st))?(r(),v("div",Qt,[a("div",Xt,u(e.$t("activity.rtlOrientation")),1),J(i(y,{checked:t(w),"onUpdate:checked":o[4]||(o[4]=M=>E(w)?w.value=M:null),"data-testid":"nc-modal-share-view__RTL"},null,8,["checked"]),[[W,["c:share:view:rtl-orientation:toggle"]]])])):j("",!0),((_e=t(s))==null?void 0:_e.type)===t(N).FORM?(r(),v("div",Zt,[a("div",es,[a("div",ts,u(e.$t("activity.useTheme")),1),J(i(y,{"data-testid":"share-theme-toggle",checked:t(l),loading:t(f).password,class:"share-theme-toggle !mt-0.25",onClick:o[5]||(o[5]=M=>l.value=!t(l))},null,8,["checked","loading"]),[[W,["c:share:view:theme:toggle"]]])]),i(we,{name:"layout",mode:"out-in"},{default:g(()=>{var M,fe,he;return[t(l)?(r(),v("div",ss,[i(je,{"data-testid":"nc-modal-share-view__theme-picker",class:"!p-0 !bg-inherit","model-value":(he=(fe=(M=t(s))==null?void 0:M.meta)==null?void 0:fe.theme)==null?void 0:he.primaryColor,colors:"baseThemeColors"in e?e.baseThemeColors:t(Re),"row-size":9,advanced:!1,onInput:Z},null,8,["model-value","colors"])])):j("",!0)]}),_:1})])):j("",!0),((me=t(s))==null?void 0:me.type)===t(N).FORM&&!t(x)?(r(),v("div",as,[a("div",os,u(e.$t("msg.info.preFilledFields.title")),1),a("div",ls,[a("div",null,[i(Pe,{value:t(F),"onUpdate:value":o[6]||(o[6]=M=>E(F)?F.value=M:null),class:"w-full"},{default:g(()=>[i(ee,{value:("preFilledModes"in e?e.preFilledModes:t(te)).Default},{default:g(()=>[a("div",ns,u(e.$t("msg.info.preFilledFields.optionAllow")),1)]),_:1},8,["value"]),i(ee,{value:("preFilledModes"in e?e.preFilledModes:t(te)).Disabled},{default:g(()=>[a("div",is,u(e.$t("msg.info.preFilledFields.optionDisable")),1)]),_:1},8,["value"]),i(ee,{value:("preFilledModes"in e?e.preFilledModes:t(te)).Locked},{default:g(()=>[a("div",rs,u(e.$t("msg.info.preFilledFields.optionLock")),1)]),_:1},8,["value"]),i(ee,{value:("preFilledModes"in e?e.preFilledModes:t(te)).Hidden},{default:g(()=>[a("div",cs,u(e.$t("msg.info.preFilledFields.optionHide")),1)]),_:1},8,["value"])]),_:1},8,["value"])])])])):j("",!0)])],64)):j("",!0)])])}}});const us={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},vs=a("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59z"},null,-1),ps=[vs];function _s(d,p){return r(),v("svg",us,[...ps])}const ms={name:"mdi-tick",render:_s},[fs,hs]=ct(()=>{const{api:d}=Ee(),{base:p}=X(Ve()),{$e:O}=ge(),{formStatus:b,invitationUsersData:U}=X(de()),$=P(1),A=P(10),L=P(""),_=P(null),h=P(null),k=P(0),f=P(!1),s=V(()=>!_.value||!h.value?[]:_.value.filter(c=>{var l;const m=(l=h.value)==null?void 0:l.find(n=>n.id===c.id);return m?c.roles!==m.roles:!1})),C=async(c=$.value,m=A.value)=>{var l,n;try{if(!((l=p.value)!=null&&l.id))return;const w=await d.auth.baseUserList((n=p.value)==null?void 0:n.id,{query:{limit:m,offset:(c-1)*m,query:L.value}});if(!w.users)return;const S=w.users.list.filter(x=>!x.roles);k.value=(w.users.pageInfo.totalRows??0)-Number(S==null?void 0:S.length),_.value?_.value=[..._.value,...w.users.list.filter(x=>x.roles)]:_.value=w.users.list.filter(x=>x.roles),h.value=JSON.parse(JSON.stringify(_.value))}catch(w){H.error(await G(w))}};return{loadUsers:C,inviteUser:async c=>{var l;let m;b.value="base-collaborateSaving";try{if(!((l=p.value)!=null&&l.id))return;m=await d.auth.baseUserAdd(p.value.id,{...c,base_id:p.value.id,baseName:p.value.title}),U.value.invitationToken=m.invite_token,$.value=1,_.value=[],await C()}catch(n){H.error(await G(n)),b.value="collaborate";return}return b.value="base-collaborateSaved",O("a:user:add"),m},users:_,totalUsers:k,searchText:L,currentPage:$,currentLimit:A,editedUsers:s,updateEditedUsers:async c=>{var m,l;c=c||s.value,f.value=!0;try{await Promise.all(c.filter(n=>n.roles!=="No access").map(async n=>{var S;await d.auth.baseUserUpdate(p.value.id,n.id,{email:n.email,roles:n.roles,base_id:p.value.id,baseName:p.value.title});const w=(S=_.value)==null?void 0:S.find(x=>x.id===n.id);w&&(w.roles=n.roles)})),await Promise.all(c.filter(n=>n.roles==="No access").map(async n=>{await d.auth.baseUserRemove(p.value.id,n.id)})),_.value=((m=_.value)==null?void 0:m.filter(n=>n.roles!=="No access"))??[],k.value=((l=_.value)==null?void 0:l.length)??0,h.value=JSON.parse(JSON.stringify(_.value))}catch(n){H.error(await G(n))}finally{f.value=!1}},isBatchUpdating:f}},"useManageUsers");function ws(){const d=hs();return d||fs()}const ys={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},gs=a("path",{fill:"currentColor",d:"M20 11v2H8l5.5 5.5l-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5L8 11z"},null,-1),bs=[gs];function xs(d,p){return r(),v("svg",ys,[...bs])}const $s={name:"mdi-arrow-left",render:xs},K=d=>(ke("data-v-26290339"),d=d(),Ce(),d),ks={class:"flex flex-col mx-4 h-112"},Cs=K(()=>a("div",{class:"flex mt-2.5 mb-2.5 border-b-1 border-gray-50 pb-1.5",style:{fontWeight:500}},"Manage Members",-1)),Ss=K(()=>a("div",{class:"flex mt-2.5 mb-2.5 text-xs font-bold"},"Base Owner",-1)),Ms={key:0,class:"flex flex-row px-2 py-2 items-center gap-x-2 border-1 border-gray-100 rounded-md"},Us={class:"flex flex-col justify-center"},Vs={class:"flex",style:{fontWeight:500}},Ls=K(()=>a("div",{class:"flex flex-grow"},null,-1)),Ts={class:"flex flex-row mt-4 mb-2 pt-3 border-gray-100 border-t-1 gap-x-3 items-center text-xs"},Ns=K(()=>a("div",{style:{fontWeight:500}},"People with access",-1)),Fs={class:"bg-gray-50 border-gray-100 border-1 py-0.5 px-1.5 rounded-md","data-testid":"nc-manage-user-user-count"},Is={class:"flex flex-col mb-2 pr-0.5 h-96 overflow-y-auto users-list border-b-1 border-gray-100"},js={key:0,class:"text-xs mt-2"},Ps=["data-testid"],As={class:"flex flex-row items-center gap-x-2"},Bs={class:"flex flex-col justify-center"},Os={class:"flex",style:{fontWeight:500}},Ds=["data-testid"],Rs={key:0,class:"flex"},zs={key:1,class:"flex text-red-500",style:{fontWeight:500}},Es={class:"flex flex-row w-full justify-center mt-2"},Hs=K(()=>a("span",null,null,-1)),Ws={class:"flex flex-row justify-between pt-3 pb-2"},Js=K(()=>a("div",null,"Back to Share",-1)),Gs=oe({__name:"ManageUsers",emits:["close"],setup(d,{emit:p}){const O=p,{users:b,totalUsers:U,editedUsers:$,currentPage:A,loadUsers:L,updateEditedUsers:_,isBatchUpdating:h}=ws(),k=V(()=>{var c;return(c=b.value)==null?void 0:c.find(m=>{var l;return(l=m.roles)==null?void 0:l.includes("owner")})}),f=V(()=>{var c;return((c=b.value)==null?void 0:c.filter(m=>{var l;return!((l=m.roles)!=null&&l.includes("owner"))}))||[]}),s=()=>{O("close",!1)},C=c=>!c.firstname&&!c.lastname,F=async c=>{var l,n,w;const m=((l=b.value)==null?void 0:l.length)||0;if(((n=b.value)==null?void 0:n.length)===U.value){c.complete();return}if(c.loading(),await L(),A.value+=1,m===((w=b.value)==null?void 0:w.length)){c.complete();return}c.loaded()},z=[{id:"Creator",name:"Creator",value:"creator"},{id:"Editor",name:"Editor",value:"editor"},{id:"Commenter",name:"Commenter",value:"commenter"},{id:"Viewer",name:"Viewer",value:"viewer"},{id:"None",name:"Remove",value:"No access"}];return(c,m)=>{const l=ut,n=Le,w=Te,S=$s,x=$e;return r(),v("div",ks,[Cs,Ss,t(k)?(r(),v("div",Ms,[i(l),a("div",Us,[a("div",Vs,u(t(k).firstname)+" "+u(t(k).lastname),1),a("div",{class:se(["flex text-xs",{"text-gray-500":!C(t(k))}])},u(t(k).email),3)])])):j("",!0),Ls,a("div",Ts,[Ns,a("div",Fs,u(t(U)-1)+" users ",1)]),a("div",Is,[t(f).length===0?(r(),v("div",js,"No users have access to this base")):j("",!0),(r(!0),v(ae,null,He(t(f),I=>(r(),v("div",{key:I.id,class:"flex flex-row mb-1.5 px-2 py-1.5 items-center border-1 border-gray-100 rounded-md justify-between","data-testid":`nc-manage-users-${I.email}`},[a("div",As,[i(l),a("div",Bs,[a("div",Os,u(I.firstname)+" "+u(I.lastname),1),a("div",{class:se(["flex text-xs",{"text-gray-500":!C(I)}])},u(I.email),3)])]),i(n,{value:I.roles,"onUpdate:value":D=>I.roles=D,class:"flex !rounded-md p-0.5 !bg-white capitalize nc-dropdown-user-role-container !min-w-26","dropdown-class-name":"nc-dropdown-user-role !rounded-md",placeholder:"Select role",options:z},{option:g(D=>[a("div",{class:"flex flex-row items-center gap-x-2","data-testid":`nc-manage-users-role-${D.id!=="None"?D.name:"Remove"}`},[D.id!=="None"?(r(),v("div",Rs,u(D.name),1)):(r(),v("div",zs,"Remove"))],8,Ds)]),_:2},1032,["value","onUpdate:value"])],8,Ps))),128)),i(t(dt),We(c.$attrs,{onInfinite:F}),{spinner:g(()=>[a("div",Es,[i(w)])]),complete:g(()=>[Hs]),_:1},16)]),a("div",Ws,[a("div",{class:"flex flex-row items-center gap-x-2 px-2 rounded-md cursor-pointer hover:bg-gray-50",onClick:s},[i(S),Js]),i(x,{type:"primary",class:"!rounded-md",disabled:t($).length===0,loading:t(h),"data-testid":"nc-manage-users-submit",onClick:m[0]||(m[0]=()=>t(_)())},{default:g(()=>[R(" Save Changes ")]),_:1},8,["disabled","loading"])])])}}});const Ks=ue(Gs,[["__scopeId","data-v-26290339"]]),Ys=be(()=>xe(()=>import("./ShareBase.361e3269.js"),["./ShareBase.361e3269.js","./entry.5958c07b.js","./entry.bdecbb78.css","./bases.e6c8e3c4.js","./index.0feaca99.js","./useDashboard.7eae7d45.js","./index.b076ba21.js","./FormItemContext.ddc65fa5.js","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./_plugin-vue_export-helper.c27b6911.js","./useSmartsheetStore.f1a70558.js","./views.4281cbf1.js","./useSharedView.e8f68616.js","./index.9b87fcff.js","./index.e61e381a.js","./index.025c8e21.js","./Password.f52125e7.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./index.5c6e4286.js","./toArray.fd74ce6f.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./SearchOutlined.a517903c.js","./ProjectIcon.07026955.js","./Icon.vue.129448d5.js","./ProjectIcon.c2be51ae.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./Button.ff10bcb0.css","./useCopy.0241e728.js","./share.ce661e57.js","./v3-infinite-loading.660bd977.js","./index.122d98ae.js","./useBreakpoint.cbf2ba72.js","./responsiveObserve.0baefba6.js","./useSize.fad35fe8.js","./eagerComputed.ab57921b.js","./index.9c85d421.js"],import.meta.url).then(d=>d.default||d)),Ie=d=>(ke("data-v-c8e55e3f"),d=d(),Ce(),d),qs={key:0,class:"flex flex-row w-full px-5 justify-between items-center py-1"},Qs=Ie(()=>a("div",{class:"flex text-base font-bold"},"Adding Members",-1)),Xs={key:1,class:"flex flex-col py-1.5"},Zs={class:"flex flex-row w-full px-5 justify-between items-center py-0.5"},ea=Ie(()=>a("div",{class:"flex text-base font-medium"},"Members added",-1)),ta={class:"flex"},sa={class:"flex flex-row mx-3 mt-2.5 pt-3.5 border-t-1 border-gray-100 justify-end gap-x-2"},aa={key:0,class:"flex flex-row items-center gap-x-1"},oa={key:1,class:"flex flex-row items-center gap-x-1"},la={key:2},na={key:3,class:"flex flex-col px-1"},ia={class:"flex flex-row justify-between items-center pb-1 mx-4 mt-3"},ra={class:"flex text-base font-medium"},ca={key:0,class:"share-view"},da={class:"flex flex-row items-center gap-x-2 px-4 pt-3 pb-3 select-none"},ua={class:"max-w-79/100 ml-2 px-2 py-0.5 rounded-md bg-gray-100 capitalize text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap"}},va={class:"share-base"},pa={class:"flex flex-row items-center gap-x-2 px-4 pt-3 pb-3 select-none"},_a={class:"max-w-79/100 ml-2 px-2 py-0.5 rounded-md bg-gray-100 capitalize text-ellipsis overflow-hidden",style:{wordBreak:"keep-all",whiteSpace:"nowrap"}},ma={class:"flex flex-row justify-end mx-3 mt-1 mb-2 pt-4 gap-x-2"},fa=oe({__name:"View",props:{isViewToolbar:{type:Boolean}},setup(d){const{copy:p}=rt(),{dashboardUrl:O}=Me(),b=Ve(),{base:U}=X(b),{navigateToProjectPage:$}=b,{activeView:A}=X(Ue());let L;if(d.isViewToolbar)try{L=Se().view}catch(l){console.error(l)}const{formStatus:_,showShareModal:h,invitationUsersData:k,isInvitationLinkCopied:f}=X(de()),{resetData:s}=de(),C=P(!1),F=V(()=>k.value.invitationToken?`${O.value}#/signup/${k.value.invitationToken}`:null),z=Je(Ge,{style:{fontSize:"24px"},spin:!0}),c=async()=>{await p(F.value),f.value=!0},m=async()=>{C.value=!0;try{await $({page:"collaborator"}),h.value=!1}catch(l){console.error(l),H.error("Failed to open manage access")}finally{C.value=!1}};return Ke(h,l=>{l||setTimeout(()=>{s()},500)}),(l,n)=>{const w=Te,S=Fe,x=$e,I=ms,D=Ne,le=ds,ne=nt,ie=Ys,Y=it,re=Qe;return r(),Q(re,{visible:t(h),"onUpdate:visible":n[3]||(n[3]=T=>E(h)?h.value=T:null),class:se(["!top-[1%]",{active:t(h)}]),"wrap-class-name":"nc-modal-share-collaborate",closable:!1,"mask-closable":t(_)!=="base-collaborateSaving","ok-button-props":{hidden:!0},"cancel-button-props":{hidden:!0},footer:null,width:t(_)==="manageCollaborators"?"60rem":"40rem"},{default:g(()=>{var T,Z,q,e;return[t(_)==="base-collaborateSaving"?(r(),v("div",qs,[Qs,i(w,{indicator:t(z)},null,8,["indicator"])])):t(_)==="base-collaborateSaved"?(r(),v("div",Xs,[a("div",Zs,[ea,a("div",ta,[i(S)])]),a("div",sa,[i(x,{type:"text",class:"!border-1 !border-gray-200 !rounded-md",onClick:n[0]||(n[0]=o=>h.value=!1)},{default:g(()=>[R("Close ")]),_:1}),i(x,{type:"text",class:"!border-1 !border-gray-200 !rounded-md","data-testid":"docs-share-invitation-copy","data-invite-link":t(F),onClick:c},{default:g(()=>[t(f)?(r(),v("div",aa,[i(I,{class:"h-3.5"}),R(" "+u(l.$t("activity.copiedInviteLink")),1)])):(r(),v("div",oa,[i(D,{class:"h-3.3"}),R(" "+u(l.$t("activity.copyInviteLink")),1)]))]),_:1},8,["data-invite-link"])])])):t(_)==="manageCollaborators"?(r(),v("div",la,[t(_)==="manageCollaborators"?(r(),Q(Ks,{key:0,onClose:n[1]||(n[1]=o=>_.value="collaborate")})):j("",!0)])):(r(),v("div",na,[a("div",ia,[a("div",ra,u(l.$t("activity.share")),1)]),l.isViewToolbar&&t(A)?(r(),v("div",ca,[a("div",da,[(r(),Q(Ye((Z=("viewIcons"in l?l.viewIcons:t(ye))[(T=t(L))==null?void 0:T.type])==null?void 0:Z.icon),{class:"nc-view-icon group-hover",style:qe({color:(e=("viewIcons"in l?l.viewIcons:t(ye))[(q=t(L))==null?void 0:q.type])==null?void 0:e.color})},null,8,["style"])),a("div",null,u(l.$t("activity.shareView")),1),a("div",ua,u(t(A).title),1)]),i(le)])):j("",!0),a("div",va,[a("div",pa,[i(ne,{type:t(U).type,class:"nc-view-icon group-hover"},null,8,["type"]),a("div",null,u(l.$t("activity.shareBase.label")),1),a("div",_a,u(t(U).title),1)]),i(ie)]),a("div",ma,[i(Y,{type:"secondary","data-testid":"docs-cancel-btn",onClick:n[2]||(n[2]=o=>h.value=!1)},{default:g(()=>[R(u(l.$t("general.close")),1)]),_:1}),i(Y,{"data-testid":"docs-share-manage-access",type:"secondary",loading:t(C),onClick:m},{default:g(()=>[R(u(l.$t("activity.manageProjectAccess")),1)]),_:1},8,["loading"])])]))]}),_:1},8,["visible","class","mask-closable","width"])}}});const ha=ue(fa,[["__scopeId","data-v-c8e55e3f"]]),Ba=Object.freeze(Object.defineProperty({__proto__:null,default:ha},Symbol.toStringTag,{value:"Module"}));export{Ba as V,jt as _};
