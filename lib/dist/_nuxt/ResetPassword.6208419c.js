import{f as U,L as $,M as C,$ as q,r as F,N as V,o as _,c as v,a as p,t as g,b as a,w as n,cl as k,O as r,d as h,T as B,P as M,Q as N,R as z,X as T,D as j,a8 as D}from"./entry.96205fa0.js";import{_ as E}from"./warning.9842a9cd.js";import{F as G}from"./index.886d43e1.js";import{_ as I}from"./Password.803cc3dc.js";import{_ as L}from"./FormItem.9f1f85f2.js";import"./useSize.c98e621d.js";import"./identity.309e9ead.js";import"./isSymbol.d46b4957.js";import"./_flatRest.ce557a88.js";import"./debounce.1d5af9bf.js";import"./toNumber.ed208f2f.js";import"./isPlainObject.631eb8fb.js";import"./_getPrototype.459a70cf.js";import"./FormItemContext.b19eb48c.js";import"./Input.3f1aaf0c.js";import"./antInputDirective.8ac36ea7.js";import"./Col.b3c5d725.js";import"./responsiveObserve.358bcfe9.js";import"./toArray.3561b70e.js";const O={class:"mx-auto relative flex flex-col justify-start gap-2 w-full px-8 md:bg-white max-w-[900px]"},S={class:"text-xl my-4 text-left font-weight-bold"},A={key:0,class:"mx-auto mb-4 bg-red-500 text-white rounded-lg w-3/4 p-1"},Q={"data-testid":"nc-user-settings-form__error",class:"flex items-center gap-2 justify-center","data-rec":"true"},W={class:"text-right"},X={class:"flex justify-center items-center gap-2","data-rec":"true"},_e=U({__name:"ResetPassword",setup(H){const{api:y,error:l}=$({useGlobalInstance:!0}),{t}=C(),{signOut:R}=q(),f=F(),e=V({currentPassword:"",password:"",passwordRepeat:""}),u={currentPassword:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")}],password:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")},{min:8,message:t("msg.error.signUpRules.passwdLength")}],passwordRepeat:[{required:!0,message:t("msg.error.signUpRules.passwdRequired")},{validator:(s,o)=>new Promise((m,d)=>{if(e.password===e.passwordRepeat)return m(!0);d(new Error(t("msg.error.signUpRules.passwdMismatch")))}),message:t("msg.error.signUpRules.passwdMismatch")}]},b=async()=>{f.value.validate()&&(l.value=null,await y.auth.passwordChange({currentPassword:e.currentPassword,newPassword:e.password}),T.success(t("msg.success.passwordChanged")),await R(),await j("/signin"))},c=()=>{l.value&&(l.value=null)};return(s,o)=>{const m=E,d=I,w=L,P=D,x=G;return _(),v("div",O,[p("div",S,g(s.$t("activity.changePwd")),1),a(x,{ref_key:"formValidator",ref:f,"data-testid":"nc-user-settings-form",layout:"vertical",class:"change-password lg:max-w-3/4 w-full","no-style":"",model:r(e),onFinish:b},{default:n(()=>[a(k,{name:"layout"},{default:n(()=>[r(l)?(_(),v("div",A,[p("div",Q,[a(m),h(" "+g(r(l)),1)])])):B("",!0)]),_:1}),a(w,{label:s.$t("placeholder.password.current"),"data-rec":"true",name:"currentPassword",rules:u.currentPassword},{default:n(()=>[a(d,{value:r(e).currentPassword,"onUpdate:value":o[0]||(o[0]=i=>r(e).currentPassword=i),"data-testid":"nc-user-settings-form__current-password",size:"large",class:"password",placeholder:s.$t("placeholder.password.current"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(w,{label:s.$t("placeholder.password.new"),"data-rec":"true",name:"password",rules:u.password},{default:n(()=>[a(d,{value:r(e).password,"onUpdate:value":o[1]||(o[1]=i=>r(e).password=i),"data-testid":"nc-user-settings-form__new-password",size:"large",class:"password",placeholder:s.$t("placeholder.password.new"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(w,{label:s.$t("placeholder.password.confirm"),"data-rec":"true",name:"passwordRepeat",rules:u.passwordRepeat},{default:n(()=>[a(d,{value:r(e).passwordRepeat,"onUpdate:value":o[2]||(o[2]=i=>r(e).passwordRepeat=i),"data-testid":"nc-user-settings-form__new-password-repeat",size:"large",class:"password",placeholder:s.$t("placeholder.password.confirm"),onFocus:c},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),p("div",W,[a(P,{size:"middle","data-testid":"nc-user-settings-form__submit",class:"!rounded-md !h-[2.5rem]",type:"primary","html-type":"submit"},{default:n(()=>[p("div",X,[(_(),M(N(r(z).passwordChange))),h(" "+g(s.$t("activity.changePwd")),1)])]),_:1})])]),_:1},8,["model"])])}}});export{_e as default};
