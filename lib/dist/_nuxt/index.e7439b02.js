import{_ as Je,a as Be,b as Xe,c as Ee}from"./AirtableImport.vue.87c9d20e.js";import{f as le,aF as oe,a5 as De,o as c,P as U,w as n,a as t,t as r,b as o,O as e,W as H,r as B,C as be,bF as q,g as Q,aM as Re,c9 as Ue,c as g,T as M,au as ze,S as X,Q as Oe,U as ae,V as Te,d as V,cp as Ze,aK as Me,a0 as ee,a1 as te,cq as et,cr as tt,cs as st,cg as ot,ct as at,cu as Se,i as lt,cv as Ie,X as J,Y as ue,q as nt,cw as de,cx as it,cy as rt,cz as ct,cA as he,M as dt,bE as F,H as Z,cB as A,R as ut,cn as _t,af as pt,u as vt,$ as Pe,bH as mt,cC as ft,co as bt}from"./entry.96205fa0.js";import{_ as yt}from"./OpenLeftSidebarBtn.vue.a2351f83.js";import{_ as gt}from"./ProjectIcon.384805e6.js";import{_ as $e}from"./Tooltip.vue.00c0d0fb.js";import{_ as _e}from"./Icon.vue.6d0583a0.js";import{_ as Le}from"./Modal.vue.b787f37f.js";import{u as we}from"./index.a2bc84ea.js";import{_ as ke}from"./_plugin-vue_export-helper.c27b6911.js";import{c as je,u as Ce,a as xe,d as ht,e as wt}from"./bases.965a49bb.js";import{a as xt,_ as $t}from"./Button.vue.02ce6d5b.js";import{_ as kt}from"./UserIcon.7f59375b.js";import{_ as Ct}from"./Badge.vue.534403d1.js";import{S as St,_ as It}from"./index.b5e393d6.js";import{i as fe}from"./index.5b05c4cf.js";import{u as Dt,_ as zt}from"./magnifying-glass-bold.194922aa.js";import"./index.1431a68b.js";import{I as jt}from"./Input.3f1aaf0c.js";import{_ as Rt}from"./DeleteModal.vue.49c1a59b.js";import{u as Ne}from"./config.bc9920dc.js";import{D as Tt}from"./vuedraggable.umd.5a03c14e.js";import{_ as Mt}from"./index.4a1cb0c9.js";import{_ as At,T as Bt}from"./index.e1ceba77.js";import{u as Et}from"./tab.e875c8a8.js";import"./validation.64563eeb.js";import"./workerUtils.81f9c0e3.js";import"./index.886d43e1.js";import"./FormItem.9f1f85f2.js";import"./identity.309e9ead.js";import"./isSymbol.d46b4957.js";import"./_getPrototype.459a70cf.js";import"./Col.b3c5d725.js";import"./responsiveObserve.358bcfe9.js";import"./toArray.3561b70e.js";import"./toNumber.ed208f2f.js";import"./FormItemContext.b19eb48c.js";import"./useSize.c98e621d.js";import"./_flatRest.ce557a88.js";import"./debounce.1d5af9bf.js";import"./isPlainObject.631eb8fb.js";import"./Password.803cc3dc.js";import"./index.26c1c1ff.js";import"./CheckOutlined.3b90c20d.js";import"./useRefs.3fea1e39.js";import"./useState.5a301439.js";import"./index.c968c966.js";import"./index.d579646c.js";import"./isMobile.e2e89480.js";import"./index.0b4c0f1e.js";import"./Checkbox.cf2cdba0.js";import"./createForOfIteratorHelper.f2005dfe.js";import"./index.9e8f59f4.js";import"./Modal.vue.3dac5189.js";import"./views.2c163cf7.js";import"./useSharedView.9e320acb.js";import"./index.9b87fcff.js";import"./index.208c1883.js";import"./index.c4d36e30.js";import"./sidebar.30294def.js";import"./index.0c5b3837.js";import"./antInputDirective.8ac36ea7.js";import"./useMemo.dbc63a5f.js";import"./SearchOutlined.c9794270.js";import"./TextArea.b81a19ed.js";import"./Dropdown.1dedd322.js";const Ut={class:"flex flex-col px-8 pt-6 pb-9"},Ot={class:"text-lg font-medium mb-6"},Pt={class:"row mb-10"},Lt={class:"label"},Nt={class:"label"},Vt={class:"row"},Gt={class:"label"},Qt={class:"label"},Ht=le({__name:"ImportModal",props:{visible:{type:Boolean},source:{}},emits:["update:visible"],setup(p,{emit:S}){const x=p,C=S,_=oe(x,"source"),I=De(x,"visible",C),{$e:m}=be();function L(b,h){if(!b||!h)return;m("a:actions:import-airtable");const u=B(!0),{close:i}=we(Je,{modelValue:u,baseId:b,sourceId:h,"onUpdate:modelValue":s});function s(){u.value=!1,i(1e3)}}function O(b){if(!_.value.id)return;m(`a:actions:import-${b}`);const h=B(!0),{close:u}=we(Be,{modelValue:h,importType:b,sourceId:_.value.id,"onUpdate:modelValue":i});function i(){h.value=!1,u(1e3)}}const D=b=>{I.value=!1,b==="airtable"?L(_.value.base_id,_.value.id):O(b)};return(b,h)=>{const u=_e,i=Le;return c(),U(i,{visible:e(I),"onUpdate:visible":h[4]||(h[4]=s=>H(I)?I.value=s:null),width:"35rem"},{default:n(()=>[t("div",Ut,[t("div",Ot,r(b.$t("general.import")),1),t("div",Pt,[t("div",{class:"nc-base-view-import-sub-btn",onClick:h[0]||(h[0]=s=>D("airtable"))},[o(u,{icon:"airtable"}),t("div",Lt,r(b.$t("labels.airtable")),1)]),t("div",{class:"nc-base-view-import-sub-btn",onClick:h[1]||(h[1]=s=>D("csv"))},[o(u,{icon:"csv"}),t("div",Nt,r(b.$t("labels.csv")),1)])]),t("div",Vt,[t("div",{class:"nc-base-view-import-sub-btn",onClick:h[2]||(h[2]=s=>D("excel"))},[o(u,{icon:"excelColored"}),t("div",Gt,r(b.$t("labels.excel")),1)]),t("div",{class:"nc-base-view-import-sub-btn",onClick:h[3]||(h[3]=s=>D("json"))},[o(u,{icon:"code"}),t("div",Qt,r(b.$t("labels.json")),1)])])])]),_:1},8,["visible"])}}});const Kt=ke(Ht,[["__scopeId","data-v-9467bd70"]]),Wt=ee(()=>te(()=>import("./CreateBase.89c55300.js"),["./CreateBase.89c55300.js","./_plugin-vue_export-helper.c27b6911.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./Button.ff10bcb0.css","./Icon.vue.6d0583a0.js","./Editor.vue.1fd573b4.js","./deepCompare.d32ec333.js","./workerUtils.81f9c0e3.js","./Modal.vue.b787f37f.js","./DeleteModal.7ab6f524.css","./bases.965a49bb.js","./index.0c5b3837.js","./validation.64563eeb.js","./index.9b87fcff.js","./AirtableImport.vue.87c9d20e.js","./index.886d43e1.js","./FormItem.9f1f85f2.js","./identity.309e9ead.js","./_getPrototype.459a70cf.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./toArray.3561b70e.js","./FormItemContext.b19eb48c.js","./useSize.c98e621d.js","./_flatRest.ce557a88.js","./isPlainObject.631eb8fb.js","./Password.803cc3dc.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./index.26c1c1ff.js","./CheckOutlined.3b90c20d.js","./useRefs.3fea1e39.js","./useState.5a301439.js","./index.e1ceba77.js","./Dropdown.1dedd322.js","./isMobile.e2e89480.js","./index.1431a68b.js","./SearchOutlined.c9794270.js","./TextArea.b81a19ed.js","./index.c968c966.js","./index.d579646c.js","./index.b5e393d6.js","./useMemo.dbc63a5f.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./Modal.vue.3dac5189.js","./views.2c163cf7.js","./useSharedView.9e320acb.js","./tab.e875c8a8.js","./index.208c1883.js","./index.c4d36e30.js","./AirtableImport.f726e727.css","./fileUtils.43128440.js","./index.e7262e5b.js","./RightOutlined.3ce786f5.js","./CreateBase.1d4c2dd3.css"],import.meta.url).then(p=>p.default||p)),qt={class:"nc-all-tables-view"},Ft={class:"flex flex-row gap-x-6 pb-3 pt-6"},Yt={class:"label"},Jt={class:"label"},Xt={class:"label"},Zt={class:"flex flex-row w-full text-gray-400 border-b-1 border-gray-50 py-3 px-2.5"},es={class:"w-2/5"},ts={class:"w-1/5"},ss={class:"w-1/5"},os=["onClick"],as={class:"flex flex-row w-2/5 items-center gap-x-2","data-testid":"proj-view-list__item-title"},ls={class:"w-1/5 text-gray-600","data-testid":"proj-view-list__item-type"},ns={key:0,class:"ml-0.75"},is={key:1,class:"capitalize flex flex-row items-center gap-x-0.5"},rs={class:"w-1/5 text-gray-400 ml-0.25","data-testid":"proj-view-list__item-created-at"},cs=le({__name:"AllTables",setup(p){const{activeTables:S}=q(je()),{openTable:x}=je(),{openedProject:C}=q(Ce()),_=B(!1),I=Q(()=>{var i,s;return Number((s=(i=C.value)==null?void 0:i.sources)==null?void 0:s.length)>1}),{isUIAllowed:m}=Re(),{$e:L}=be(),O=B(!1),D=Q(()=>{var i,s;return(s=(i=C.value)==null?void 0:i.sources)==null?void 0:s[0]}),b=Q(()=>{var s,$;const i=new Map;return($=(s=C.value)==null?void 0:s.sources)==null||$.forEach(y=>{i.set(y.id,y)}),i});function h(i){var v,j,f;L("c:table:create:navdraw");const s=B(!0);let $=(v=C.value.sources)==null?void 0:v[0].id;if(typeof i=="number"&&($=(j=C.value.sources)==null?void 0:j[i].id),!$||!((f=C.value)!=null&&f.id))return;const{close:y}=we(Xe,{modelValue:s,sourceId:$,baseId:C.value.id,onCreate:R,"onUpdate:modelValue":()=>R()});function R(T){s.value=!1,T&&(setTimeout(()=>{const E=document.querySelector(`[data-table-id="${T.id}"]`);E&&(E==null||E.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),y(1e3))}}const u=()=>{I.value||(_.value=!0)};return(i,s)=>{const $=_e,y=Ee,R=Kt,v=Wt,j=Ue("e");return c(),g("div",qt,[t("div",Ft,[e(m)("tableCreate")?(c(),g("div",{key:0,role:"button",class:"nc-base-view-all-table-btn","data-testid":"proj-view-btn__add-new-table",onClick:s[0]||(s[0]=f=>h())},[o($,{icon:"addOutlineBox"}),t("div",Yt,r(i.$t("general.new"))+" "+r(i.$t("objects.table")),1)])):M("",!0),e(m)("tableCreate")?ze((c(),g("div",{key:1,role:"button",class:"nc-base-view-all-table-btn","data-testid":"proj-view-btn__import-data",onClick:s[1]||(s[1]=f=>O.value=!0)},[o($,{icon:"download"}),t("div",Jt,r(i.$t("activity.import"))+" "+r(i.$t("general.data")),1)])),[[j,["c:table:import"]]]):M("",!0),e(m)("sourceCreate")?(c(),U(Oe(e(I)?$e:"div"),{key:2},{title:n(()=>[t("div",null,r(i.$t("tooltip.reachedSourceLimit")),1)]),default:n(()=>[ze((c(),g("div",{role:"button",class:X(["nc-base-view-all-table-btn",{disabled:e(I)}]),"data-testid":"proj-view-btn__create-source",onClick:u},[o($,{icon:"dataSource"}),t("div",Xt,r(i.$t("labels.connectDataSource")),1)],2)),[[j,["c:table:create-source"]]])]),_:1})):M("",!0)]),t("div",Zt,[t("div",es,r(i.$t("objects.table")),1),t("div",ts,r(i.$t("general.source")),1),t("div",ss,r(i.$t("labels.createdOn")),1)]),t("div",{class:"nc-base-view-all-table-list nc-scrollbar-md",style:Me({height:"calc(100vh - var(--topbar-height) - 18rem)"})},[(c(!0),g(ae,null,Te([...e(S)].sort((f,T)=>f.source_id.localeCompare(T.source_id)*20),f=>{var T,E;return c(),g("div",{key:f.id,class:"py-4 flex flex-row w-full cursor-pointer hover:bg-gray-100 border-b-1 border-gray-100 px-2.25","data-testid":"proj-view-list__item",onClick:G=>e(x)(f)},[t("div",as,[o($,{icon:"table",class:"text-gray-700"}),V(" "+r(f==null?void 0:f.title),1)]),t("div",ls,[f.source_id===((T=e(D))==null?void 0:T.id)?(c(),g("div",ns,"-")):(c(),g("div",is,[o(y,{class:"w-4 mr-1"}),V(" "+r((E=e(b).get(f.source_id))==null?void 0:E.alias),1)]))]),t("div",rs,r(e(Ze)(f==null?void 0:f.created_at).fromNow()),1)],8,os)}),128))],4),e(D)?(c(),U(R,{key:0,visible:e(O),"onUpdate:visible":s[2]||(s[2]=f=>H(O)?O.value=f:null),source:e(D)},null,8,["visible","source"])):M("",!0),o(v,{open:e(_),"onUpdate:open":s[3]||(s[3]=f=>H(_)?_.value=f:null)},null,8,["open"])])}}});const ds=ke(cs,[["__scopeId","data-v-d6a32530"]]),us={class:"flex whitespace-nowrap"},Ve=le({__name:"Badge",props:{role:{},clickable:{type:Boolean,default:!1},inherit:{type:Boolean,default:!1},border:{type:Boolean,default:!0},size:{default:"sm"}},setup(p){const S=p,x=oe(S,"role"),C=oe(S,"clickable"),_=oe(S,"border"),I=Q(()=>S.size),m=Q(()=>{const L=x.value,O=et[L],D=tt[L],b=st[L];return{color:O,icon:D,label:b}});return(L,O)=>{const D=_e,b=Ct;return c(),g("div",{class:X(["flex items-start rounded-md",{"cursor-pointer":e(C)}])},[o(b,{class:"!px-2",color:e(m).color,border:e(_),size:e(I)},{default:n(()=>[t("div",{class:X(["badge-text flex items-center gap-2",{"text-purple-700":e(m).color==="purple","text-blue-700":e(m).color==="blue","text-green-700":e(m).color==="green","text-orange-700":e(m).color==="orange","text-yellow-700":e(m).color==="yellow","text-red-700":e(m).color==="red","text-maroon-700":e(m).color==="maroon","text-gray-300":!e(m).color,sizeSelect:e(I)}])},[o(D,{icon:e(m).icon},null,8,["icon"]),t("span",us,r(L.$t(`objects.roleType.${e(m).label}`)),1),e(C)?(c(),U(D,{key:0,icon:"arrowDown"})):M("",!0)],2)]),_:1},8,["color","border","size"])],2)}}}),_s={class:"flex items-center justify-between"},ps={key:0,class:"text-gray-500"},vs=le({__name:"Selector",props:{role:{},roles:{},description:{type:Boolean,default:!0},inherit:{},onRoleChange:{},size:{default:"sm"}},setup(p){const S=p,x=oe(S,"role"),C=oe(S,"inherit"),_=oe(S,"description"),I=B(!1),m=B(null),L=oe(S,"size");ot(m,()=>I.value=!1);function O(D){S.onRoleChange(D),I.value=!1}return(D,b)=>{const h=Ve,u=_e,i=St,s=It,$=Ue("e");return c(),g("div",{ref_key:"dropdownRef",ref:m,size:"lg",class:"nc-roles-selector relative",onClick:b[1]||(b[1]=y=>I.value=!e(I))},[o(h,{"data-testid":"roles",role:e(x),inherit:e(C)===D.role,size:e(L)},null,8,["role","inherit","size"]),o(s,{value:e(x),"onUpdate:value":b[0]||(b[0]=y=>H(x)?x.value=y:null),open:e(I),"dropdown-match-select-width":!1,"dropdown-class-name":"!rounded-lg  !h-fit max-w-64",class:"py-1 !absolute top-0 left-0 w-full h-full z-10 text-xs opacity-0",onChange:O},{default:n(()=>[(c(!0),g(ae,null,Te(S.roles,y=>ze((c(),U(i,{key:y,value:y},{default:n(()=>[t("div",{class:X([{"w-[350px]":e(_),"w-[200px]":!e(_)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",_s,[o(h,{class:X(`nc-role-select-${y}`),role:y,inherit:e(C)===y,border:!1},null,8,["class","role","inherit"]),y===e(x)?(c(),U(u,{key:0,icon:"check",class:"text-primary"})):M("",!0)]),e(_)?(c(),g("div",ps,r(e(at)[y]),1)):M("",!0)],2)]),_:2},1032,["value"])),[[$,["c:workspace:settings:user-role-change"]]])),128))]),_:1},8,["value","open"])],512)}}});const ms=ee(()=>te(()=>import("./UserMenu.af0b921c.js"),["./UserMenu.af0b921c.js","./Icon.vue.6d0583a0.js","./entry.96205fa0.js","./entry.d09b2482.css","./Menu.vue.55c6ca4d.js","./_plugin-vue_export-helper.c27b6911.js","./Menu.eff4a609.css","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./RightOutlined.3ce786f5.js","./UserMenu.d8e809d7.css"],import.meta.url).then(p=>p.default||p)),fs={class:"nc-collaborator-table-container mt-4 nc-access-settings-view h-[calc(100vh-8rem)]"},bs={key:0,class:"nc-collaborators-list items-center justify-center"},ys={class:"w-full flex flex-row justify-between items-baseline mt-6.5 mb-2 pr-0.25"},gs={key:0,class:"nc-collaborators-list items-center justify-center"},hs={key:1,class:"nc-collaborators-list w-full h-full flex flex-col items-center justify-center mt-36"},ws={key:2,class:"nc-collaborators-list mt-6 h-full"},xs={class:"flex flex-col rounded-lg overflow-hidden border-1 max-w-350 max-h-[calc(100%-8rem)]"},$s={class:"flex flex-row bg-gray-50 min-h-12 items-center border-b-1"},ks={class:"text-gray-700 users-email-grid flex items-center space-x-2"},Cs={class:"text-gray-700 user-access-grid flex items-center space-x-2"},Ss={class:"text-gray-700 date-joined-grid"},Is={class:"flex flex-col nc-scrollbar-md"},Ds={class:"flex gap-3 items-center users-email-grid"},zs={class:"truncate"},js={class:"user-access-grid"},Rs={class:"date-joined-grid"},Ts=le({__name:"AccessSettings",setup(p){const S=Ce(),{getBaseUsers:x,createProjectUser:C,updateProjectUser:_,removeProjectUser:I}=S,{activeProjectId:m}=q(S),{orgRoles:L,baseRoles:O}=Re(),{sorts:D,sortDirection:b,loadSorts:h,saveOrUpdate:u,handleGetSortedData:i}=Dt("Project"),s=Q(()=>{var z;return(z=L.value)==null?void 0:z[Se.SUPER_ADMIN]}),$=B([]),y=B(0),R=B(""),v=B(!1),j=B(!1),f=B([]),T=Q(()=>$.value.filter(z=>z.email.toLowerCase().includes(R.value.toLowerCase()))),E=Q(()=>i(T.value,D.value)),G=async()=>{try{const{users:z,totalRows:P}=await x({baseId:m.value,...R.value?{searchText:R.value}:{},force:!0});y.value=P,$.value=[...z.filter(w=>!(w!=null&&w.deleted)).map(w=>{var W;return{...w,base_roles:w.roles,roles:(W=ct(w.main_roles))!=null&&W[Se.SUPER_ADMIN]?Se.SUPER_ADMIN:w.roles??(w.workspace_roles?de[w.workspace_roles]??he.NO_ACCESS:he.NO_ACCESS)}})]}catch(z){J.error(await ue(z))}},pe=async(z,P)=>{const w=$.value.find(W=>W.id===z.id);try{!P||P===he.NO_ACCESS&&!fe||w.workspace_roles&&de[w.workspace_roles]===P&&fe?(await I(m.value,w),w.workspace_roles&&de[w.workspace_roles]===P&&fe?w.roles=de[w.workspace_roles]:w.roles=he.NO_ACCESS):w.base_roles?(w.roles=P,await _(m.value,w)):(w.roles=P,w.base_roles=P,await C(m.value,w))}catch(W){J.error(await ue(W)),G()}};return lt(async()=>{v.value=!0;try{await G();const z=Ie.findIndex(P=>O.value&&Object.keys(O.value).includes(P));s.value?f.value=Ie.slice(1):z!==-1&&(f.value=Ie.slice(z+1)),h()}catch(z){J.error(await ue(z))}finally{v.value=!1}}),(z,P)=>{var l;const w=xt,W=zt,ne=jt,se=nt("Empty"),N=ms,ve=kt,re=vs,ce=Ve,a=$e;return c(),g("div",fs,[e(v)?(c(),g("div",bs,[o(w,{size:"xlarge"})])):(c(),g(ae,{key:1},[t("div",ys,[o(ne,{value:e(R),"onUpdate:value":P[0]||(P[0]=k=>H(R)?R.value=k:null),class:"!max-w-90 !rounded-md",placeholder:z.$t("title.searchMembers")},{prefix:n(()=>[o(W,{class:"!h-3.5 text-gray-500"})]),_:1},8,["value","placeholder"])]),e(j)?(c(),g("div",gs,[o(w,{size:"xlarge"})])):(l=e(T))!=null&&l.length?(c(),g("div",ws,[t("div",xs,[t("div",$s,[t("div",ks,[t("span",null,r(z.$t("objects.users")),1),o(N,{direction:e(b).email,field:"email","handle-user-sort":e(u)},null,8,["direction","handle-user-sort"])]),t("div",Cs,[t("span",null,r(z.$t("general.access")),1),o(N,{direction:e(b).roles,field:"roles","handle-user-sort":e(u)},null,8,["direction","handle-user-sort"])]),t("div",Ss,r(z.$t("title.dateJoined")),1)]),t("div",Is,[(c(!0),g(ae,null,Te(e(E),(k,ye)=>(c(),g("div",{key:ye,class:"user-row flex flex-row border-b-1 py-1 min-h-14 items-center"},[t("div",Ds,[o(ve,{size:"base",email:k.email},null,8,["email"]),t("span",zs,r(k.email),1)]),t("div",js,[e(f).includes(k.roles)?(c(),U(re,{key:0,role:k.roles,roles:e(f),inherit:e(fe)&&k.workspace_roles&&e(de)[k.workspace_roles]?e(de)[k.workspace_roles]:null,description:!1,"on-role-change":ge=>pe(k,ge)},null,8,["role","roles","inherit","on-role-change"])):(c(),U(ce,{key:1,role:k.roles},null,8,["role"]))]),t("div",Rs,[o(a,{class:"max-w-full"},{title:n(()=>[V(r(e(it)(k.created_at)),1)]),default:n(()=>[t("span",null,r(e(rt)(k.created_at)),1)]),_:2},1024)])]))),128))])])])):(c(),g("div",hs,[o(se,{description:"$t('title.noMembersFound')"})]))],64))])}}});const Ms=ke(Ts,[["__scopeId","data-v-7c6ade19"]]),As=ee(()=>te(()=>import("./CreateBase.89c55300.js"),["./CreateBase.89c55300.js","./_plugin-vue_export-helper.c27b6911.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./Button.ff10bcb0.css","./Icon.vue.6d0583a0.js","./Editor.vue.1fd573b4.js","./deepCompare.d32ec333.js","./workerUtils.81f9c0e3.js","./Modal.vue.b787f37f.js","./DeleteModal.7ab6f524.css","./bases.965a49bb.js","./index.0c5b3837.js","./validation.64563eeb.js","./index.9b87fcff.js","./AirtableImport.vue.87c9d20e.js","./index.886d43e1.js","./FormItem.9f1f85f2.js","./identity.309e9ead.js","./_getPrototype.459a70cf.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./toArray.3561b70e.js","./FormItemContext.b19eb48c.js","./useSize.c98e621d.js","./_flatRest.ce557a88.js","./isPlainObject.631eb8fb.js","./Password.803cc3dc.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./index.26c1c1ff.js","./CheckOutlined.3b90c20d.js","./useRefs.3fea1e39.js","./useState.5a301439.js","./index.e1ceba77.js","./Dropdown.1dedd322.js","./isMobile.e2e89480.js","./index.1431a68b.js","./SearchOutlined.c9794270.js","./TextArea.b81a19ed.js","./index.c968c966.js","./index.d579646c.js","./index.b5e393d6.js","./useMemo.dbc63a5f.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./Modal.vue.3dac5189.js","./views.2c163cf7.js","./useSharedView.9e320acb.js","./tab.e875c8a8.js","./index.208c1883.js","./index.c4d36e30.js","./AirtableImport.f726e727.css","./fileUtils.43128440.js","./index.e7262e5b.js","./RightOutlined.3ce786f5.js","./CreateBase.1d4c2dd3.css"],import.meta.url).then(p=>p.default||p)),Bs=ee(()=>te(()=>import("./Erd.78de42c8.js"),["./Erd.78de42c8.js","./View.vue.1d94b013.js","./entry.96205fa0.js","./entry.d09b2482.css","./Overlay.718925e7.js","./_plugin-vue_export-helper.c27b6911.js","./Overlay.09be8605.css","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./FormItemContext.b19eb48c.js","./createForOfIteratorHelper.f2005dfe.js","./bases.965a49bb.js","./index.0c5b3837.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./View.5176b468.css"],import.meta.url).then(p=>p.default||p)),Es=ee(()=>te(()=>import("./Metadata.7b679cc3.js"),["./Metadata.7b679cc3.js","./TableIcon.vue.03001c7d.js","./entry.96205fa0.js","./entry.d09b2482.css","./bases.965a49bb.js","./index.0c5b3837.js","./index.cd5853db.js","./index.aa7d30db.js","./eagerComputed.5bad0f6f.js","./useState.5a301439.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./index.339951af.js","./LeftOutlined.5e2085dd.js","./RightOutlined.3ce786f5.js","./index.b5e393d6.js","./toArray.3561b70e.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./CheckOutlined.3b90c20d.js","./SearchOutlined.c9794270.js","./FormItemContext.b19eb48c.js","./useBreakpoint.2e009418.js","./responsiveObserve.358bcfe9.js","./index.11096307.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./index.10eee714.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js"],import.meta.url).then(p=>p.default||p)),Us=ee(()=>te(()=>import("./UIAcl.9488be75.js"),["./UIAcl.9488be75.js","./Tooltip.vue.00c0d0fb.js","./entry.96205fa0.js","./entry.d09b2482.css","./Tooltip.b86f91a1.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Checkbox.vue.3730d8c8.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./FormItemContext.b19eb48c.js","./createForOfIteratorHelper.f2005dfe.js","./Checkbox.37367331.css","./TableIcon.vue.03001c7d.js","./ViewIcon.vue.fd0fd4d4.js","./iconify.e008aad7.js","./ViewIcon.fd2d300a.css","./index.9b87fcff.js","./bases.965a49bb.js","./index.0c5b3837.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c9794270.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./index.aa7d30db.js","./eagerComputed.5bad0f6f.js","./useState.5a301439.js","./index.339951af.js","./LeftOutlined.5e2085dd.js","./RightOutlined.3ce786f5.js","./index.b5e393d6.js","./toArray.3561b70e.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./CheckOutlined.3b90c20d.js","./useBreakpoint.2e009418.js","./responsiveObserve.358bcfe9.js","./index.11096307.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./index.10eee714.js"],import.meta.url).then(p=>p.default||p)),Os=ee(()=>te(()=>import("./EditBase.df77bb8b.js"),["./EditBase.df77bb8b.js","./Button.vue.02ce6d5b.js","./entry.96205fa0.js","./entry.d09b2482.css","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Icon.vue.6d0583a0.js","./Editor.vue.1fd573b4.js","./deepCompare.d32ec333.js","./workerUtils.81f9c0e3.js","./bases.965a49bb.js","./index.0c5b3837.js","./validation.64563eeb.js","./index.9b87fcff.js","./fileUtils.43128440.js","./index.886d43e1.js","./FormItem.9f1f85f2.js","./identity.309e9ead.js","./_getPrototype.459a70cf.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./toArray.3561b70e.js","./FormItemContext.b19eb48c.js","./useSize.c98e621d.js","./_flatRest.ce557a88.js","./isPlainObject.631eb8fb.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c9794270.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./index.c4d36e30.js","./index.e1ceba77.js","./Dropdown.1dedd322.js","./useState.5a301439.js","./useRefs.3fea1e39.js","./isMobile.e2e89480.js","./index.208c1883.js","./index.e7262e5b.js","./RightOutlined.3ce786f5.js","./index.b5e393d6.js","./useMemo.dbc63a5f.js","./CheckOutlined.3b90c20d.js","./index.d579646c.js","./index.c968c966.js","./EditBase.f72de2f9.css"],import.meta.url).then(p=>p.default||p)),Ps=ee(()=>te(()=>import("./BaseAudit.0eabf065.js"),["./BaseAudit.0eabf065.js","./entry.96205fa0.js","./entry.d09b2482.css","./bases.965a49bb.js","./index.0c5b3837.js","./index.aa7d30db.js","./eagerComputed.5bad0f6f.js","./useState.5a301439.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./index.339951af.js","./LeftOutlined.5e2085dd.js","./RightOutlined.3ce786f5.js","./index.b5e393d6.js","./toArray.3561b70e.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./CheckOutlined.3b90c20d.js","./SearchOutlined.c9794270.js","./FormItemContext.b19eb48c.js","./useBreakpoint.2e009418.js","./responsiveObserve.358bcfe9.js","./index.11096307.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./index.10eee714.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./_plugin-vue_export-helper.c27b6911.js","./BaseAudit.b301ca16.css"],import.meta.url).then(p=>p.default||p)),Ls={class:"flex flex-row w-full h-full nc-data-sources-view"},Ns={class:"flex flex-col w-full overflow-auto"},Vs={class:"flex flex-row w-full justify-end mt-6 mb-5"},Gs={class:"flex flex-row items-center w-full gap-x-1"},Qs={class:"flex"},Hs={class:"ds-table-head"},Ks={class:"ds-table-row"},Ws={class:"ds-table-col ds-table-name"},qs={class:"ds-table-col ds-table-type"},Fs={class:"ds-table-col ds-table-actions -ml-13"},Ys=t("div",{class:"ds-table-col ds-table-crud"},null,-1),Js={class:"ds-table-body"},Xs={key:0,class:"ds-table-row border-gray-200"},Zs={class:"ds-table-col ds-table-enabled"},eo={class:"flex items-center gap-1 cursor-pointer"},to={class:"ds-table-col ds-table-name font-medium"},so={class:"flex items-center gap-1"},oo=t("div",{class:"ds-table-col ds-table-type"},[t("div",{class:"flex items-center gap-1"},"-")],-1),ao={class:"ds-table-col ds-table-actions"},lo={class:"flex items-center gap-2"},no={class:"flex items-center gap-2 text-gray-600"},io={class:"flex items-center gap-2 text-gray-600"},ro={class:"flex items-center gap-2 text-gray-600"},co={class:"flex items-center gap-2 text-gray-600"},uo={class:"ds-table-col ds-table-crud"},_o={key:0,class:"ds-table-row border-gray-200"},po={class:"ds-table-col ds-table-enabled"},vo={class:"flex items-center gap-1 cursor-pointer"},mo={class:"ds-table-col ds-table-name font-medium w-full"},fo={key:1},bo={key:2,class:"truncate"},yo={class:"ds-table-col ds-table-type"},go={class:"flex items-center gap-2"},ho={class:"text-gray-700 capitalize"},wo={class:"ds-table-col ds-table-actions"},xo={class:"flex items-center gap-2"},$o={class:"flex items-center gap-2 text-gray-600"},ko={class:"flex items-center gap-2 text-gray-600"},Co={class:"flex items-center gap-2 text-gray-600"},So={class:"flex items-center gap-2 text-gray-600"},Io={class:"ds-table-col ds-table-crud justify-end gap-x-1"},Do={class:"h-[80vh]"},zo={class:"p-6"},jo={class:"p-6"},Ro={class:"p-6"},To={class:"p-6"},Mo={key:0,class:"flex flex-row items-center py-2 px-3.25 bg-gray-50 rounded-lg text-gray-700 mb-4"},Ao={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Bo=le({__name:"DataSources",props:{state:{},reload:{type:Boolean}},emits:["update:state","update:reload","awaken"],setup(p,{emit:S}){const x=p,C=S,_=De(x,"state",C),I=De(x,"reload",C),{$api:m,$e:L}=be(),{t:O}=dt(),{loadProject:D}=Ce(),b=xe(),{base:h}=q(b),{projectPageTab:u}=q(Ne()),{refreshCommandPalette:i}=ht(),s=B([]),$=B(""),y=B(F.MYSQL),R=B(!1),v=B(!1),j=B(!1),f=B(!1),T=B();async function E(a){try{a&&i(),await _t(()=>!!h.value.id).toBeTruthy(),R.value=!0,I.value=!0;const l=await m.source.list(h.value.id);l.list&&l.list.length&&(s.value=l.list)}catch(l){console.error(l)}finally{I.value=!1,R.value=!1}}const G=(a,l)=>{a&&($.value=a,_.value=l||"")},pe=a=>{L("c:source:delete"),f.value=!0,T.value=a},z=async()=>{if(T.value)try{await m.source.delete(T.value.base_id,T.value.id),L("a:source:delete"),s.value.splice(s.value.indexOf(T.value),1),await D(h.value.id,!0)}catch(a){J.error(await ue(a))}finally{i()}},P=async(a,l)=>{try{if(!l&&s.value.filter(k=>k.enabled).length<2){J.info("There should be at least one enabled source!");return}a.enabled=l,await m.source.update(a.base_id,a.id,{id:a.id,base_id:a.base_id,enabled:a.enabled}),await D(h.value.id,!0)}catch(k){J.error(await ue(k))}finally{i()}},w=async a=>{try{if(a.oldIndex===a.newIndex)return;const l=s.value[a.newIndex];l&&(l.order?await m.source.update(l.base_id,l.id,{id:l.id,base_id:l.base_id,order:a.newIndex+1}):(await m.source.update(l.base_id,l.id,{id:l.id,base_id:l.base_id}),J.info(O("info.basesMigrated")))),await D(h.value.id,!0),await E()}catch(l){J.error(await ue(l))}finally{await i()}},W=()=>{v.value=!v.value,j.value=v.value,C("awaken",v.value)};Z(u,()=>{u.value==="data-source"&&E()},{immediate:!0}),Z(()=>x.reload,async a=>{a&&!R.value&&await E()}),Z(()=>s.value.length,a=>{a>1&&!v.value?(j.value=!1,C("awaken",!1)):(j.value=!0,C("awaken",!0))},{immediate:!0}),Z(_,async a=>{switch(s.value.length||await E(),a){case F.MYSQL:y.value=F.MYSQL,_.value=A.New;break;case F.PG:y.value=F.PG,_.value=A.New;break;case F.SQLITE:y.value=F.SQLITE,_.value=A.New;break;case F.MSSQL:y.value=F.MSSQL,_.value=A.New;break;case F.SNOWFLAKE:y.value=F.SNOWFLAKE,_.value=A.New;break;case A.New:s.value.length>1&&!v.value&&(_.value="");break}i()},{immediate:!0});const ne=Q({get:()=>[A.New].includes(_.value),set:a=>{a||(_.value="")}}),se=Q({get:()=>[A.ERD].includes(_.value),set:a=>{a||(_.value="")}}),N=Q({get:()=>[A.Metadata].includes(_.value),set:a=>{a||(_.value="")}}),ve=Q({get:()=>[A.UIAcl].includes(_.value),set:a=>{a||(_.value="")}}),re=Q({get:()=>[A.Audit].includes(_.value),set:a=>{a||(_.value="")}}),ce=Q({get:()=>[A.Edit].includes(_.value),set:a=>{a||(_.value="")}});return(a,l)=>{const k=$t,ye=Mt,ge=pt,K=_e,Y=$e,Ae=Ee,Ge=As,Qe=Bs,me=Le,He=Es,Ke=Us,We=Os,qe=Ps,Fe=Rt;return c(),g("div",Ls,[t("div",Ns,[t("div",Vs,[e(j)?(c(),U(k,{key:0,size:"large",class:"z-10 !rounded-lg !px-2 mr-2.5",type:"primary",onClick:l[0]||(l[0]=d=>_.value=e(A).New)},{default:n(()=>[t("div",Gs,[(c(),U(Oe(("iconMap"in a?a.iconMap:e(ut)).plus))),t("div",Qs,r(a.$t("activity.newSource")),1)])]),_:1})):M("",!0)]),t("div",{class:"overflow-y-auto nc-scrollbar-md",style:Me({maxHeight:"calc(100vh - 200px)"})},[t("div",Hs,[t("div",Ks,[t("div",{class:"ds-table-col ds-table-enabled cursor-pointer",onDblclick:W},r(a.$t("general.visibility")),33),t("div",Ws,r(a.$t("general.name")),1),t("div",qs,r(a.$t("general.type")),1),t("div",Fs,r(a.$t("labels.actions")),1),Ys])]),t("div",Js,[o(e(Tt),{list:e(s),"item-key":"id",handle:".ds-table-handle",onEnd:w},{header:n(()=>[e(s)[0]?(c(),g("div",Xs,[t("div",Zs,[t("div",eo,[o(ge,null,{title:n(()=>[e(s)[0].enabled?(c(),g(ae,{key:0},[V(r(a.$t("activity.hideInUI")),1)],64)):(c(),g(ae,{key:1},[V(r(a.$t("activity.showInUI")),1)],64))]),default:n(()=>[o(ye,{checked:!!e(s)[0].enabled,size:"default",onChange:l[1]||(l[1]=d=>P(e(s)[0],d))},null,8,["checked"])]),_:1})])]),t("div",to,[t("div",so,r(a.$t("general.default")),1)]),oo,t("div",ao,[t("div",lo,[!e(s)[0].is_meta&&!e(s)[0].is_local?(c(),U(Y,{key:0},{title:n(()=>[V(r(a.$t("tooltip.metaSync")),1)]),default:n(()=>[o(k,{class:"nc-action-btn cursor-pointer outline-0",type:"text","data-testid":"nc-data-sources-view-meta-sync",size:"small",onClick:l[2]||(l[2]=d=>G(e(s)[0].id,e(A).Metadata))},{default:n(()=>[t("div",no,[o(K,{icon:"sync",class:"group-hover:text-accent"})])]),_:1})]),_:1})):M("",!0),o(Y,null,{title:n(()=>[V(r(a.$t("title.relations")),1)]),default:n(()=>[o(k,{size:"small",class:"nc-action-btn cursor-pointer outline-0",type:"text","data-testid":"nc-data-sources-view-erd",onClick:l[3]||(l[3]=d=>G(e(s)[0].id,e(A).ERD))},{default:n(()=>[t("div",io,[o(K,{icon:"erd",class:"group-hover:text-accent"})])]),_:1})]),_:1}),o(Y,null,{title:n(()=>[V(r(a.$t("labels.uiAcl")),1)]),default:n(()=>[o(k,{size:"small",class:"nc-action-btn cursor-pointer outline-0",type:"text","data-testid":"nc-data-sources-view-ui-acl",onClick:l[4]||(l[4]=d=>G(e(s)[0].id,e(A).UIAcl))},{default:n(()=>[t("div",ro,[o(K,{icon:"acl",class:"group-hover:text-accent"})])]),_:1})]),_:1}),o(Y,null,{title:n(()=>[V(r(a.$t("title.audit")),1)]),default:n(()=>[o(k,{size:"small",class:"nc-action-btn cursor-pointer outline-0",type:"text","data-testid":"nc-data-sources-view-audit",onClick:l[5]||(l[5]=d=>G(e(s)[0].id,e(A).Audit))},{default:n(()=>[t("div",co,[o(K,{icon:"book",class:"group-hover:text-accent"})])]),_:1})]),_:1})])]),t("div",uo,[!e(s)[0].is_meta&&!e(s)[0].is_local?(c(),U(k,{key:0,size:"small",class:"nc-action-btn cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:l[6]||(l[6]=d=>G(e(s)[0].id,e(A).Edit))},{default:n(()=>[o(K,{icon:"edit",class:"text-gray-600"})]),_:1})):M("",!0)])])):M("",!0)]),item:n(({element:d,index:Ye})=>[Ye!==0?(c(),g("div",_o,[t("div",po,[t("div",vo,[o(ge,null,{title:n(()=>[d.enabled?(c(),g(ae,{key:0},[V(r(a.$t("activity.hideInUI")),1)],64)):(c(),g(ae,{key:1},[V(r(a.$t("activity.showInUI")),1)],64))]),default:n(()=>[o(ye,{checked:!!d.enabled,onChange:ie=>P(d,ie)},null,8,["checked","onChange"])]),_:2},1024)])]),t("div",mo,[e(s).length>2?(c(),U(K,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):M("",!0),d.is_meta||d.is_local?(c(),g("div",fo,"-")):(c(),g("span",bo,r(d.is_meta||d.is_local?a.$t("general.base"):d.alias),1))]),t("div",yo,[e(s).length>2?(c(),U(K,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):M("",!0),t("div",go,[o(Ae,{"source-type":d.type},null,8,["source-type"]),t("span",ho,r(d.type),1)])]),t("div",wo,[t("div",xo,[o(Y,null,{title:n(()=>[V(r(a.$t("title.relations")),1)]),default:n(()=>[o(k,{size:"small",class:"nc-action-btn cursor-pointer outline-0",type:"text","data-testid":"nc-data-sources-view-erd",onClick:ie=>G(d.id,e(A).ERD)},{default:n(()=>[t("div",$o,[o(K,{icon:"erd",class:"group-hover:text-accent"})])]),_:2},1032,["onClick"])]),_:2},1024),o(Y,null,{title:n(()=>[V(r(a.$t("labels.uiAcl")),1)]),default:n(()=>[o(k,{size:"small",type:"text",class:"nc-action-btn cursor-pointer outline-0","data-testid":"nc-data-sources-view-ui-acl",onClick:ie=>G(d.id,e(A).UIAcl)},{default:n(()=>[t("div",ko,[o(K,{icon:"acl",class:"group-hover:text-accent"})])]),_:2},1032,["onClick"])]),_:2},1024),e(fe)?M("",!0):(c(),U(Y,{key:0},{title:n(()=>[V(r(a.$t("title.audit")),1)]),default:n(()=>[o(k,{size:"small",class:"nc-action-btn cursor-pointer outline-0",type:"text","data-testid":"nc-data-sources-view-audit",onClick:ie=>G(d.id,e(A).Audit)},{default:n(()=>[t("div",Co,[o(K,{icon:"book",class:"group-hover:text-accent"})])]),_:2},1032,["onClick"])]),_:2},1024)),o(Y,null,{title:n(()=>[V(r(a.$t("tooltip.metaSync")),1)]),default:n(()=>[!d.is_meta&&!d.is_local?(c(),U(k,{key:0,size:"small",type:"text","data-testid":"nc-data-sources-view-meta-sync",class:"nc-action-btn cursor-pointer outline-0",onClick:ie=>G(d.id,e(A).Metadata)},{default:n(()=>[t("div",So,[o(K,{icon:"sync",class:"group-hover:text-accent"})])]),_:2},1032,["onClick"])):M("",!0)]),_:2},1024)])]),t("div",Io,[o(Y,null,{title:n(()=>[V(r(a.$t("general.edit")),1)]),default:n(()=>[!d.is_meta&&!d.is_local?(c(),U(k,{key:0,size:"small",class:"nc-action-btn cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:ie=>G(d.id,e(A).Edit)},{default:n(()=>[o(K,{icon:"edit",class:"text-gray-600"})]),_:2},1032,["onClick"])):M("",!0)]),_:2},1024),o(Y,null,{title:n(()=>[V(r(a.$t("general.remove")),1)]),default:n(()=>[!d.is_meta&&!d.is_local?(c(),U(k,{key:0,size:"small",class:"nc-action-btn cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:ie=>pe(d)},{default:n(()=>[o(K,{icon:"delete",class:"text-red-500"})]),_:2},1032,["onClick"])):M("",!0)]),_:2},1024)])])):M("",!0)]),_:1},8,["list"])])],4),o(Ge,{open:e(ne),"onUpdate:open":l[7]||(l[7]=d=>H(ne)?ne.value=d:null),"connection-type":e(y),onSourceCreated:l[8]||(l[8]=d=>E(!0))},null,8,["open","connection-type"]),o(me,{visible:e(se),"onUpdate:visible":l[9]||(l[9]=d=>H(se)?se.value=d:null),size:"large"},{default:n(()=>[t("div",Do,[o(Qe,{"source-id":e($),"show-all-columns":!1},null,8,["source-id"])])]),_:1},8,["visible"]),o(me,{visible:e(N),"onUpdate:visible":l[11]||(l[11]=d=>H(N)?N.value=d:null),size:"medium"},{default:n(()=>[t("div",zo,[o(He,{"source-id":e($),onSourceSynced:l[10]||(l[10]=d=>E(!0))},null,8,["source-id"])])]),_:1},8,["visible"]),o(me,{visible:e(ve),"onUpdate:visible":l[12]||(l[12]=d=>H(ve)?ve.value=d:null),class:"!w-[60rem]"},{default:n(()=>[t("div",jo,[o(Ke,{"source-id":e($)},null,8,["source-id"])])]),_:1},8,["visible"]),o(me,{visible:e(ce),"onUpdate:visible":l[15]||(l[15]=d=>H(ce)?ce.value=d:null),closable:"","mask-closable":!1,size:"medium"},{default:n(()=>[t("div",Ro,[o(We,{"source-id":e($),onSourceUpdated:l[13]||(l[13]=d=>E(!0)),onClose:l[14]||(l[14]=d=>ce.value=!1)},null,8,["source-id"])])]),_:1},8,["visible"]),o(me,{visible:e(re),"onUpdate:visible":l[17]||(l[17]=d=>H(re)?re.value=d:null),class:"!w-[70rem]"},{default:n(()=>[t("div",To,[o(qe,{"source-id":e($),onClose:l[16]||(l[16]=d=>re.value=!1)},null,8,["source-id"])])]),_:1},8,["visible"]),o(Fe,{visible:e(f),"onUpdate:visible":l[18]||(l[18]=d=>H(f)?f.value=d:null),"entity-name":a.$t("general.datasource"),"on-delete":z,"delete-label":a.$t("general.remove")},{"entity-preview":n(()=>[e(T)?(c(),g("div",Mo,[o(Ae,{"source-type":e(T).type},null,8,["source-type"]),t("div",Ao,r(e(T).alias),1)])):M("",!0)]),_:1},8,["visible","entity-name","delete-label"])])])}}});const Eo={class:"nc-icon",stroke:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},Uo=t("path",{d:"M12.6667 2H3.33333C2.59695 2 2 2.59695 2 3.33333V12.6667C2 13.403 2.59695 14 3.33333 14H12.6667C13.403 14 14 13.403 14 12.6667V3.33333C14 2.59695 13.403 2 12.6667 2Z",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Oo=t("path",{d:"M6 14V6",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Po=t("path",{d:"M2 6H14",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),Lo=[Uo,Oo,Po];function No(p,S){return c(),g("svg",Eo,[...Lo])}const Vo={name:"nc-icons-layout",render:No},Go=ee(()=>te(()=>import("./ShareProject.3eb85b5a.js"),["./ShareProject.3eb85b5a.js","./entry.96205fa0.js","./entry.d09b2482.css","./Icon.vue.6d0583a0.js","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./share.e4643132.js","./bases.965a49bb.js","./index.0c5b3837.js"],import.meta.url).then(p=>p.default||p)),Qo={class:"h-full nc-base-view"},Ho={class:"flex flex-row items-center gap-x-3"},Ko={class:"flex flex-row items-center h-full gap-x-2.5"},Wo={class:"truncate"},qo={class:"tab-title","data-testid":"proj-view-tab__all-tables"},Fo={class:"tab-title","data-testid":"proj-view-tab__access-settings"},Yo={class:"tab-title","data-testid":"proj-view-tab__data-sources"},Jo=le({__name:"View",setup(p){const S=Ce(),{openedProject:x,activeProjectId:C,basesUser:_}=q(S),{activeTables:I}=q(je()),{activeWorkspace:m,workspaceUserCount:L}=q(wt()),{navigateToProjectPage:O}=xe(),b=vt().currentRoute,{$e:h}=be(),{isUIAllowed:u}=Re(),{base:i}=q(xe()),{projectPageTab:s}=q(Ne()),{isMobileMode:$}=Pe(),y=B(""),R=Q(()=>{var v;return C.value?(v=_.value.get(C.value))==null?void 0:v.length:0});return Z(()=>{var v;return(v=b.value.query)==null?void 0:v.page},(v,j)=>{if(b.value.name==="index-typeOrId-baseId-index-index"){if(v&&v!==j){v==="collaborator"?s.value="collaborator":v==="data-source"?s.value="data-source":s.value="allTable";return}s.value="allTable"}},{immediate:!0}),Z(s,()=>{h(`a:project:view:tab-change:${s.value}`),s.value&&O({page:s.value})}),Z(()=>{var v;return(v=x.value)==null?void 0:v.title},()=>{var v,j;mt(`${((v=x.value)==null?void 0:v.title)??((j=m.value)==null?void 0:j.title)??"NocoDB"}`)}),(v,j)=>{var se;const f=yt,T=gt,E=$e,G=Go,pe=ds,z=At,P=_e,w=Ms,W=Bo,ne=Bt;return c(),g("div",Qo,[t("div",{class:X(["flex flex-row pl-2 pr-2 gap-1 border-b-1 border-gray-200 justify-between w-full",{"nc-table-toolbar-mobile":e($),"h-[var(--topbar-height)]":!e($)}])},[t("div",Ho,[o(f),t("div",Ko,[o(T,{type:(se=e(x))==null?void 0:se.type},null,8,["type"]),o(E,{class:"flex font-medium text-sm capitalize truncate max-w-150","show-on-truncate-only":""},{title:n(()=>{var N;return[V(r((N=e(x))==null?void 0:N.title),1)]}),default:n(()=>{var N;return[t("span",Wo,r((N=e(x))==null?void 0:N.title),1)]}),_:1})])]),o(G)],2),t("div",{class:"flex mx-12 my-8 nc-base-view-tab",style:Me({height:"calc(100% - var(--topbar-height))"})},[o(ne,{activeKey:e(s),"onUpdate:activeKey":j[1]||(j[1]=N=>H(s)?s.value=N:null),class:"w-full"},{default:n(()=>[o(z,{key:"allTable"},{tab:n(()=>[t("div",qo,[o(e(Vo)),t("div",null,r(v.$t("labels.allTables")),1),t("div",{class:X(["tab-info",{"bg-primary-selected":e(s)==="allTable","bg-gray-50":e(s)!=="allTable"}])},r(e(I).length),3)])]),default:n(()=>[o(pe)]),_:1}),e(u)("newUser")?(c(),U(z,{key:"collaborator"},{tab:n(()=>[t("div",Fo,[o(P,{icon:"users",class:"!h-3.5 !w-3.5"}),t("div",null,r(v.$t("labels.members")),1),e(R)?(c(),g("div",{key:0,class:X(["tab-info",{"bg-primary-selected":e(s)==="collaborator","bg-gray-50":e(s)!=="collaborator"}])},r(e(R)),3)):M("",!0)])]),default:n(()=>[o(w)]),_:1})):M("",!0),e(u)("baseCreate")?(c(),U(z,{key:"data-source"},{tab:n(()=>{var N;return[t("div",Yo,[o(P,{icon:"database"}),t("div",null,r(v.$t("labels.dataSources")),1),(N=e(i).sources)!=null&&N.length?(c(),g("div",{key:0,class:X(["tab-info",{"bg-primary-selected":e(s)==="data-source","bg-gray-50":e(s)!=="data-source"}])},r(e(i).sources.length),3)):M("",!0)])]}),default:n(()=>[o(W,{state:e(y),"onUpdate:state":j[0]||(j[0]=N=>H(y)?y.value=N:null)},null,8,["state"])]),_:1})):M("",!0)]),_:1},8,["activeKey"])],4)])}}});const Xo=ke(Jo,[["__scopeId","data-v-5af25bcc"]]),dl=le({__name:"index",setup(p){const S=xe(),{base:x}=q(S),{isMobileMode:C}=Pe(),{files:_,reset:I}=ft(),{sources:m}=q(S),{$e:L}=be(),O=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","text/csv","application/json","text/json"];Z(_,u=>u&&D(u),{flush:"post"});function D(u){if(!u)return;const i=Array.from(u).map(s=>s);b(i)}function b(u){if(!u)return;if(u.length>1)return J.error({content:"Only one file can be imported at a time.",duration:2});let i=null;const s=O.some($=>{const y=u[0].type===$;if(y){const R=u[0].name.split(".").pop();i=R==="csv"||R==="json"?R:"excel"}return y});if(!s)return J.error({content:"Invalid file type",duration:2});i&&s&&h(i,u[0])}function h(u,i){var v,j,f,T;L(`a:actions:import-${u}`);const s=B(!0),{close:$,vNode:y}=we(Be,{modelValue:s,importType:u,"onUpdate:modelValue":R,sourceId:(v=m.value)==null?void 0:v.filter(E=>E.enabled)[0].id});(T=(f=(j=y.value)==null?void 0:j.component)==null?void 0:f.exposed)==null||T.handleChange({file:{uid:`${u}-${i.name}-${Math.random().toString(36).substring(2)}`,name:i.name,type:i.type,status:"done",fileName:i.name,lastModified:i.lastModified,size:i.size,originFileObj:i},event:{percent:100}});function R(){s.value=!1,$(1e3),I()}}return Z(()=>{var u;return(u=x.value)==null?void 0:u.id},()=>{var u;if((u=x.value)!=null&&u.id&&x.value.type==="database"){const{addTab:i}=Et();i({id:x.value.id,title:x.value.title,type:bt.DB,baseId:x.value.id})}}),(u,i)=>{const s=Xo;return e(C)?M("",!0):(c(),U(s,{key:0}))}}});export{dl as default};
