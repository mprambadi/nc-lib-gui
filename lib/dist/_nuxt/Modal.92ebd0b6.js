import{f as pe,aM as me,r as O,h3 as de,eY as ue,N as _e,a6 as fe,o as n,P as c,w as i,a,O as e,c as v,b as r,d as h,t as s,T as m,W as R,S as x,U as ve,V as he,Q as C,R as S,cb as g,a0 as ge,a1 as ye,H as ke,af as be,ah as we}from"./entry.5958c07b.js";import{_ as xe}from"./Button.vue.c3ca0e8f.js";import{_ as Ce}from"./Overlay.df272e53.js";import{_ as $e}from"./Icon.vue.129448d5.js";import{_ as Fe}from"./DeleteModal.vue.0320a9db.js";import{a as De}from"./useSmartsheetStore.f1a70558.js";import{i as Ve}from"./fileUtils.43128440.js";import{u as Ie}from"./useAttachment.6cac8464.js";import{u as Me,a as Ae,_ as Oe,b as Re,c as Se}from"./index.f7c5322c.js";import{C as Ee}from"./index.5e1434a7.js";import{C as Ue}from"./index.f98c1d80.js";import{_ as je}from"./Image.c63a7a56.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Modal.vue.ee5af191.js";import"./views.4281cbf1.js";import"./bases.e6c8e3c4.js";import"./index.0feaca99.js";import"./useSharedView.e8f68616.js";import"./index.9b87fcff.js";import"./index.e61e381a.js";import"./urlUtils.18c797fa.js";import"./Tooltip.vue.971897f4.js";import"./index.c35df397.js";import"./useSmartsheetRowStore.5b92cc1b.js";import"./deepCompare.d32ec333.js";import"./dataUtils.3f874ca1.js";import"./virtualCell.427fa223.js";import"./index.d36047f6.js";import"./index.ae235b22.js";import"./Input.dca3a2bc.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.ddc65fa5.js";import"./SearchOutlined.a517903c.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./Password.f52125e7.js";import"./index.b06c8b67.js";import"./FormItem.0bbf90a3.js";import"./identity.34c7640e.js";import"./Col.a97e3e76.js";import"./responsiveObserve.0baefba6.js";import"./toArray.fd74ce6f.js";import"./useSize.fad35fe8.js";import"./_flatRest.39582a58.js";import"./sortable.esm.85e2743d.js";import"./Checkbox.2e7b0035.js";import"./createForOfIteratorHelper.33de41ba.js";import"./index.912f77e8.js";import"./Dropdown.041b2468.js";import"./useState.b891c8bb.js";import"./useRefs.40c81887.js";import"./isMobile.e2e89480.js";import"./index.357e1bba.js";import"./Element.a1e4f356.js";const Be=ge(()=>ye(()=>import("./Image.36097f59.js"),["./Image.36097f59.js","./entry.5958c07b.js","./entry.bdecbb78.css"],import.meta.url).then($=>$.default||$)),Ne={class:"flex gap-4"},Le={class:"flex items-center gap-2"},Pe={key:0,class:"text-gray-400"},Te={class:"font-semibold underline"},ze={key:1,class:"flex flex-1 items-center gap-3 justify-end mr-[30px]"},Ze={class:"text-white text-3xl"},Ge={class:"nc-attachment-download group-hover:opacity-100"},He={class:"nc-attachment-download group-hover:opacity-100 mr-[35px]"},Ke=["title"],Qe={key:0,class:"flex flex-col gap-1"},We={class:"nc-attachment h-full w-full flex items-center justify-center"},Ye={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},qe={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},lo=pe({__name:"Modal",setup($){const{isUIAllowed:F}=me(),{open:E,isLoading:T,isPublic:D,isReadonly:_,visibleItems:U,modalVisible:d,column:z,FileIcon:Z,removeFile:G,onDrop:j,downloadFile:H,updateModelValue:K,selectedImage:B,selectedVisibleItems:k,bulkDownloadFiles:Q,renameFile:W}=Me(),V=O(),N=O(),{dragging:I}=Ae(N,U,K,_),{isOverDropZone:b}=de(V,j),{isSharedForm:w}=De(),{getPossibleAttachmentSrc:Y,openAttachment:L}=Ie();ue("Escape",()=>{d.value=!1,b.value=!1});function q(o){B.value=o,d.value=!1;const l=ke(B,M=>{M||(setTimeout(()=>{d.value=!0},50),l==null||l())})}const y=O(!1),f=_e({title:"",i:0});function J(o,l){y.value=!0,f.i=l,f.title=o}fe(V,"paste",o=>{var l;(l=o.clipboardData)!=null&&l.files&&j(o.clipboardData.files)});const X=o=>{G(o),y.value=!1,f.i=0,f.title=""};return(o,l)=>{const M=Oe,ee=xe,te=Re,oe=Ce,le=Ee,A=be,ne=Be,ae=Se,P=Ue,ie=je,se=$e,ce=Fe,re=we;return n(),c(re,{visible:e(d),"onUpdate:visible":l[3]||(l[3]=t=>R(d)?d.value=t:null),class:x(["nc-attachment-modal",{active:e(d)}]),width:"80%",footer:null,"wrap-class-name":"nc-modal-attachment-expand-cell"},{title:i(()=>{var t;return[a("div",Ne,[e(w)||!e(_)&&e(F)("dataEdit")&&!e(D)?(n(),v("div",{key:0,class:"nc-attach-file group","data-testid":"attachment-expand-file-picker-button",onClick:l[0]||(l[0]=(...p)=>e(E)&&e(E)(...p))},[r(M,{class:"transform group-hover:text-accent group-hover:scale-120"}),h(" "+s(o.$t("activity.attachFile")),1)])):m("",!0),a("div",Le,[e(_)?(n(),v("div",Pe,"["+s(o.$t("labels.readOnly"))+"]",1)):m("",!0),h(" "+s(o.$t("labels.viewingAttachmentsOf"))+" ",1),a("div",Te,s((t=e(z))==null?void 0:t.title),1)]),e(k).includes(!0)?(n(),v("div",ze,[r(ee,{type:"primary",class:"nc-attachment-download-all",onClick:e(Q)},{default:i(()=>[h(s(o.$t("activity.bulkDownload")),1)]),_:1},8,["onClick"])])):m("",!0)])]}),default:i(()=>[a("div",{ref_key:"dropZoneRef",ref:V,tabindex:"0"},[e(w)||!e(_)&&!e(I)?(n(),c(oe,{key:0,modelValue:e(b),"onUpdate:modelValue":l[1]||(l[1]=t=>R(b)?b.value=t:null),inline:"",class:"text-white ring ring-accent ring-opacity-100 bg-gray-700/75 flex items-center justify-center gap-2 backdrop-blur-xl"},{default:i(()=>[r(te,{class:"text-accent",height:"35",width:"35"}),a("div",Ze,s(o.$t("labels.dropHere")),1)]),_:1},8,["modelValue"])):m("",!0),a("div",{ref_key:"sortableRef",ref:N,class:x([{dragging:e(I)},"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6 relative p-6"])},[(n(!0),v(ve,null,he(e(U),(t,p)=>(n(),v("div",{key:`${t.title}-${p}`,class:"flex flex-col gap-1"},[r(P,{class:"nc-attachment-item group"},{default:i(()=>[r(le,{checked:e(k)[p],"onUpdate:checked":u=>e(k)[p]=u,class:x(["nc-attachment-checkbox group-hover:opacity-100",{"!opacity-100":e(k)[p]}])},null,8,["checked","onUpdate:checked","class"]),e(_)?m("",!0):(n(),c(A,{key:0},{title:i(()=>[h(s(o.$t("title.removeFile")),1)]),default:i(()=>[e(w)||e(F)("dataEdit")&&!e(D)?(n(),c(C(e(S).closeCircle),{key:0,class:"nc-attachment-remove",onClick:g(u=>J(t.title,p),["stop"])},null,8,["onClick"])):m("",!0)]),_:2},1024)),r(A,{placement:"bottom"},{title:i(()=>[h(s(o.$t("title.downloadFile")),1)]),default:i(()=>[a("div",Ge,[(n(),c(C(e(S).download),{onClick:g(u=>e(H)(t),["stop"])},null,8,["onClick"]))])]),_:2},1024),e(w)||!e(_)&&e(F)("dataEdit")&&!e(D)?(n(),c(A,{key:1,placement:"bottom"},{title:i(()=>[h(s(o.$t("title.renameFile")),1)]),default:i(()=>[a("div",He,[(n(),c(C(e(S).edit),{onClick:g(u=>e(W)(t,p),["stop"])},null,8,["onClick"]))])]),_:2},1024)):m("",!0),a("div",{class:x([[e(I)?"cursor-move":"cursor-pointer"],"nc-attachment h-full w-full flex items-center justify-center overflow-hidden"])},[e(Ve)(t.title,t.mimetype)?(n(),c(ne,{key:0,srcs:e(Y)(t),class:"object-cover h-64 m-auto justify-center",onClick:g(u=>q(t),["stop"])},null,8,["srcs","onClick"])):t.icon?(n(),c(C(e(Z)(t.icon)),{key:1,height:"150",width:"150",onClick:g(u=>e(L)(t),["stop"])},null,8,["onClick"])):(n(),c(ae,{key:2,height:"150",width:"150",onClick:g(u=>e(L)(t),["stop"])},null,8,["onClick"]))],2)]),_:2},1024),a("div",{class:"truncate",title:t.title},s(t.title),9,Ke)]))),128)),e(T)?(n(),v("div",Qe,[r(P,{class:"nc-attachment-item group"},{default:i(()=>[a("div",We,[r(ie,{class:""})])]),_:1})])):m("",!0)],2)],512),r(ce,{visible:e(y),"onUpdate:visible":l[2]||(l[2]=t=>R(y)?y.value=t:null),"entity-name":"File","on-delete":()=>X(e(f).i)},{"entity-preview":i(()=>[a("span",null,[a("div",Ye,[r(se,{icon:"file",class:"nc-view-icon"}),a("div",qe,s(e(f).title),1)])])]),_:1},8,["visible","on-delete"])]),_:1},8,["visible","class"])}}});export{lo as default};
