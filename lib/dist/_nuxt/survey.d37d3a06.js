import{o as a,c as r,a as n,f as Te,fa as Ve,M as Le,r as b,ba as de,g as X,fb as Ce,ad as Q,i as Ee,fc as Re,O as e,t as l,T as m,b as d,w as _,cl as R,a0 as A,fd as Ae,eW as me,P as y,S as h,cG as $,U as fe,V as De,d as S,Q as I,R as N,a1 as D,eX as ze,af as Oe,X as _e}from"./entry.5958c07b.js";import{_ as Pe}from"./Button.vue.c3ca0e8f.js";import{_ as Be}from"./PoweredBy.vue.ecf3f087.js";import{p as Fe}from"./bases.e6c8e3c4.js";import{I as Ie,D as Ne}from"./index.9b87fcff.js";import{i as qe}from"./urlUtils.18c797fa.js";import{u as Me}from"./useSharedFormViewStore.16325514.js";import{v as Ue}from"./validation.2de04583.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./NocoIcon.vue.589d8c3d.js";import"./256x256-trans.69a212f8.js";import"./256x256.a76ef214.js";import"./index.0feaca99.js";import"./index.e61e381a.js";import"./useSmartsheetRowStore.5b92cc1b.js";import"./deepCompare.d32ec333.js";import"./dataUtils.3f874ca1.js";import"./virtualCell.427fa223.js";import"./views.4281cbf1.js";import"./useSharedView.e8f68616.js";const He={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},je=n("path",{fill:"currentColor",d:"m9 18l-6-6l6-6l1.4 1.4L6.8 11H19V7h2v6H6.8l3.6 3.6z"},null,-1),Ge=[je];function Ke(i,q){return a(),r("svg",He,[...Ge])}const Xe={name:"material-symbols-keyboard-return",render:Ke},Qe={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},We=n("path",{fill:"currentColor",d:"M15 18v-6h2.17L12 6.83L6.83 12H9v6zM12 4l10 10h-5v6H7v-6H2z"},null,-1),Ye=[We];function Ze(i,q){return a(),r("svg",Qe,[...Ye])}const Je={name:"mdi-apple-keyboard-shift",render:Ze},et=A(()=>D(()=>import("./VirtualCell.276a28e0.js"),["./VirtualCell.276a28e0.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./EditOrAddProvider.vue.31035ffc.js","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./views.4281cbf1.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./useSharedView.e8f68616.js","./validation.2de04583.js","./index.b06c8b67.js","./FormItem.0bbf90a3.js","./identity.34c7640e.js","./_getPrototype.c1f3bae2.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./toArray.fd74ce6f.js","./FormItemContext.ddc65fa5.js","./useSize.fad35fe8.js","./_flatRest.39582a58.js","./isPlainObject.ccda79fe.js","./vuedraggable.umd.00f5fccc.js","./v3-infinite-loading.660bd977.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.a517903c.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./cell.165313cd.js","./index.5e1434a7.js","./Checkbox.2e7b0035.js","./createForOfIteratorHelper.33de41ba.js","./index.5c6e4286.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./EditOrAddProvider.9247d0ff.css","./virtualCell.427fa223.js","./VirtualCell.ff98befc.css"],import.meta.url).then(i=>i.default||i)),tt=A(()=>D(()=>import("./Cell.0991f33c.js"),["./Cell.0991f33c.js","./entry.5958c07b.js","./entry.bdecbb78.css","./CellIcon.b1340151.js","./index.9b87fcff.js","./cell.165313cd.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./EditOrAddProvider.vue.31035ffc.js","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./views.4281cbf1.js","./useSharedView.e8f68616.js","./validation.2de04583.js","./index.b06c8b67.js","./FormItem.0bbf90a3.js","./identity.34c7640e.js","./_getPrototype.c1f3bae2.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./toArray.fd74ce6f.js","./FormItemContext.ddc65fa5.js","./useSize.fad35fe8.js","./_flatRest.39582a58.js","./isPlainObject.ccda79fe.js","./vuedraggable.umd.00f5fccc.js","./v3-infinite-loading.660bd977.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.a517903c.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./index.5e1434a7.js","./Checkbox.2e7b0035.js","./createForOfIteratorHelper.33de41ba.js","./index.5c6e4286.js","./isMobile.e2e89480.js","./useMemo.1dd071d8.js","./useState.b891c8bb.js","./CheckOutlined.1fe5f230.js","./EditOrAddProvider.9247d0ff.css","./Cell.14116970.css"],import.meta.url).then(i=>i.default||i)),ot=A(()=>D(()=>import("./VirtualCell.3d02a7f6.js"),["./VirtualCell.3d02a7f6.js","./entry.5958c07b.js","./entry.bdecbb78.css","./index.9b87fcff.js","./virtualCell.427fa223.js","./cell.165313cd.js"],import.meta.url).then(i=>i.default||i)),at=A(()=>D(()=>import("./Cell.2a47fcd0.js"),["./Cell.2a47fcd0.js","./entry.5958c07b.js","./entry.bdecbb78.css","./index.9b87fcff.js","./cell.165313cd.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./useSmartsheetRowStore.5b92cc1b.js","./deepCompare.d32ec333.js","./dataUtils.3f874ca1.js","./virtualCell.427fa223.js","./index.e61e381a.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.f27da8af.css"],import.meta.url).then(i=>i.default||i)),st=A(()=>D(()=>import("./DivDataCell.7c09732c.js"),["./DivDataCell.7c09732c.js","./entry.5958c07b.js","./entry.bdecbb78.css","./index.9b87fcff.js","./_plugin-vue_export-helper.c27b6911.js","./DivDataCell.1a716a1e.css"],import.meta.url).then(i=>i.default||i)),rt={key:0,style:{height:"max(40vh, 225px)","min-height":"225px"},class:"max-w-[max(33%,600px)] mx-auto flex flex-col justify-end"},lt={class:"px-4 md:px-0 flex flex-col justify-end"},nt={class:"prose-2xl font-bold self-center my-4","data-testid":"nc-survey-form__heading"},it={key:0,class:"prose-lg text-slate-500 dark:text-slate-300 self-center mb-4 leading-6","data-testid":"nc-survey-form__sub-heading"},ut={class:"h-full w-full flex items-center px-4 md:px-0"},ct={key:0,class:"flex flex-col gap-2"},dt={class:"flex nc-form-column-label","data-testid":"nc-form-column-label"},mt={class:"flex flex-col gap-2 text-slate-500 dark:text-slate-300 text-[0.75rem] my-2 px-1"},ft={key:0,class:"text-sm text-gray-500 flex flex-wrap items-center"},_t={class:"ml-1 mt-4 flex w-full text-lg"},pt={class:"flex-1 flex justify-center"},vt={key:0,class:"text-center my-4"},xt={key:1,class:"flex items-center gap-3 flex-col"},yt={key:0,class:"uppercase text-white"},ht={class:"hidden md:flex text-sm text-gray-500 items-center gap-1"},gt={key:0,class:"flex flex-col justify-center items-center text-center"},bt={class:"text-lg px-6 py-3 bg-green-300 text-gray-700 rounded","data-testid":"nc-survey-form__success-msg"},kt={key:1,class:"flex flex-col gap-1"},wt={key:0,class:"mt-3"},$t={key:0,class:"text-xs text-slate-500 dark:text-slate-300 text-center my-4"},St={key:1,class:"text-center"},Tt={key:1,class:"mb-24 md:my-4 select-none text-center text-gray-500 dark:text-slate-200","data-testid":"nc-survey-form__footer"},Vt={class:"relative flex w-full items-end"},Lt={key:0,class:"color-transition shadow-sm absolute bottom-18 right-1/2 transform translate-x-[50%] md:bottom-4 md:right-12 md:transform-none flex items-center bg-white border dark:bg-slate-500 rounded divide-x-1"},Jt=Te({__name:"survey",setup(i){const{md:q}=Ve(Ae),{v$:f,formState:g,formColumns:T,submitForm:pe,submitted:p,secondsRemain:ve,sharedFormView:v,sharedViewMeta:xe,onReset:ye}=Me(),{t:W}=Le(),M=b(!1),z=b("left"),V=b("arrow-right"),k=b(!1),O=b();de(Ne,O),de(Ie,b(!0));const P=X(()=>xe.value.transitionDuration||50),Y=X(()=>T.value?T.value.reduce((t,s)=>{const c=s.label||s.title;return c&&t.push(c),t},[]):[]),{index:Z,goToPrevious:he,goToNext:ge,isFirst:U,isLast:B,goTo:be}=Ce(Y),o=X(()=>{var t;return(t=T.value)==null?void 0:t[Z.value]}),L=b(!1);function J(t,s=!1){var F;let c=t;return c.uidt===$.LinkToAnotherRecord&&c.colOptions&&c.colOptions.type===ze.BELONGS_TO&&(c=(F=T.value)==null?void 0:F.find(G=>G.id===c.colOptions.fk_child_column_id)),s||c&&c.rqd&&!c.cdf}function H(t){M.value=!0,z.value=t,setTimeout(()=>{z.value=z.value==="left"?"right":"left"},P.value/2),setTimeout(()=>{M.value=!1,setTimeout(oe,100)},P.value)}function ee(t){V.value=t,k.value=!0,setTimeout(()=>{k.value=!1},P.value/2)}async function te(){var s;const t=o.value;if((s=Fe(t.meta))!=null&&s.validate&&g.value[t.title]){if(t.uidt===$.Email){if(!Ue(g.value[t.title]))return L.value=!0,_e.error(W("msg.error.invalidEmail")),!1}else if(t.uidt===$.URL&&!qe(g.value[t.title]))return L.value=!0,_e.error(W("msg.error.invalidURL")),!1}return!0}async function C(t){if(L.value=!1,B.value||p.value||!o.value||!o.value.title)return;const s=f.value.localState[o.value.title];s&&!await s.$validate()||await te()&&(ee(t||"arrow-right"),setTimeout(()=>{H("left"),ge()},t==="ok-button"?300:0))}async function j(t){U.value||p.value||(ee(t||"arrow-left"),H("right"),he())}function oe(){if(document&&typeof document<"u"){const t=document.querySelector(".nc-cell input")||document.querySelector(".nc-cell textarea");t&&(t.select(),t.focus())}}function ae(){f.value.$reset(),p.value=!1,H("right"),be(Y.value[0])}async function se(){p.value||!await te()||pe()}return ye(ae),Q(["ArrowLeft","ArrowDown"],()=>{j("arrow-left")}),Q(["ArrowRight","ArrowUp"],()=>{C("arrow-right")}),Q(["Enter","Space"],()=>{B.value?se():C("ok-button")}),Ee(()=>{if(oe(),!q.value){const{direction:t}=Re(O,{onSwipe:()=>{M.value||(t.value==="left"?C():t.value==="right"&&j())}})}}),(t,s)=>{var ne,ie;const c=et,F=tt,G=ot,ke=at,we=Je,re=Xe,$e=st,le=Pe,K=Oe,Se=Be;return a(),r("div",{ref_key:"el",ref:O,class:"survey pt-8 md:p-0 w-full h-full flex flex-col"},[e(v)?(a(),r("div",rt,[n("div",lt,[n("h1",nt,l(e(v).heading),1),e(v).subheading&&e(v).subheading!==""?(a(),r("h2",it,l((ne=e(v))==null?void 0:ne.subheading),1)):m("",!0)])])):m("",!0),n("div",ut,[d(R,{name:`slide-${e(z)}`,duration:e(P),mode:"out-in"},{default:_(()=>{var E,w;return[(a(),r("div",{ref_key:"el",ref:O,key:(E=e(o))==null?void 0:E.title,class:"color-transition h-full flex flex-col mt-6 gap-4 w-full max-w-[max(33%,600px)] m-auto"},[e(o)&&!e(p)?(a(),r("div",ct,[n("div",dt,[e(me)(e(o))?(a(),y(c,{key:0,column:{...e(o),title:e(o).label||e(o).title},required:J(e(o),e(o).required),"hide-menu":!0},null,8,["column","required"])):(a(),y(F,{key:1,class:h(e(o).uidt===e($).Checkbox?"nc-form-column-label__checkbox":""),column:{meta:{},...e(o),title:e(o).label||e(o).title},required:J(e(o),e(o).required),"hide-menu":!0},null,8,["class","column","required"]))]),e(o).title?(a(),y($e,{key:0,class:"relative"},{default:_(()=>{var x;return[e(me)(e(o))?(a(),y(G,{key:0,modelValue:e(g)[e(o).title],"onUpdate:modelValue":s[0]||(s[0]=u=>e(g)[e(o).title]=u),class:"mt-0 nc-input h-auto",row:{row:{},oldRow:{},rowMeta:{}},"data-testid":`nc-survey-form__input-${e(o).title.replaceAll(" ","")}`,column:e(o)},null,8,["modelValue","data-testid","column"])):(a(),y(ke,{key:1,modelValue:e(g)[e(o).title],"onUpdate:modelValue":s[1]||(s[1]=u=>e(g)[e(o).title]=u),class:"nc-input h-auto","data-testid":`nc-survey-form__input-${e(o).title.replaceAll(" ","")}`,column:e(o),"edit-enabled":""},null,8,["modelValue","data-testid","column"])),n("div",mt,[(a(!0),r(fe,null,De((x=e(f).localState[e(o).title])==null?void 0:x.$errors,u=>(a(),r("div",{key:u,class:"text-red-500"},l(u.$message),1))),128)),n("div",{class:h(["block text-[14px]",e(o).uidt===e($).Checkbox?"text-center":""]),"data-testid":"nc-survey-form__field-description"},l(e(o).description),3),e(o).uidt===e($).LongText?(a(),r("div",ft,[S(l(t.$t("general.shift"))+" ",1),d(we,{class:"mx-1 text-primary"}),S(" + "+l(t.$t("general.enter"))+" ",1),d(re,{class:"mx-1 text-primary"}),S(" "+l(t.$t("msg.makeLineBreak")),1)])):m("",!0)])]}),_:1})):m("",!0)])):m("",!0),n("div",_t,[n("div",pt,[e(B)&&!e(p)&&!e(f).$invalid?(a(),r("div",vt,[n("button",{class:h([e(V)==="submit-button"&&e(k)?"transform translate-y-[1px] translate-x-[1px] ring ring-accent ring-opacity-100":"","uppercase scaling-btn prose-sm"]),type:"submit","data-testid":"nc-survey-form__btn-submit",onClick:se},l(t.$t("general.submit")),3)])):e(p)?m("",!0):(a(),r("div",xt,[d(K,{title:(w=e(f).localState[e(o).title])!=null&&w.$error?e(f).localState[e(o).title].$errors[0].$message:t.$t("msg.info.goToNext"),"mouse-enter-delay":.25,"mouse-leave-delay":0},{default:_(()=>{var x;return[d(le,{"data-testid":"nc-survey-form__btn-next",class:h([(x=e(f).localState[e(o).title])!=null&&x.$error||e(L)?"after:!bg-gray-100 after:!ring-red-500":"",e(V)==="ok-button"&&e(k)?"transform translate-y-[2px] translate-x-[2px] !after:ring !after:ring-accent !after:ring-opacity-100":""]),onClick:s[2]||(s[2]=u=>C())},{default:_(()=>[d(R,{name:"fade"},{default:_(()=>{var u;return[(u=e(f).localState[e(o).title])!=null&&u.$error?m("",!0):(a(),r("span",yt,l(t.$t("general.ok")),1))]}),_:1}),d(R,{name:"slide-right",mode:"out-in"},{default:_(()=>{var u;return[(u=e(f).localState[e(o).title])!=null&&u.$error||e(L)?(a(),y(I(e(N).closeCircle),{key:0,class:"text-red-500 md:text-md"})):(a(),y(I(e(N).check),{key:1,class:"text-white md:text-md"}))]}),_:1})]),_:1},8,["class"])]}),_:1},8,["title"]),n("div",ht,[S(l(t.$t("labels.pressEnter"))+" ",1),d(re,{class:"text-primary"})])]))])]),d(R,{name:"slide-left"},{default:_(()=>{var x,u,ue,ce;return[e(p)?(a(),r("div",gt,[n("div",bt,[(x=e(v))!=null&&x.success_msg?(a(),r(fe,{key:0},[S(l((u=e(v))==null?void 0:u.success_msg),1)],64)):(a(),r("div",kt,[n("div",null,l(t.$t("msg.info.thankYou")),1),n("div",null,l(t.$t("msg.info.submittedFormData")),1)]))]),e(v)?(a(),r("div",wt,[(ue=e(v))!=null&&ue.show_blank_form?(a(),r("p",$t,l(t.$t("labels.newFormLoaded"))+" "+l(e(ve))+" "+l(t.$t("general.seconds")),1)):m("",!0),(ce=e(v))!=null&&ce.submit_another_form?(a(),r("div",St,[d(le,{type:"primary","data-testid":"nc-survey-form__btn-submit-another-form",onClick:ae},{default:_(()=>[S(l(t.$t("activity.submitAnotherForm")),1)]),_:1})])):m("",!0)])):m("",!0)])):m("",!0)]}),_:1})]))]}),_:1},8,["name","duration"])]),e(p)?m("",!0):(a(),r("div",Tt,l(e(Z)+1)+" / "+l((ie=e(T))==null?void 0:ie.length),1)),n("div",Vt,[d(R,{name:"fade"},{default:_(()=>{var E;return[e(p)?m("",!0):(a(),r("div",Lt,[d(K,{title:e(U)?"":t.$t("msg.info.goToPrevious"),"mouse-enter-delay":.25,"mouse-leave-delay":0},{default:_(()=>[n("button",{class:h([e(V)==="arrow-left"&&e(k)?"transform translate-y-[1px] translate-x-[1px] text-primary":"","p-0.5 flex items-center group color-transition"]),"data-testid":"nc-survey-form__icon-prev",onClick:s[3]||(s[3]=w=>j())},[(a(),y(I(e(N).chevronLeft),{class:h([e(U)?"text-gray-300":"group-hover:text-accent","text-2xl md:text-md"])},null,8,["class"]))],2)]),_:1},8,["title"]),d(K,{title:(E=e(f).localState[e(o).title])!=null&&E.$error?"":t.$t("msg.info.goToNext"),"mouse-enter-delay":.25,"mouse-leave-delay":0},{default:_(()=>{var w;return[n("button",{class:h([e(V)==="arrow-right"&&e(k)?"transform translate-y-[1px] translate-x-[-1px] text-primary":"","p-0.5 flex items-center group color-transition"]),"data-testid":"nc-survey-form__icon-next",onClick:s[4]||(s[4]=x=>C())},[(a(),y(I(e(N).chevronRight),{class:h([[e(B)||(w=e(f).localState[e(o).title])!=null&&w.$error?"text-gray-300":"group-hover:text-accent"],"text-2xl md:text-md"])},null,8,["class"]))],2)]}),_:1},8,["title"])]))]}),_:1}),d(Se)])],512)}}});export{Jt as default};
