import{u as L}from"./views.4281cbf1.js";import{bG as A,bF as k,r as d,fh as I,g as s,O as G,H as N,C as K,eN as i}from"./entry.5958c07b.js";import{a as U}from"./bases.e6c8e3c4.js";import{u as C}from"./index.e61e381a.js";function D(){const o={field:"",query:""},t=A("field-query-search-map",()=>({})),l=A("field-query-search",()=>({...o}));return{search:l,loadFieldQuery:u=>{u&&(u in t.value||(t.value[u]={...o}),l.value=t.value[u])}}}const[X,H]=C((o,t,l=!1,f,u)=>{var w;const{$api:O}=K(),{activeView:a,activeNestedFilters:P,activeSorts:$}=k(L()),g=U(),{sqlUis:y}=k(g),h=d((w=t.value)!=null&&w.source_id?y.value[t.value.source_id]:Object.values(y.value)[0]),{search:n}=D(),x=I(Symbol("SmartsheetStore")),B=s(()=>{var e;return((e=a.value)==null?void 0:e.lock_type)==="locked"}),M=s(()=>{var e,r;return(r=(e=t.value)==null?void 0:e.columns)==null?void 0:r.some(c=>c.pk)}),Q=s(()=>{var e;return((e=a.value)==null?void 0:e.type)===i.GRID}),S=s(()=>{var e;return((e=a.value)==null?void 0:e.type)===i.FORM}),R=s(()=>{var e;return((e=a.value)==null?void 0:e.type)===i.GALLERY}),T=s(()=>{var e;return((e=a.value)==null?void 0:e.type)===i.KANBAN}),V=s(()=>{var e;return((e=a.value)==null?void 0:e.type)===i.MAP}),_=s(()=>S.value&&l),j=s(()=>{var c,b,q,F;let e;const r=((b=(c=t.value)==null?void 0:c.columns)==null?void 0:b.find(({id:m})=>m===n.value.field))||((F=(q=t.value)==null?void 0:q.columns)==null?void 0:F.find(m=>m.pv));if(r&&n.value.query.trim())return["text","string"].includes(h.value.getAbstractType(r))&&r.dt!=="bigint"?e=`(${r.title},like,%${n.value.query.trim()}%)`:e=`(${r.title},eq,${n.value.query.trim()})`,e}),E=s(()=>{var e;return((e=t.value)==null?void 0:e.type)==="view"}),v=d(G(f)??[]),p=d(G(u)??[]);return N(v,()=>{$.value=v.value},{immediate:!0}),N(p,()=>{P.value=p.value},{immediate:!0}),{view:a,meta:t,isLocked:B,$api:O,xWhere:j,isPkAvail:M,isForm:S,isGrid:Q,isGallery:R,isKanban:T,isMap:V,isSharedForm:_,sorts:v,nestedFilters:p,isSqlView:E,eventBus:x,sqlUi:h}},"smartsheet-store");function Z(){const o=H();if(!o)throw new Error("Please call `useProvideSmartsheetStore` on the appropriate parent component");return o}export{Z as a,D as b,X as u};
