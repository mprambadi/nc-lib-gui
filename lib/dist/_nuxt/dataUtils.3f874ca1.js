import{cZ as y,eW as O,eZ as R,cG as r,eX as j,f9 as C}from"./entry.5958c07b.js";const T=(i,e)=>!i||!e?null:e.filter(n=>n.pk).map(n=>i==null?void 0:i[n.title]).join("___"),b=(i,e)=>{const n={},t=e==null?void 0:e.filter(s=>s.pk);if(i&&t&&t.length)for(const s of t)s.title&&(n[s.title]=i[s.title]);return n},h=(i,e)=>{for(const[n,t]of Object.entries(e))if(Object.keys(i).every(s=>i[s]===t.row[s]))return parseInt(n);return-1};async function L({getMeta:i,row:e,meta:n,ltarState:t,throwError:s,undo:k=!1}){var p;const u=new Set,_=await((p=n.columns)==null?void 0:p.reduce(async(m,a)=>{const d=await m;if(t&&a.uidt===r.LinkToAnotherRecord&&a.colOptions.type===j.BELONGS_TO&&t[a.title]){const f=a.colOptions,l=n.columns.find(o=>f.fk_child_column_id===o.id),c=await i(f.fk_related_model_id);c&&l&&(d[l.title]=t[a.title][c.columns.find(o=>o.id===f.fk_parent_column_id).title],u.delete(l.title))}return C(a,e)&&u.add(a.title),(!a.ai||k)&&(e==null?void 0:e[a.title])!==null&&(d[a.title]=e==null?void 0:e[a.title]),d},Promise.resolve({})));if(s&&u.size)throw new Error(`Missing required columns: ${[...u].join(", ")}`);return{missingRequiredColumns:u,insertObj:_}}const g=(i=[])=>i.reduce((n,t)=>{if(!y(t)&&!O(t)&&!R({uidt:t.uidt})&&![r.Rollup,r.Lookup,r.Formula,r.Barcode,r.QrCode].includes(t.uidt)&&(t!=null&&t.cdf)){const s=t.cdf;n[t.title]=typeof s=="string"?s.replace(/^'/,"").replace(/'$/,""):s}return n},{});export{g as a,T as e,h as f,L as p,b as r};
