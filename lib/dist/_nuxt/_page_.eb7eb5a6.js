import{_ as ee}from"./Button.vue.c3ca0e8f.js";import{_ as ye}from"./Tooltip.vue.971897f4.js";import{_ as ge}from"./TruncateText.vue.104d33b8.js";import{_ as he}from"./Icon.vue.129448d5.js";import{_ as ke}from"./DeleteModal.vue.0320a9db.js";import{f as W,L as be,M as te,r as _,N as Z,g as oe,o as l,c as k,a as o,t as s,b as i,w as r,d as h,O as t,P as x,Q as V,R,S as we,T as U,_ as J,U as xe,V as $e,W as Q,X as A,Y as j,C as Te,Z as Ce,$ as ae,H as Me,a0 as Ne,a1 as Se,q as Ee,a2 as B}from"./entry.5958c07b.js";import{i as K}from"./index.025c8e21.js";import{u as Ae}from"./useCopy.0241e728.js";import"./index.ae235b22.js";import{I as se}from"./Input.dca3a2bc.js";import{_ as De}from"./index.023e2de7.js";import{_ as Ue}from"./UserIcon.74e37fbe.js";import{u as Ie}from"./users.a4c19485.js";import{_ as Le}from"./FormItem.0bbf90a3.js";import{F as Pe}from"./index.b06c8b67.js";import{_ as ze}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./Modal.vue.ee5af191.js";import"./SearchOutlined.a517903c.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.ddc65fa5.js";import"./Password.f52125e7.js";import"./LeftOutlined.1d2f193f.js";import"./RightOutlined.7161c742.js";import"./index.5c6e4286.js";import"./toArray.fd74ce6f.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";import"./useBreakpoint.cbf2ba72.js";import"./responsiveObserve.0baefba6.js";import"./bases.e6c8e3c4.js";import"./index.0feaca99.js";import"./identity.34c7640e.js";import"./Col.a97e3e76.js";import"./useSize.fad35fe8.js";import"./_flatRest.39582a58.js";const Ve={class:"h-full pt-2"},Re={class:"max-w-202 mx-auto px-4 h-full","data-testid":"nc-token-list"},je={class:"py-2 flex gap-4 items-baseline justify-between"},Be={class:"text-2xl text-left font-bold","data-rec":"true"},Ge={class:"hidden md:block","data-rec":"true"},Oe={class:"flex items-center justify-center md:hidden","data-rec":"true"},qe={"data-rec":"true"},Fe={class:"mt-5 h-[calc(100%-13rem)]"},He={class:"h-full w-full !overflow-hidden rounded-md"},Qe={class:"flex w-full pl-5 bg-gray-50 border-1 rounded-t-md"},We={class:"py-3.5 text-gray-500 font-medium text-3.5 w-2/9","data-rec":"true"},Xe={class:"py-3.5 text-gray-500 font-medium text-3.5 w-2/9 text-start","data-rec":"true"},Ye={class:"py-3.5 text-gray-500 font-medium text-3.5 w-3/9 text-start","data-rec":"true"},Ze={class:"py-3.5 pl-19 text-gray-500 font-medium text-3.5 w-2/9 text-start","data-rec":"true"},Je={class:"nc-scrollbar-md !overflow-y-auto flex flex-col h-[calc(100%-5rem)]"},Ke={key:0},et={class:"flex w-full"},tt={key:0,class:"text-red-500 text-xs font-light mt-1.5 ml-1","data-rec":"true"},ot={class:"flex gap-2 justify-start"},at={key:1,class:"border-l-1 border-r-1 border-b-1 rounded-b-md justify-center flex items-center"},st={class:"text-black font-bold text-3.5 text-start w-2/9"},nt={class:"text-gray-500 font-medium text-3.5 text-start w-2/9"},lt={class:"text-gray-500 font-medium text-3.5 text-start w-3/9"},it={key:1},rt={class:"flex justify-end items-center gap-3 pr-5 text-gray-500 font-medium text-3.5 w-2/9"},ct={key:0,class:"flex items-center justify-center mt-5"},dt={class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700 mb-4"},pt={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},ut=W({__name:"Token",setup(S){const{api:u,isLoading:c}=be(),{$e:T}=Te(),{copy:C}=Ae(),{t:m}=te(),y=_([]),f=_([]),b=Z({isShow:!1,id:""}),v=_(1),w=_(!1),I=_(10),n=m("labels.token"),d=_({description:n}),G=_(""),$=Z({total:0,pageSize:10}),L=()=>{d.value.description=Ce([...f.value.map(e=>(e==null?void 0:e.description)||"")],n)},O=e=>{b.isShow&&b.id===e?(b.isShow=!1,b.id=""):(b.isShow=!0,b.id=e)},q=async(e=$.total)=>{try{const a=await u.orgTokens.list({query:{limit:e}});if(!a)return;f.value=a.list,L()}catch(a){A.error(await j(a))}},D=(e,a)=>{switch(e){case"add":{f.value=[...f.value,a];break}case"delete":{f.value=[...f.value.filter(g=>g.token!==a.token)];break}}L()},M=async(e=v.value,a=I.value)=>{v.value=e;try{const g=await u.orgTokens.list({query:{limit:a,offset:G.value.length===0?(e-1)*a:0}});if(!g)return;$.total=g.pageInfo.totalRows??0,$.pageSize=10,y.value=g.list,f.value.length||await q($.total)}catch(g){A.error(await j(g))}};M();const N=_(!1),E=_(""),F=_(""),P=_(!1),ne=async e=>{try{await u.orgTokens.delete(e),await M(),D("delete",{token:e}),!y.value.length&&v.value!==1&&(v.value--,M(v.value))}catch(a){A.error(await j(a))}T("a:account:token:delete"),N.value=!1,F.value="",E.value=""},le=e=>e?e.length<255:!1,X=async()=>{if(P.value=le(d.value.description),!!P.value)try{const e=await u.orgTokens.create(d.value);w.value=!1,d.value={},await M(),D("add",e)}catch(e){A.error(await j(e))}finally{T("a:api-token:generate")}},ie=async e=>{if(e)try{await C(e),A.info(m("msg.info.copiedToClipboard")),T("c:api-token:copy")}catch(a){A.error(a.message)}},re=(e,a)=>{F.value=e,E.value=a,N.value=!0},ce=e=>d.value.description===n&&(e==null?void 0:e.select()),de=oe(()=>{var a;const e=(a=d.value.description)==null?void 0:a.length;if(e){if(e>255)return m("msg.info.tokenNameMaxLength")}else return m("msg.info.tokenNameNotEmpty")}),pe=()=>{w.value=!1,P.value=!1};return(e,a)=>{const g=ee,z=ye,ue=se,me=J,H=ge,_e=De,fe=he,ve=ke;return l(),k("div",Ve,[o("div",Re,[o("div",je,[o("h6",Be,s(e.$t("title.apiTokens")),1),i(z,{disabled:!(t(K)&&t(y).length)},{title:r(()=>[h(s(e.$t("labels.tokenLimit")),1)]),default:r(()=>[i(g,{disabled:t(w)||t(K)&&t(y).length,class:"!rounded-md","data-testid":"nc-token-create",size:"middle",type:"primary",tooltip:"bottom",onClick:a[0]||(a[0]=p=>w.value=!0)},{default:r(()=>[o("span",Ge,s(e.$t("title.addNewToken")),1),o("span",Oe,[(l(),x(V(("iconMap"in e?e.iconMap:t(R)).plus)))])]),_:1},8,["disabled"])]),_:1},8,["disabled"])]),o("span",qe,s(e.$t("msg.apiTokenCreate")),1),o("div",Fe,[o("div",He,[o("div",Qe,[o("span",We,s(e.$t("title.tokenName")),1),o("span",Xe,s(e.$t("title.creator")),1),o("span",Ye,s(e.$t("labels.token")),1),o("span",Ze,s(e.$t("labels.actions")),1)]),o("div",Je,[t(w)?(l(),k("div",Ke,[o("div",{class:we(["flex gap-5 px-3 py-2.5 text-gray-500 font-medium text-3.5 w-full nc-token-generate border-b-1 border-l-1 border-r-1",{"rounded-b-md":!t(y).length}])},[o("div",et,[i(ue,{ref:ce,value:t(d).description,"onUpdate:value":a[1]||(a[1]=p=>t(d).description=p),"default-value":t(n),type:"text",class:"!rounded-lg !py-1",placeholder:"Token Name","data-testid":"nc-token-input",onPressEnter:X},null,8,["value","default-value"]),t(P)?U("",!0):(l(),k("span",tt,s(t(de)),1))]),o("div",ot,[t(c)?U("",!0):(l(),x(g,{key:0,type:"secondary",size:"small",onClick:pe},{default:r(()=>[h(s(e.$t("general.cancel")),1)]),_:1})),i(g,{type:"primary",size:"sm","is-loading":t(c),"data-testid":"nc-token-save-btn",onClick:X},{default:r(()=>[h(s(e.$t("general.save")),1)]),_:1},8,["is-loading"])])],2)])):U("",!0),!t(y).length&&!t(w)?(l(),k("div",at,[i(me,{image:("Empty"in e?e.Empty:t(J)).PRESENTED_IMAGE_SIMPLE,description:e.$t("labels.noToken")},null,8,["image","description"])])):U("",!0),(l(!0),k(xe,null,$e(t(y),p=>(l(),k("div",{key:p.id,"data-testid":"nc-token-list",class:"flex pl-5 py-3 justify-between token items-center border-l-1 border-r-1 border-b-1"},[o("span",st,[i(H,{placement:"top",length:"20"},{default:r(()=>[h(s(p.description),1)]),_:2},1024)]),o("span",nt,[i(H,{placement:"top",length:"20"},{default:r(()=>[h(s(p.created_by),1)]),_:2},1024)]),o("span",lt,[p.token===t(b).id&&t(b).isShow?(l(),x(H,{key:0,placement:"top",length:"29"},{default:r(()=>[h(s(p.token),1)]),_:2},1024)):(l(),k("span",it,"************************************"))]),o("div",rt,[i(z,{placement:"top"},{title:r(()=>[h(s(e.$t("labels.showOrHide")),1)]),default:r(()=>[(l(),x(V(("iconMap"in e?e.iconMap:t(R)).eye),{class:"nc-toggle-token-visibility hover::cursor-pointer w-h-4 mb-[1.8px]",onClick:Y=>O(p.token)},null,8,["onClick"]))]),_:2},1024),i(z,{placement:"top",class:"h-4"},{title:r(()=>[h(s(e.$t("general.copy")),1)]),default:r(()=>[(l(),x(V(("iconMap"in e?e.iconMap:t(R)).copy),{class:"hover::cursor-pointer w-4 h-4 text-gray-600 mt-0.25",onClick:Y=>ie(p.token)},null,8,["onClick"]))]),_:2},1024),i(z,{placement:"top",class:"mb-0.5"},{title:r(()=>[h(s(e.$t("general.delete")),1)]),default:r(()=>[(l(),x(V(("iconMap"in e?e.iconMap:t(R)).delete),{"data-testid":"nc-token-row-action-icon",class:"nc-delete-icon hover::cursor-pointer w-4 h-4",onClick:Y=>re(p.token,p.description)},null,8,["onClick"]))]),_:2},1024)])]))),128))])])]),t($).total>10?(l(),k("div",ct,[i(_e,{current:t(v),"onUpdate:current":a[2]||(a[2]=p=>Q(v)?v.value=p:null),total:t($).total,"show-less-items":"",onChange:a[3]||(a[3]=p=>M(t(v),t(I)))},null,8,["current","total"])])):U("",!0)]),i(ve,{visible:t(N),"onUpdate:visible":a[4]||(a[4]=p=>Q(N)?N.value=p:null),"entity-name":e.$t("labels.token"),"on-delete":()=>ne(t(F))},{"entity-preview":r(()=>[o("span",null,[o("div",dt,[i(fe,{icon:"key",class:"nc-view-icon"}),o("div",pt,s(t(E)),1)])])]),_:1},8,["visible","entity-name","on-delete"])])}}});const mt={class:"flex flex-col items-center"},_t={class:"flex flex-col w-150"},ft={class:"flex font-bold text-xl","data-rec":"true"},vt={class:"mt-5 flex flex-col border-1 rounded-2xl border-gray-200 p-6 gap-y-2"},yt={class:"flex font-medium text-base","data-rec":"true"},gt={class:"flex text-gray-500","data-rec":"true"},ht={class:"flex flex-row mt-4"},kt={class:"flex h-20 mt-1.5"},bt=o("div",{class:"flex w-10"},null,-1),wt={class:"text-gray-800 mb-1.5","data-rec":"true"},xt={class:"text-gray-800 mb-1.5","data-rec":"true"},$t={class:"flex flex-row w-full justify-end mt-8","data-rec":"true"},Tt=W({__name:"Profile",setup(S){const{user:u}=ae(),{t:c}=te(),T=_(!1),C=_(!1),m=_({title:"",email:""}),{updateUserProfile:y}=Ie(),f=_(),b={title:[{required:!0,message:c("msg.error.nameRequired")},{min:2,message:c("msg.error.nameMinLength")},{max:60,message:c("msg.error.nameMaxLength")}]},v=async()=>{if(await f.value.validate()&&!C.value){C.value=!0,T.value=!1;try{await y({attrs:{display_name:m.value.title}})}catch(d){console.error(d)}finally{C.value=!1}}},w=oe(()=>{var n;return(n=u.value)==null?void 0:n.email});Me(()=>{var n;return(n=u.value)==null?void 0:n.display_name},()=>{var n;(n=u.value)!=null&&n.display_name&&(m.value.title=u.value.display_name,m.value.email=u.value.email)},{immediate:!0});const I=async(n,d)=>{T.value=!d};return(n,d)=>{var D,M;const G=Ue,$=se,L=Le,O=ee,q=Pe;return l(),k("div",mt,[o("div",_t,[o("div",ft,s(n.$t("labels.profile")),1),o("div",vt,[o("div",yt,s(n.$t("labels.accountDetails")),1),o("div",gt,s(n.$t("labels.controlAppearance")),1),o("div",ht,[o("div",kt,[i(G,{size:"xlarge",email:(D=t(u))==null?void 0:D.email,name:(M=t(u))==null?void 0:M.display_name},null,8,["email","name"])]),bt,i(q,{ref_key:"formValidator",ref:f,layout:"vertical","no-style":"",model:t(m),class:"flex flex-col w-full",onFinish:v,onValidate:I},{default:r(()=>{var N;return[o("div",wt,s(n.$t("general.name")),1),i(L,{name:"title",rules:b.title},{default:r(()=>[i($,{value:t(m).title,"onUpdate:value":d[0]||(d[0]=E=>t(m).title=E),class:"w-full !rounded-md !py-1.5",placeholder:n.$t("general.name"),"data-testid":"nc-account-settings-rename-input"},null,8,["value","placeholder"])]),_:1},8,["rules"]),o("div",xt,s(n.$t("labels.accountEmailID")),1),i($,{value:t(w),"onUpdate:value":d[1]||(d[1]=E=>Q(w)?w.value=E:null),class:"w-full !rounded-md !py-1.5",placeholder:n.$t("general.email"),disabled:"","data-testid":"nc-account-settings-email-input"},null,8,["value","placeholder"]),o("div",$t,[i(O,{type:"primary","html-type":"submit",disabled:t(T)||t(m).title&&t(m).title===((N=t(u))==null?void 0:N.display_name),loading:t(C),"data-testid":"nc-account-settings-save",onClick:v},{loading:r(()=>[h(s(n.$t("general.saving")),1)]),default:r(()=>[h(" "+s(n.$t("general.save")),1)]),_:1},8,["disabled","loading"])])]}),_:1},8,["model"])])])])])}}}),Ct=Ne(()=>Se(()=>import("./AppStore.1b3331e8.js"),["./AppStore.1b3331e8.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./round-edit.55a44805.js","./Title.f2b907cf.js","./TextArea.9074ff05.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./FormItemContext.ddc65fa5.js","./CheckOutlined.1fe5f230.js","./useState.b891c8bb.js","./index.f98c1d80.js","./index.912f77e8.js","./Dropdown.041b2468.js","./useRefs.40c81887.js","./identity.34c7640e.js","./_flatRest.39582a58.js","./isMobile.e2e89480.js","./index.357e1bba.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./AppStore.28cbd850.css"],import.meta.url).then(S=>S.default||S)),Mt={},Nt={class:"h-full overflow-y-scroll scrollbar-thin-dull pt-2 px-5"},St={class:"text-xl mt-4 mb-8 text-left font-weight-bold"};function Et(S,u){const c=Ct;return l(),k("div",Nt,[o("div",St,s(S.$t("title.appStore")),1),o("div",null,[i(c)])])}const At=ze(Mt,[["render",Et]]),Dt={key:4},$o=W({__name:"[page]",setup(S){const{appInfo:u}=ae();return(c,T)=>{const C=Ee("AccountUserManagement"),m=ut,y=Tt,f=At;return(c._.provides[B]||c.$route).params.page==="users"?(l(),x(C,{key:0})):(c._.provides[B]||c.$route).params.page==="tokens"?(l(),x(m,{key:1})):(c._.provides[B]||c.$route).params.page==="profile"?(l(),x(y,{key:2})):(c._.provides[B]||c.$route).params.page==="apps"&&!t(u).isCloud?(l(),x(f,{key:3})):(l(),k("span",Dt))}}});export{$o as default};
