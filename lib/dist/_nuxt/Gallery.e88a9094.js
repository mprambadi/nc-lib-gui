import{f as Le,bb as v,r as m,bA as ze,bF as Pe,ba as k,c8 as je,u as Te,g,aM as Fe,a7 as Oe,H as Ue,eN as Me,c9 as $e,o as l,c as i,b as w,w as d,O as e,P as u,au as Ne,d as qe,t as Be,T as I,a as _,S as Ge,U as h,V as L,dy as He,eW as M,W as z,d4 as ae,fZ as ne,a0 as p,a1 as f,ce as We,cf as Je,p as Xe,e as Ye}from"./entry.96205fa0.js";import{u as Ze}from"./views.2c163cf7.js";import{a as Ke}from"./useSmartsheetStore.7d51347e.js";import{M as Qe,A as et,h as tt,R as ot,O as at,c as nt,y as lt,q as st,z as rt,F as it,B as ut}from"./index.9b87fcff.js";import{e as mt}from"./dataUtils.fb0a3616.js";import{i as dt}from"./fileUtils.43128440.js";import{A as _t}from"./cell.810c4fd3.js";import{u as ct}from"./useAttachment.30d26f9a.js";import{u as pt}from"./useViewData.a43f0e8e.js";import{_ as ft}from"./chevron-right.53a6784f.js";import{_ as yt,a as wt}from"./FileIconImageBox.73052e22.js";import{_ as vt}from"./index.c969316f.js";import{C as gt}from"./index.c4d36e30.js";import{D as ht}from"./index.6c1d17b6.js";import{_ as xt}from"./Input.553ad305.js";import{_ as bt}from"./_plugin-vue_export-helper.c27b6911.js";import"./bases.965a49bb.js";import"./index.0c5b3837.js";import"./useSharedView.9e320acb.js";import"./index.e034edbd.js";import"./urlUtils.15d0b9ce.js";import"./virtualCell.9142cfee.js";import"./axios.9cbf0d09.js";import"./debounce.1d5af9bf.js";import"./toNumber.ed208f2f.js";import"./isSymbol.d46b4957.js";import"./index.e1ceba77.js";import"./Dropdown.1dedd322.js";import"./useState.5a301439.js";import"./useRefs.3fea1e39.js";import"./identity.309e9ead.js";import"./_flatRest.ce557a88.js";import"./isMobile.e2e89480.js";import"./index.208c1883.js";import"./Col.b3c5d725.js";import"./responsiveObserve.358bcfe9.js";import"./isPlainObject.631eb8fb.js";import"./_getPrototype.459a70cf.js";import"./RightOutlined.3ce786f5.js";import"./Element.a2c5baa8.js";const Vt=p(()=>f(()=>import("./Image.f89e3816.js"),["./Image.f89e3816.js","./entry.96205fa0.js","./entry.d09b2482.css"],import.meta.url).then(n=>n.default||n)),kt=p(()=>f(()=>import("./VirtualCell.e690dced.js"),["./VirtualCell.e690dced.js","./entry.96205fa0.js","./entry.d09b2482.css","./index.9b87fcff.js","./virtualCell.9142cfee.js","./cell.810c4fd3.js"],import.meta.url).then(n=>n.default||n)),It=p(()=>f(()=>import("./Cell.a619fa9b.js"),["./Cell.a619fa9b.js","./entry.96205fa0.js","./entry.d09b2482.css","./index.9b87fcff.js","./cell.810c4fd3.js","./bases.965a49bb.js","./index.0c5b3837.js","./useSmartsheetRowStore.9c7d6fc1.js","./deepCompare.d32ec333.js","./dataUtils.fb0a3616.js","./virtualCell.9142cfee.js","./index.e034edbd.js","./_plugin-vue_export-helper.c27b6911.js","./Cell.f27da8af.css"],import.meta.url).then(n=>n.default||n)),Rt=p(()=>f(()=>import("./VirtualCell.8c6452ad.js"),["./VirtualCell.8c6452ad.js","./entry.96205fa0.js","./entry.d09b2482.css","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./EditOrAddProvider.vue.8b187915.js","./Icon.vue.6d0583a0.js","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./views.2c163cf7.js","./bases.965a49bb.js","./index.0c5b3837.js","./useSharedView.9e320acb.js","./validation.64563eeb.js","./index.886d43e1.js","./FormItem.9f1f85f2.js","./identity.309e9ead.js","./_getPrototype.459a70cf.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./toArray.3561b70e.js","./FormItemContext.b19eb48c.js","./useSize.c98e621d.js","./_flatRest.ce557a88.js","./isPlainObject.631eb8fb.js","./vuedraggable.umd.5a03c14e.js","./v3-infinite-loading.e5e5dc2d.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./RightOutlined.3ce786f5.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c9794270.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./cell.810c4fd3.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./index.b5e393d6.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./useState.5a301439.js","./CheckOutlined.3b90c20d.js","./EditOrAddProvider.9247d0ff.css","./virtualCell.9142cfee.js","./VirtualCell.ff98befc.css"],import.meta.url).then(n=>n.default||n)),Dt=p(()=>f(()=>import("./Cell.378562a9.js"),["./Cell.378562a9.js","./entry.96205fa0.js","./entry.d09b2482.css","./CellIcon.0a028b40.js","./index.9b87fcff.js","./cell.810c4fd3.js","./bases.965a49bb.js","./index.0c5b3837.js","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./EditOrAddProvider.vue.8b187915.js","./Icon.vue.6d0583a0.js","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./views.2c163cf7.js","./useSharedView.9e320acb.js","./validation.64563eeb.js","./index.886d43e1.js","./FormItem.9f1f85f2.js","./identity.309e9ead.js","./_getPrototype.459a70cf.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./toArray.3561b70e.js","./FormItemContext.b19eb48c.js","./useSize.c98e621d.js","./_flatRest.ce557a88.js","./isPlainObject.631eb8fb.js","./vuedraggable.umd.5a03c14e.js","./v3-infinite-loading.e5e5dc2d.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./RightOutlined.3ce786f5.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./SearchOutlined.c9794270.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./index.0b4c0f1e.js","./Checkbox.cf2cdba0.js","./createForOfIteratorHelper.f2005dfe.js","./index.b5e393d6.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./useState.5a301439.js","./CheckOutlined.3b90c20d.js","./EditOrAddProvider.9247d0ff.css","./Cell.14116970.css"],import.meta.url).then(n=>n.default||n)),Ct=p(()=>f(()=>import("./Row.f8fe4e9b.js"),["./Row.f8fe4e9b.js","./index.9b87fcff.js","./useSmartsheetRowStore.9c7d6fc1.js","./entry.96205fa0.js","./entry.d09b2482.css","./deepCompare.d32ec333.js","./dataUtils.fb0a3616.js","./virtualCell.9142cfee.js","./bases.965a49bb.js","./index.0c5b3837.js","./index.e034edbd.js","./useSmartsheetStore.7d51347e.js","./views.2c163cf7.js","./useSharedView.9e320acb.js"],import.meta.url).then(n=>n.default||n)),Et=p(()=>f(()=>import("./Pagination.8a429e38.js"),["./Pagination.8a429e38.js","./Pagination.2fe08f8a.js","./Icon.vue.6d0583a0.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./index.b5e393d6.js","./toArray.3561b70e.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./useState.5a301439.js","./CheckOutlined.3b90c20d.js","./SearchOutlined.c9794270.js","./FormItemContext.b19eb48c.js","./Pagination.fabf8b70.css","./views.2c163cf7.js","./bases.965a49bb.js","./index.0c5b3837.js","./useSharedView.9e320acb.js","./index.9b87fcff.js","./sidebar.30294def.js","./index.5b05c4cf.js","./axios.9cbf0d09.js","./index.7e75edca.js","./Element.a2c5baa8.js","./Input.553ad305.js","./Image.d07b34cf.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./Pagination.9422c247.css"],import.meta.url).then(n=>n.default||n)),At=p(()=>f(()=>import("./index.3faef5cb.js").then(n=>n.i),["./index.3faef5cb.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Icon.vue.6d0583a0.js","./Menu.vue.55c6ca4d.js","./Menu.eff4a609.css","./Divider.82129fc6.js","./index.c968c966.js","./Divider.3e739d27.css","./Dropdown.vue.93f98e1e.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./RightOutlined.3ce786f5.js","./DivDataCell.7110991f.js","./index.9b87fcff.js","./DivDataCell.1a716a1e.css","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./UserIcon.7f59375b.js","./UserIcon.fda3e825.css","./config.bc9920dc.js","./sidebar.30294def.js","./bases.965a49bb.js","./index.0c5b3837.js","./views.2c163cf7.js","./useSharedView.9e320acb.js","./dataUtils.fb0a3616.js","./index.e034edbd.js","./useKanbanViewStore.4bcd49a7.js","./deepCompare.d32ec333.js","./useSmartsheetStore.7d51347e.js","./useSmartsheetRowStore.9c7d6fc1.js","./virtualCell.9142cfee.js","./iconify.e008aad7.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./FormItemContext.b19eb48c.js","./SearchOutlined.c9794270.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./Modal.vue.3dac5189.js","./DeleteModal.7ab6f524.css","./DeleteModal.vue.49c1a59b.js","./Modal.vue.b787f37f.js","./useDashboard.0f55d174.js","./index.a5de28c1.js","./Input.553ad305.js","./Element.a2c5baa8.js","./index.35cd520e.css"],import.meta.url).then(n=>n.default||n)),le=n=>(Xe("data-v-c9f5949b"),n=n(),Ye(),n),St={class:"nc-base-menu-item"},Lt={key:0,class:"flex flex-col h-full"},zt={class:"flex flex-row p-3 !pr-1 gap-x-2 flex-wrap gap-y-2"},Pt={key:1,class:"nc-gallery-container grid gap-3 my-4 px-3"},jt=le(()=>_("a",null,[_("div",{class:"pt-[12px]"},[_("div")])],-1)),Tt={class:"z-10 arrow"},Ft={class:"z-10 arrow"},Ot={key:1,class:"h-52 w-full !flex flex-row !border-b-1 !border-gray-200 items-center justify-center"},Ut=le(()=>_("img",{class:"object-contain w-[48px] h-[48px]",src:wt},null,-1)),Mt=[Ut],$t={key:0,class:"text-base mt-3 mx-3 font-bold"},Nt={class:"flex flex-col first:mt-3 ml-2 !pr-3.5 !mb-[0.75rem] rounded-lg w-full"},qt={class:"flex flex-row w-full justify-start scale-75"},Bt={class:"w-full pb-1 text-gray-300"},Gt={key:0,class:"flex flex-row w-full text-gray-700 px-1 mt-[-0.25rem] items-center justify-start"},Ht={key:1,class:"flex flex-row w-full h-[1.375rem] pl-1 items-center justify-start"},Wt=Le({__name:"Gallery",setup(n){const y=v(Qe,m()),R=v(et,m()),P=v(tt),D=v(ot),j=v(at,ze()),{isViewDataLoading:C}=Pe(Ze()),{isSqlView:$,xWhere:se}=Ke(),x=m(!1),T=m(),N=m(),{loadData:q,paginationData:F,formattedData:re,loadGalleryData:B,galleryData:G,changePage:ie,addEmptyRow:ue,deleteRow:me,navigateToSiblingRow:H}=pt(y,R,se);k(nt,m(!1)),k(lt,m(!0)),k(st,m(!1)),k(rt,m(1));const W=v(it,m([])),E=je(),J=Te(),{getPossibleAttachmentSrc:de}=ct(),_e=g(()=>W.value.filter(a=>!_t(a))),c=g(()=>{var a,t;return((t=(a=y.value)==null?void 0:a.columns)==null?void 0:t.find(r=>r.pv&&W.value.includes(r)))??null}),b=g(()=>{var a,t;return(a=y.value)!=null&&a.columnsById?y.value.columnsById[(t=G.value)==null?void 0:t.fk_cover_image_col_id]:{}}),ce=(a,t)=>{const r=a.row[t.title];return r?Array.isArray(r)&&r.length===0:!0},{isUIAllowed:pe}=Fe(),fe=g(()=>pe("dataEdit")),X=m(!1),A=g({get:()=>X.value,set:a=>{fe.value&&(X.value=a)}}),O=m(null),ye=(a,t)=>{$.value||(a.preventDefault(),t&&(O.value=t))},Y=a=>{var t;try{return(t=b.value)!=null&&t.title&&a.row[b.value.title]?typeof a.row[b.value.title]=="string"?JSON.parse(a.row[b.value.title]):a.row[b.value.title]:[]}catch{return[]}},Z=(a,t)=>{const r=mt(a.row,y.value.columns);r?J.push({query:{...E.query,rowId:r}}):(T.value=a,N.value=t,x.value=!0)},K=async(a,t)=>{const r=a.target;r.closest(".arrow")||r.closest(".slick-dots")||Z(t)};j==null||j.on(async()=>{const a=await ue();Z(a)});const S=g({get(){return!!E.query.rowId},set(a){a||J.push({query:{...E.query,rowId:void 0}})}}),U=m(!1);return P==null||P.on(async()=>{await B(),U.value=!0,Oe(()=>{U.value=!1})}),D==null||D.on(async()=>{await q()}),k(ut,D),Ue(R,async a=>{C.value=!0;try{(a==null?void 0:a.type)===Me.GALLERY&&(await q(),await B())}finally{C.value=!1}},{immediate:!0}),(a,t)=>{const r=We,we=Je,ve=xt,ge=yt,he=ft,xe=Vt,be=vt,Q=kt,ee=It,Ve=Rt,ke=Dt,Ie=gt,Re=Ct,De=ht,Ce=Et,te=At,Ee=$e("e");return l(),i(h,null,[w(De,{visible:e(A),"onUpdate:visible":t[2]||(t[2]=o=>z(A)?A.value=o:null),trigger:e($)?[]:["contextmenu"],"overlay-class-name":"nc-dropdown-grid-context-menu"},{overlay:d(()=>[w(we,{class:"shadow !rounded !py-0",onClick:t[1]||(t[1]=o=>A.value=!1)},{default:d(()=>[e(O)?(l(),u(r,{key:0,onClick:t[0]||(t[0]=o=>e(me)(e(O).row))},{default:d(()=>[Ne((l(),i("div",St,[qe(Be(a.$t("activity.deleteRow")),1)])),[[Ee,["a:row:delete"]]])]),_:1})):I("",!0)]),_:1})]),default:d(()=>[_("div",{class:Ge(["flex flex-col w-full nc-gallery nc-scrollbar-md bg-[#fbfbfb]",{"!overflow-hidden":e(C)}]),"data-testid":"nc-gallery-wrapper",style:{height:"calc(100% - var(--topbar-height) + 0.7rem)"}},[e(C)?(l(),i("div",Lt,[_("div",zt,[(l(!0),i(h,null,L(Array(20),o=>(l(),u(ve,{key:o,class:"!min-w-60.5 !h-96 !rounded-md overflow-hidden"}))),128))])])):(l(),i("div",Pt,[(l(!0),i(h,null,L(e(re),(o,Ae)=>(l(),i("div",{key:`record-${o.row.id}`},[w(Re,{row:o},{default:d(()=>{var oe;return[w(Ie,{class:"!rounded-lg h-full border-gray-200 border-1 group overflow-hidden break-all max-w-[450px] shadow-sm hover:shadow-md cursor-pointer","body-style":{padding:"0px"},"data-testid":`nc-gallery-card-${o.row.id}`,onClick:s=>K(s,o),onContextmenu:s=>ye(s,{row:Ae})},He({default:d(()=>[e(c)?(l(),i("h2",$t,[e(M)(e(c))?(l(),u(Q,{key:0,modelValue:o.row[e(c).title],"onUpdate:modelValue":s=>o.row[e(c).title]=s,class:"!text-brand-500",column:e(c),row:o},null,8,["modelValue","onUpdate:modelValue","column","row"])):(l(),u(ee,{key:1,modelValue:o.row[e(c).title],"onUpdate:modelValue":s=>o.row[e(c).title]=s,class:"!text-brand-500",column:e(c),"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"]))])):I("",!0),(l(!0),i(h,null,L(e(_e),s=>(l(),i("div",{key:`record-${o.row.id}-${s.id}`},[_("div",Nt,[_("div",qt,[_("div",Bt,[e(M)(s)?(l(),u(Ve,{key:0,column:s,"hide-menu":!0,"hide-icon":!0},null,8,["column"])):(l(),u(ke,{key:1,column:s,"hide-menu":!0,"hide-icon":!0},null,8,["column"]))])]),ce(o,s)?(l(),i("div",Ht,"-")):(l(),i("div",Gt,[e(M)(s)?(l(),u(Q,{key:0,modelValue:o.row[s.title],"onUpdate:modelValue":V=>o.row[s.title]=V,column:s,row:o},null,8,["modelValue","onUpdate:modelValue","column","row"])):(l(),u(ee,{key:1,modelValue:o.row[s.title],"onUpdate:modelValue":V=>o.row[s.title]=V,column:s,"edit-enabled":!1,"read-only":!0},null,8,["modelValue","onUpdate:modelValue","column"]))]))])]))),128))]),_:2},[(oe=e(G))!=null&&oe.fk_cover_image_col_id?{name:"cover",fn:d(()=>[!e(U)&&Y(o).length?(l(),u(be,{key:0,class:"gallery-carousel !border-b-1 !border-gray-200",arrows:""},{customPaging:d(()=>[jt]),prevArrow:d(()=>[_("div",Tt,[w(ge,{class:"text-gray-700 w-6 h-6 absolute left-1.5 bottom-[-90px] !opacity-0 !group-hover:opacity-100 !bg-white border-1 border-gray-200 rounded-md transition"})])]),nextArrow:d(()=>[_("div",Ft,[w(he,{class:"text-gray-700 w-6 h-6 absolute right-1.5 bottom-[-90px] !opacity-0 !group-hover:opacity-100 !bg-white border-1 border-gray-200 rounded-md transition"})])]),default:d(()=>[(l(!0),i(h,null,L(Y(o),(s,V)=>(l(),i(h,null,[e(dt)(s.title,s.mimetype??s.type)?(l(),u(xe,{key:`carousel-${o.row.id}-${V}`,class:"h-52 object-cover",srcs:e(de)(s),onClick:Se=>K(Se,o)},null,8,["srcs","onClick"])):I("",!0)],64))),256))]),_:2},1024)):(l(),i("div",Ot,Mt))]),key:"0"}:void 0]),1032,["data-testid","onClick","onContextmenu"])]}),_:2},1032,["row"])]))),128))]))],2)]),_:1},8,["visible","trigger"]),w(Ce,{"pagination-data":e(F),"onUpdate:paginationData":t[3]||(t[3]=o=>z(F)?F.value=o:null),"show-api-timing":"","change-page":e(ie)},null,8,["pagination-data","change-page"]),(l(),u(ae,null,{default:d(()=>[e(T)&&e(x)?(l(),u(te,{key:0,modelValue:e(x),"onUpdate:modelValue":t[4]||(t[4]=o=>z(x)?x.value=o:null),row:e(T),state:e(N),meta:e(y),view:e(R)},null,8,["modelValue","row","state","meta","view"])):I("",!0)]),_:1})),(l(),u(ae,null,{default:d(()=>[e(S)?(l(),u(te,{key:0,modelValue:e(S),"onUpdate:modelValue":t[5]||(t[5]=o=>z(S)?S.value=o:null),row:{row:{},oldRow:{},rowMeta:{}},meta:e(y),"row-id":e(E).query.rowId,view:e(R),"show-next-prev-icons":"",onNext:t[6]||(t[6]=o=>e(H)(e(ne).NEXT)),onPrev:t[7]||(t[7]=o=>e(H)(e(ne).PREV))},null,8,["modelValue","meta","row-id","view"])):I("",!0)]),_:1}))],64)}}});const jo=bt(Wt,[["__scopeId","data-v-c9f5949b"]]);export{jo as default};
