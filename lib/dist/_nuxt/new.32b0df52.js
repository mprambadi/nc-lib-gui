import{_ as le}from"./nuxt-link.39d6b1ec.js";import{_ as M}from"./Icon.vue.129448d5.js";import{aL as de,r as T,L as ue,$ as W,H as X,fF as pe,f as $,aF as C,o as s,c as g,a as o,S as P,O as e,a9 as L,t as E,cy as me,T as A,b as u,w as l,P as v,cb as j,ce as Y,cf as Z,p as U,e as H,u as fe,d as x,D as ee,g as D,fG as a,q,bF as ve,U as B,V as he,i as Ee,c8 as ye,M as ge,bH as xe,c9 as be,a7 as we,a2 as $e,au as Q,fH as Ie,fI as Ae}from"./entry.5958c07b.js";import{D as J}from"./index.dc13a4d6.js";import{_ as N}from"./_plugin-vue_export-helper.c27b6911.js";import{_ as ke}from"./ProjectIcon.07026955.js";import{K as Te}from"./v3-infinite-loading.660bd977.js";import{S as Ce}from"./index.55641318.js";import{_ as Re}from"./index.07078df6.js";import{u as We}from"./share.ce661e57.js";import{e as De}from"./bases.e6c8e3c4.js";import{_ as Se}from"./nocodb-full.f8fd3499.js";import{_ as Le,b as Pe,L as Ne}from"./index.99a44a23.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./index.0feaca99.js";import"./LeftOutlined.1d2f193f.js";const V=de("notificationStore",()=>{const n=T([]),i=T(!1),t=T(),r=T(0),d=T(!1),{api:c,isLoading:_}=ue(),{appInfo:h,token:m}=W();let f;const I=y=>{const w=new URL(h.value.ncSiteUrl,window.location.href.split(/[?#]/)[0]).href;f=pe(`${w}${w.endsWith("/")?"":"/"}notifications`,{extraHeaders:{"xc-auth":y}}),f.on("notification",O=>{n.value=[O,...n.value],t.value.totalRows+=1,r.value+=1,i.value=!1}),f.emit("subscribe",{})};X(()=>m.value,(y,w)=>{y&&y!==w?I(y):y||f==null||f.disconnect()},{immediate:!0});const b=async(y=!1)=>{const w=await c.notification.list({is_read:d.value,limit:10,offset:y?n.value.length:0});y?n.value=[...n.value,...w.list]:n.value=w.list,t.value=w.pageInfo,r.value=w.unreadCount};return{notifications:n,loadNotifications:b,isLoading:_,isRead:d,pageInfo:t,markAsRead:async y=>{y.is_read||(await c.notification.update(y.id,{is_read:!0}),y.is_read=!0)},markAllAsRead:async y=>{y.is_read||(await c.notification.markAllAsRead(),await b())},unreadCount:r,isOpened:i,markAsOpened:async()=>{i.value=!0}}}),te=n=>(U("data-v-bdd62e39"),n=n(),H(),n),Ve={class:"nc-avatar-wrapper"},Oe=te(()=>o("div",{class:"nc-notification-avatar"},null,-1)),Be={class:"flex-grow ml-3"},je={class:"flex items-center"},Me=te(()=>o("div",{class:"p-2 text-xs"},"Mark as read",-1)),Ue=$({__name:"Wrapper",props:{item:{}},setup(n){const t=C(n,"item"),r=V(),{markAsRead:d}=r;return(c,_)=>{const h=M,m=Y,f=Z,I=J;return s(),g("div",{class:P(["flex items-center gap-1 cursor-pointer nc-notification-item-wrapper",{active:!e(t).is_read}])},[o("div",{class:P(["nc-notification-dot",{active:!e(t).is_read}])},null,2),o("div",Ve,[L(c.$slots,"avatar",{},()=>[Oe],!0)]),o("div",Be,[o("div",je,[L(c.$slots,"default",{},void 0,!0)]),e(t)?(s(),g("div",{key:0,class:P(["text-xs text-gray-500 mt-1",{"text-primary":!e(t).is_read}])},E(e(me)(e(t).created_at)),3)):A("",!0)]),o("div",{onClick:_[1]||(_[1]=j(()=>{},["stop"]))},[u(I,null,{overlay:l(()=>[u(f,null,{default:l(()=>[u(m,{onClick:_[0]||(_[0]=b=>e(d)(e(t)))},{default:l(()=>[Me]),_:1})]),_:1})]),default:l(()=>[e(t).is_read?A("",!0):(s(),v(h,{key:0,icon:"threeDotVertical",class:"nc-notification-menu-icon"}))]),_:1})])],2)}}});const S=N(Ue,[["__scopeId","data-v-bdd62e39"]]),He=""+new URL("64x64.a9fe41ab.png",import.meta.url).href,Je=o("img",{src:He,class:"w-6"},null,-1),Ge=o("div",{class:"text-xs"},[x("Welcome to "),o("strong",null,"NocoHUB!"),x(" We’re excited to have you onboard.")],-1),Ke=$({__name:"Welcome",props:{item:{}},setup(n){const i=n,r=fe().currentRoute,d=C(i,"item"),c=()=>{r.value.path!=="/"&&ee("/")};return(_,h)=>{const m=S;return s(),v(m,{item:e(d),onClick:c},{avatar:l(()=>[Je]),default:l(()=>[Ge]),_:1},8,["item"])}}}),Fe={class:"text-xs"},ze=$({__name:"ProjectInvite",props:{item:{}},setup(n){const i=n,{navigateToProject:t}=W(),r=C(i,"item");return(d,c)=>{const _=S;return s(),v(_,{item:e(r),onClick:c[0]||(c[0]=h=>e(t)({baseId:e(r).body.id}))},{default:l(()=>[o("div",Fe,[o("strong",null,E(e(r).body.invited_by),1),x(" has invited you to collaborate on ")])]),_:1},8,["item"])}}}),qe={class:"text-xs gap-2"},Qe=$({__name:"ProjectEvent",props:{item:{}},setup(n){const t=C(n,"item"),{navigateToProject:r}=W(),d=D(()=>{switch(t.value.type){case a.PROJECT_CREATE:return"created";case a.PROJECT_UPDATE:return"updated";case a.PROJECT_DELETE:return"deleted"}}),c=()=>{t.value.type!==a.PROJECT_DELETE&&r({baseId:t.value.body.id})};return(_,h)=>{const m=ke,f=S;return s(),v(f,{item:e(t),onClick:c},{default:l(()=>[o("div",qe,[x(" Base "),u(m,{style:{"vertical-align":"middle"},type:e(t).body.type},null,8,["type"]),x(),o("strong",null,E(e(t).body.title),1),x(" "+E(e(d))+" successfully ",1)])]),_:1},8,["item"])}}}),Xe={class:"text-xs gap-2"},Ye=$({__name:"TableEvent",props:{item:{}},setup(n){const t=C(n,"item"),{navigateToProject:r}=W(),d=D(()=>{switch(t.value.type){case a.TABLE_CREATE:return"created";case a.TABLE_UPDATE:return"updated";case a.TABLE_DELETE:return"deleted"}}),c=()=>{t.value.type!==a.TABLE_DELETE&&r({baseId:t.value.body.id})};return(_,h)=>{const m=S;return s(),v(m,{item:e(t),onClick:c},{default:l(()=>[o("div",Xe,[x(" Table "),o("strong",null,E(e(t).body.title),1),x(" "+E(e(d))+" successfully ",1)])]),_:1},8,["item"])}}}),Ze={class:"text-xs gap-2"},et=$({__name:"ViewEvent",props:{item:{}},setup(n){const t=C(n,"item"),{navigateToProject:r}=W(),d=D(()=>{switch(t.value.type){case a.VIEW_CREATE:return"created";case a.VIEW_UPDATE:return"updated";case a.VIEW_DELETE:return"deleted"}}),c=()=>{t.value.type!==a.VIEW_DELETE&&r({baseId:t.value.body.id})};return(_,h)=>{const m=S;return s(),v(m,{item:e(t),onClick:c},{default:l(()=>[o("div",Ze,[x(" View "),o("strong",null,E(e(t).body.title),1),x(" "+E(e(d))+" successfully ",1)])]),_:1},8,["item"])}}}),tt={class:"text-xs gap-2"},ot=$({__name:"SharedViewEvent",props:{item:{}},setup(n){const t=C(n,"item"),{navigateToProject:r}=W(),d=D(()=>{switch(t.value.type){case a.VIEW_CREATE:return"created";case a.VIEW_UPDATE:return"updated";case a.VIEW_DELETE:return"deleted"}}),c=()=>{t.value.type!==a.VIEW_DELETE&&r({baseId:t.value.body.id})};return(_,h)=>{const m=S;return s(),v(m,{item:e(t),onClick:c},{default:l(()=>[o("div",tt,[x(" Shared view "),o("strong",null,E(e(t).body.title),1),x(" "+E(e(d))+" successfully ",1)])]),_:1},8,["item"])}}}),nt={key:8},st=$({__name:"Item",props:{item:{}},setup(n){const t=C(n,"item"),r=V(),{markAsRead:d}=r;return(c,_)=>{const h=Ke,m=ze,f=q("NotificationItemWorkspaceInvite"),I=Qe,b=Ye,R=et,k=ot,p=q("NotificationItemWorkspaceEvent");return s(),g("div",{class:"select-none",onClick:_[0]||(_[0]=y=>e(d)(e(t)))},[e(t).type===e(a).WELCOME?(s(),v(h,{key:0,item:e(t)},null,8,["item"])):e(t).type===e(a).PROJECT_INVITE?(s(),v(m,{key:1,item:e(t)},null,8,["item"])):e(t).type===e(a).WORKSPACE_INVITE?(s(),v(f,{key:2,item:e(t)},null,8,["item"])):[e(a).PROJECT_CREATE,e(a).PROJECT_DELETE,e(a).PROJECT_UPDATE].includes(e(t).type)?(s(),v(I,{key:3,item:e(t)},null,8,["item"])):[e(a).TABLE_CREATE,e(a).TABLE_DELETE,e(a).TABLE_UPDATE].includes(e(t).type)?(s(),v(b,{key:4,item:e(t)},null,8,["item"])):[e(a).VIEW_CREATE,e(a).VIEW_DELETE,e(a).VIEW_UPDATE].includes(e(t).type)?(s(),v(R,{key:5,item:e(t)},null,8,["item"])):[e(a).SHARED_VIEW_CREATE,e(a).SHARED_VIEW_DELETE,e(a).SHARED_VIEW_UPDATE].includes(e(t).type)?(s(),v(k,{key:6,item:e(t)},null,8,["item"])):[e(a).WORKSPACE_CREATE,e(a).WORKSPACE_DELETE,e(a).WORKSPACE_UPDATE].includes(e(t).type)?(s(),v(p,{key:7,item:e(t)},null,8,["item"])):(s(),g("span",nt))])}}}),oe=n=>(U("data-v-dfa05017"),n=n(),H(),n),at={class:"min-w-[350px] max-w-[350px] min-h-[400px] !rounded-2xl bg-white rounded-xl nc-card"},it={class:"flex items-center"},ct={class:"text-md font-medium text-[#212121]"},rt=oe(()=>o("div",{class:"flex-grow"},null,-1)),_t={key:0,class:"flex flex-col gap-2 items-center justify-center"},lt={class:"text-sm text-gray-400"},dt={class:"flex flex-row w-full justify-center mt-2"},ut=oe(()=>o("span",null,null,-1)),pt=$({__name:"Card",setup(n){const i=V(),{notifications:t,isRead:r,pageInfo:d}=ve(i);return(c,_)=>{var b,R,k;const h=Re,m=M,f=st,I=Ce;return s(),g("div",at,[o("div",{class:"p-3",onClick:_[1]||(_[1]=j(()=>{},["stop"]))},[o("div",it,[o("span",ct,E(c.$t("general.notification")),1),rt,!e(r)&&((b=e(t))!=null&&b.length)?(s(),g("div",{key:0,class:"cursor-pointer text-xs text-gray-500 hover:text-primary",onClick:_[0]||(_[0]=j((...p)=>e(i).markAllAsRead&&e(i).markAllAsRead(...p),["stop"]))},E(c.$t("activity.markAllAsRead")),1)):A("",!0)])]),u(h,{class:"!my-0"}),o("div",{class:P(["overflow-y-auto max-h-[max(60vh,500px)] min-h-100",{"flex items-center justify-center":!((R=e(t))!=null&&R.length)}])},[(k=e(t))!=null&&k.length?(s(),g(B,{key:1},[(s(!0),g(B,null,he(e(t),p=>(s(),g(B,{key:p.id},[u(f,{class:"",item:p},null,8,["item"]),u(h,{class:"!my-0"})],64))),128)),e(t)&&e(d)&&e(d).totalRows>e(t).length?(s(),v(e(Te),{key:0,onInfinite:_[2]||(_[2]=p=>e(i).loadNotifications(!0))},{spinner:l(()=>[o("div",dt,[u(I)])]),complete:l(()=>[ut]),_:1})):A("",!0)],64)):(s(),g("div",_t,[o("div",lt,E(c.$t("msg.noNewNotifications")),1),u(m,{icon:"inbox",class:"!text-40px text-gray-400"})]))],2)])}}});const mt=N(pt,[["__scopeId","data-v-dfa05017"]]),ft={class:"cursor-pointer flex items-center"},vt={class:"relative leading-none"},ht={key:0,class:"nc-count-badge"},Et=$({__name:"Menu",setup(n){const i=V(),{loadNotifications:t,markAsOpened:r}=i;Ee(async()=>{await t()});const d=c=>{c&&r()};return(c,_)=>{const h=M,m=mt,f=J;return s(),g("div",ft,[u(f,{trigger:["click"],onVisibleChange:d},{overlay:l(()=>[u(m)]),default:l(()=>[o("div",vt,[u(h,{icon:"notification"}),u(h,{icon:"menuDown"}),!e(i).isOpened&&e(i).unreadCount?(s(),g("span",ht,E(e(i).unreadCount),1)):A("",!0)])]),_:1})])}}});const yt=N(Et,[["__scopeId","data-v-e442a77a"]]),gt={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},xt=o("path",{fill:"currentColor",d:"m17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5M4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"},null,-1),bt=[xt];function wt(n,i){return s(),g("svg",gt,[...bt])}const $t={name:"mdi-logout",render:wt},It={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},At=o("path",{fill:"currentColor",d:"M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2M7.07 18.28c.43-.9 3.05-1.78 4.93-1.78s4.5.88 4.93 1.78A7.893 7.893 0 0 1 12 20c-1.86 0-3.57-.64-4.93-1.72m11.29-1.45c-1.43-1.74-4.9-2.33-6.36-2.33s-4.93.59-6.36 2.33A7.928 7.928 0 0 1 4 12c0-4.41 3.59-8 8-8s8 3.59 8 8c0 1.82-.62 3.5-1.64 4.83M12 6c-1.94 0-3.5 1.56-3.5 3.5S10.06 13 12 13s3.5-1.56 3.5-3.5S13.94 6 12 6m0 5a1.5 1.5 0 0 1-1.5-1.5A1.5 1.5 0 0 1 12 8a1.5 1.5 0 0 1 1.5 1.5A1.5 1.5 0 0 1 12 11"},null,-1),kt=[At];function Tt(n,i){return s(),g("svg",It,[...kt])}const Ct={name:"mdi-account-circle-outline",render:Tt},Rt=n=>(U("data-v-bbe1ebb7"),n=n(),H(),n),Wt={class:"flex w-full h-full items-center nc-header-content"},Dt={class:"flex-1 min-w-0 w-50"},St=Rt(()=>o("img",{src:Se,class:"h-11"},null,-1)),Lt={key:0,class:"flex gap-1"},Pt={class:"flex-1 min-w-0 flex justify-end gap-2"},Nt={class:"flex flex-row flex-grow"},Vt={key:0,class:"flex items-center"},Ot={class:"flex items-center gap-1 cursor-pointer","data-testid":"nc-ws-account-menu-dropdown"},Bt={class:"h-8.5 w-8.5 rounded-full text-xs bg-secondary flex items-center justify-center font-weight-bold text-black uppercase"},jt={class:"prose group-hover:text-primary"},Mt={class:"text-xs text-gray-500"},Ut={class:"prose group-hover:text-primary"},Ht={class:"w-full h-[calc(100vh_-_var(--new-header-height))]"},Jt={name:"DefaultLayout"},Gt=$({...Jt,setup(n){var k;const i=ye();We();const{te:t,t:r}=ge(),d=T(!0),c=T(!0),{signOut:_,user:h}=W(),{clearWorkspaces:m}=De(),f=D(()=>{var p;return((p=h.value)==null?void 0:p.email)??"---"}),I=T(!1);xe((k=i.meta)!=null&&k.title&&t(i.meta.title)?`${r(i.meta.title)}`:"NocoDB");const b=D(()=>{var p;return(p=i.meta)==null?void 0:p.public});X(d,p=>{p||(I.value=!0,we(()=>{I.value=!1}))});const R=async()=>{await _(!1),await ee("/signin"),await m()};return(p,y)=>{const w=le,O=yt,ne=Ie,se=Ct,G=Y,K=Ae,ae=$t,ie=Z,ce=J,re=Pe,_e=Ne,F=Le,z=be("e");return s(),v(F,null,{default:l(()=>[u(re,{class:"max-h-[var(--new-header-height)] !px-2"},{default:l(()=>[o("div",Wt,[o("div",Dt,[u(w,{to:e(b)?"":"/"},{default:l(()=>[St]),_:1},8,["to"])]),(p._.provides[$e]||p.$route).name==="index-index"?(s(),g("div",Lt)):A("",!0),o("div",Pt,[o("div",Nt,[L(p.$slots,"navbar",{},void 0,!0)]),e(b)?A("",!0):(s(),g("div",Vt,[u(O,{class:"mr-2","data-testid":"nc-notification-bell-icon"})])),e(b)?A("",!0):(s(),v(ce,{key:1,trigger:["click"],"overlay-class-name":"nc-dropdown-user-accounts-menu"},{overlay:l(()=>[u(ie,{class:"!py-0 leading-8 !rounded min-w-40"},{default:l(()=>[u(G,{key:"0","data-testid":"nc-menu-accounts__user-settings",class:"!rounded-t"},{default:l(()=>[Q((s(),v(w,{class:"nc-base-menu-item group !no-underline",to:"/account/users"},{default:l(()=>[u(se,{class:"mt-1 group-hover:text-accent"}),x("  "),o("div",jt,[o("div",null,E(p.$t("labels.account")),1),o("div",Mt,E(e(f)),1)])]),_:1})),[[z,["c:navbar:user:email"]]])]),_:1}),u(K,{class:"!m-0"}),u(K,{class:"!m-0"}),u(G,{key:"1",class:"!rounded-b group","data-testid":"nc-menu-accounts__sign-out"},{default:l(()=>[Q((s(),g("div",{class:"nc-base-menu-item group","data-testid":"nc-logout-btn",onClick:R},[u(ae,{class:"group-hover:text-accent"}),x("  "),o("span",Ut,E(p.$t("general.signOut")),1)])),[[z,["a:navbar:user:sign-out"]]])]),_:1})]),_:1})]),default:l(()=>[o("div",Ot,[o("div",Bt,E(e(f)?e(f).split("@")[0].slice(0,2):"A"),1),u(ne)])]),_:1}))])])]),_:3}),u(F,{class:"nc-root"},{default:l(()=>[e(d)?(s(),v(_e,{key:0,ref:"sidebar",collapsed:!e(c),width:"250","collapsed-width":"50",class:"relative shadow-md h-full z-1 nc-left-sidebar h-[calc(100vh_-_var(--new-header-height))] !shadow-none border-gray-100 border-r-1 !overflow-x-hidden",trigger:null,collapsible:"",theme:"light"},{default:l(()=>[L(p.$slots,"sidebar",{},void 0,!0)]),_:3},8,["collapsed"])):A("",!0),o("div",Ht,[L(p.$slots,"default",{},void 0,!0)])]),_:3})]),_:3})}}});const po=N(Gt,[["__scopeId","data-v-bbe1ebb7"]]);export{po as default};
