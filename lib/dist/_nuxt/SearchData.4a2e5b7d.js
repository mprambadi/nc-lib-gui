import{_ as H}from"./Icon.vue.129448d5.js";import{_ as L}from"./Icon.vue.5fdb2789.js";import{_ as M}from"./Tooltip.vue.971897f4.js";import{f as Q,bb as k,r as u,$ as R,cg as A,g as S,cZ as E,cG as P,H as C,h0 as W,c9 as Z,o as n,c as h,a as y,b as p,O as t,t as x,T as V,P as d,Q as $,R as I,au as B,w as f,U as J,V as K,d as F,S as N}from"./entry.5958c07b.js";import{R as X,A as Y}from"./index.9b87fcff.js";import{a as ee,b as te}from"./useSmartsheetStore.f1a70558.js";import"./index.ae235b22.js";import{I as ae}from"./Input.dca3a2bc.js";import{S as oe,_ as re}from"./index.5c6e4286.js";import{_ as se}from"./_plugin-vue_export-helper.c27b6911.js";import"./VirtualCellIcon.aeca9423.js";import"./virtualCell.427fa223.js";import"./CellIcon.b1340151.js";import"./cell.165313cd.js";import"./bases.e6c8e3c4.js";import"./index.0feaca99.js";import"./views.4281cbf1.js";import"./useSharedView.e8f68616.js";import"./index.e61e381a.js";import"./SearchOutlined.a517903c.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.ddc65fa5.js";import"./Password.f52125e7.js";import"./toArray.fd74ce6f.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";const le={key:0,class:"w-16 text-[0.75rem] font-medium text-gray-400 truncate"},ne={class:"xs:text-gray-600 group-hover:text-gray-700 sm:text-gray-400"},ie={class:"text-sm flex items-center gap-2"},ce=Q({__name:"SearchData",setup(me){const O=k(X),{meta:T}=ee(),g=k(Y,u()),{search:s,loadFieldQuery:q}=te(),c=u(!1),{isMobileMode:z}=R(),v=u(!1),w=u(null);A(w,()=>c.value=!1);const i=S(()=>{var a,e,l;return(l=(e=(a=T.value)==null?void 0:a.columns)==null?void 0:e.filter(o=>!E(o)&&(o==null?void 0:o.uidt)!==P.Links))==null?void 0:l.map(o=>({value:o.id,label:o.title,column:o,primaryValue:o.pv}))});C(()=>{var a;return(a=g.value)==null?void 0:a.id},(a,e)=>{var l;a!==e&&q((l=g.value)==null?void 0:l.id)},{immediate:!0});function _(){O.trigger()}const b=S(()=>{var a,e,l,o;return s.value.field?(e=(a=i.value)==null?void 0:a.find(m=>m.value===s.value.field))==null?void 0:e.label:(o=(l=i.value)==null?void 0:l.find(m=>m.primaryValue))==null?void 0:o.label});return W(()=>s.value.query,()=>{_()},{debounce:500,maxWait:600}),C(i,()=>{var a;(a=i.value)!=null&&a.length&&(s.value.field=i.value[0].value)}),(a,e)=>{const l=H,o=L,m=M,U=oe,j=re,G=ae,D=Z("e");return n(),h("div",{class:N(["flex flex-row border-1 rounded-lg h-8 xs:h-10 xs:ml-0 ml-1 border-gray-200 overflow-hidden",{"border-primary":t(s).query.length!==0||t(v)}])},[y("div",{ref_key:"searchDropdown",ref:w,class:N(["flex items-center group relative px-2 cursor-pointer border-r-1 border-gray-200 hover:bg-gray-100",{"bg-gray-50 ":t(c)}]),onClick:e[1]||(e[1]=r=>c.value=!t(c))},[p(l,{icon:"search",class:"ml-1 mr-2 h-3.5 w-3.5 text-gray-500 group-hover:text-black"}),t(z)?V("",!0):(n(),h("div",le,x(t(b)),1)),y("div",ne,[(n(),d($(t(I).arrowDown),{class:"text-sm text-inherit"}))]),B((n(),d(j,{value:t(s).field,"onUpdate:value":e[0]||(e[0]=r=>t(s).field=r),open:t(c),size:"small","dropdown-match-select-width":!1,"dropdown-class-name":"!rounded-lg nc-dropdown-toolbar-search-field-option max-w-64",class:"py-1 !absolute top-2 left-0 w-full h-full z-10 text-xs opacity-0",onChange:_},{default:f(()=>[(n(!0),h(J,null,K(t(i),r=>B((n(),d(U,{key:r.value,value:r.value},{default:f(()=>[y("div",ie,[p(o,{column:r.column},null,8,["column"]),p(m,{class:"truncate flex-1",placement:"top","show-on-truncate-only":""},{title:f(()=>[F(x(r.label),1)]),default:f(()=>[F(" "+x(r.label),1)]),_:2},1024),t(s).field===r.value?(n(),d($(t(I).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):V("",!0)])]),_:2},1032,["value"])),[[D,["c:search:field:select"]]])),128))]),_:1},8,["value","open"])),[[D,["c:search:field:select:open"]]])],2),p(G,{value:t(s).query,"onUpdate:value":e[2]||(e[2]=r=>t(s).query=r),size:"small",class:"text-xs w-40",placeholder:`${a.$t("general.searchIn")} ${t(b)}`,bordered:!1,"data-testid":"search-data-input",onPressEnter:_,onFocus:e[3]||(e[3]=r=>v.value=!0),onBlur:e[4]||(e[4]=r=>v.value=!1)},null,8,["value","placeholder"])],2)}}});const Me=se(ce,[["__scopeId","data-v-532f4c32"]]);export{Me as default};
