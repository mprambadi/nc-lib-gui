import F from"./VirtualCellIcon.aeca9423.js";import{_ as A}from"./CellIcon.b1340151.js";import{_ as E}from"./Tooltip.vue.971897f4.js";import{M as P}from"./index.9b87fcff.js";import{f as Z,a5 as G,bb as Q,r as W,M as Y,bF as z,g as M,eZ as H,cZ as J,cG as K,i as X,o as l,c as u,O as i,b as m,w as s,U as O,V as T,P as c,a as r,d as V,t as _,Q as v,R as L,T as S,ae as I,n as ee,eW as oe}from"./entry.5958c07b.js";import{a as te,b as ne}from"./bases.e6c8e3c4.js";import{b as ie}from"./EditOrAddProvider.vue.31035ffc.js";import{S as le,_ as ae}from"./index.5c6e4286.js";import{_ as se}from"./FormItem.0bbf90a3.js";import{_ as re}from"./_plugin-vue_export-helper.c27b6911.js";import"./virtualCell.427fa223.js";import"./cell.165313cd.js";import"./index.0feaca99.js";import"./Icon.vue.129448d5.js";import"./Button.vue.c3ca0e8f.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./views.4281cbf1.js";import"./useSharedView.e8f68616.js";import"./validation.2de04583.js";import"./index.b06c8b67.js";import"./useSize.fad35fe8.js";import"./identity.34c7640e.js";import"./_flatRest.39582a58.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./FormItemContext.ddc65fa5.js";import"./vuedraggable.umd.00f5fccc.js";import"./v3-infinite-loading.660bd977.js";import"./index.dc13a4d6.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./index.ae235b22.js";import"./Input.dca3a2bc.js";import"./antInputDirective.8ac36ea7.js";import"./SearchOutlined.a517903c.js";import"./TextArea.9074ff05.js";import"./Password.f52125e7.js";import"./index.5e1434a7.js";import"./Checkbox.2e7b0035.js";import"./createForOfIteratorHelper.33de41ba.js";import"./toArray.fd74ce6f.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";import"./Col.a97e3e76.js";import"./responsiveObserve.0baefba6.js";const _e={class:"p-6 w-full flex flex-col border-2 mb-2 mt-4"},ue={key:0,class:"w-full flex flex-row space-x-2"},me={class:"flex gap-2 w-full justify-between truncate items-center"},ce={class:"inline-flex items-center truncate gap-2"},pe={class:"text-[0.65rem] flex-1 truncate text-gray-600 nc-relation-details"},de={class:"uppercase"},fe={class:"truncate"},ke={class:"flex gap-2 truncate items-center"},ve={class:"inline-flex items-center flex-1 truncate font-semibold"},he={class:"truncate flex-1"},ge={key:1},ye=Z({__name:"LookupOptions",props:{value:{}},emits:["update:value"],setup(N,{emit:B}){const t=G(N,"value",B),p=Q(P,W()),{t:h}=Y(),{setAdditionalValidations:q,validateInfos:g,onDataTypeChange:y,isEdit:R}=ie(),U=te(),{tables:d}=z(U),{metas:$}=ne();q({fk_relation_column_id:[{required:!0,message:h("general.required")}],fk_lookup_column_id:[{required:!0,message:h("general.required")}]}),t.value.fk_relation_column_id||(t.value.fk_relation_column_id=null),t.value.fk_lookup_column_id||(t.value.fk_lookup_column_id=null);const f=M(()=>!d.value||!d.value.length||!p.value||!p.value.columns?[]:p.value.columns.filter(e=>{var a;return H(e)&&!e.system&&e.source_id===((a=p.value)==null?void 0:a.source_id)}).map(e=>({col:e.colOptions,column:e,...d.value.find(a=>a.id===e.colOptions.fk_related_model_id)})).filter(e=>{var a;return((a=e.col)==null?void 0:a.fk_related_model_id)===e.id&&!e.mm})),w=M(()=>{const o=f.value.find(e=>e.column.id===t.value.fk_relation_column_id);return o!=null&&o.id?$.value[o.id].columns.filter(e=>t.value.fk_lookup_column_id===e.id||!J(e)&&e.id!==t.value.id&&e.uidt!==K.Links):[]});X(()=>{var o,e;R.value&&(t.value.fk_lookup_column_id=(o=t.value.colOptions)==null?void 0:o.fk_lookup_column_id,t.value.fk_relation_column_id=(e=t.value.colOptions)==null?void 0:e.fk_relation_column_id)});const j=()=>{var o,e;t.value.fk_lookup_column_id=(e=(o=w.value)==null?void 0:o[0])==null?void 0:e.id,y()},D=o=>ee(oe(o)?F:A,{columnMeta:o});return(o,e)=>{const a=E,x=le,b=ae,C=se;return l(),u("div",_e,[i(f).length?(l(),u("div",ue,[m(C,I({class:"flex w-1/2 pb-2",label:o.$t("labels.links")},i(g).fk_relation_column_id),{default:s(()=>[m(b,{value:i(t).fk_relation_column_id,"onUpdate:value":e[0]||(e[0]=n=>i(t).fk_relation_column_id=n),"dropdown-class-name":"!w-64 !rounded-md nc-dropdown-relation-table",onChange:j},{default:s(()=>[(l(!0),u(O,null,T(i(f),(n,k)=>(l(),c(x,{key:k,value:n.col.fk_column_id},{default:s(()=>[r("div",me,[m(a,{class:"font-semibold truncate min-w-1/2","show-on-truncate-only":""},{title:s(()=>[V(_(n.column.title),1)]),default:s(()=>[V(" "+_(n.column.title),1)]),_:2},1024),r("div",ce,[r("div",pe,[r("span",de,_(n.col.type),1),r("span",fe,_(n.title||n.table_name),1)]),i(t).fk_relation_column_id===n.col.fk_column_id?(l(),c(v(("iconMap"in o?o.iconMap:i(L)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):S("",!0)])])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},16,["label"]),m(C,I({class:"flex w-1/2",label:o.$t("labels.childField")},i(g).fk_lookup_column_id),{default:s(()=>[m(b,{value:i(t).fk_lookup_column_id,"onUpdate:value":e[1]||(e[1]=n=>i(t).fk_lookup_column_id=n),name:"fk_lookup_column_id","dropdown-class-name":"nc-dropdown-relation-column !rounded-md",onChange:i(y)},{default:s(()=>[(l(!0),u(O,null,T(i(w),(n,k)=>(l(),c(x,{key:k,value:n.id},{default:s(()=>[r("div",ke,[r("div",ve,[(l(),c(v(D(n)),{"column-meta":n},null,8,["column-meta"])),r("div",he,_(n.title),1)]),i(t).fk_lookup_column_id===n.id?(l(),c(v(("iconMap"in o?o.iconMap:i(L)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):S("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","onChange"])]),_:1},16,["label"])])):(l(),u("div",ge,_(o.$t("msg.linkColumnClearNotSupportedYet")),1))])}}});const yo=re(ye,[["__scopeId","data-v-b7060d72"]]);export{yo as default};
