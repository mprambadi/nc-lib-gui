import{f as Y,bb as a,r as s,bA as Z,fi as _,aM as ee,M as te,H as P,c9 as le,o as v,c as B,a as M,au as oe,P as x,w as ne,d as ae,t as se,O as l,S as O,cb as k,bv as K,Q as re,T as C,a0 as S,a1 as z}from"./entry.96205fa0.js";import{o as ie,C as ue,n as ce,B as de,c as pe,i as me,H as ve,l as fe,m as _e}from"./index.9b87fcff.js";import{a as ke}from"./useSmartsheetRowStore.9c7d6fc1.js";import{u as ge}from"./useLTARStore.444f4bbc.js";import{u as ye}from"./index.a5de28c1.js";import{_ as he}from"./plus.ddb9e9b9.js";import"./deepCompare.d32ec333.js";import"./dataUtils.fb0a3616.js";import"./virtualCell.9142cfee.js";import"./bases.965a49bb.js";import"./index.0c5b3837.js";import"./index.e034edbd.js";import"./useSharedView.9e320acb.js";const we=S(()=>z(()=>import("./ListItems.5a582ca1.js"),["./ListItems.5a582ca1.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Pagination.2fe08f8a.js","./Icon.vue.6d0583a0.js","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./index.b5e393d6.js","./toArray.3561b70e.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./useState.5a301439.js","./CheckOutlined.3b90c20d.js","./SearchOutlined.c9794270.js","./FormItemContext.b19eb48c.js","./Pagination.fabf8b70.css","./Modal.vue.3dac5189.js","./DeleteModal.7ab6f524.css","./bases.965a49bb.js","./index.0c5b3837.js","./index.9b87fcff.js","./cell.810c4fd3.js","./useLTARStore.444f4bbc.js","./index.e034edbd.js","./useSharedView.9e320acb.js","./useSmartsheetRowStore.9c7d6fc1.js","./deepCompare.d32ec333.js","./dataUtils.fb0a3616.js","./virtualCell.9142cfee.js","./plus.ddb9e9b9.js","./magnify.92946687.js","./inbox.41f0ce87.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./Image.d07b34cf.js","./Element.a2c5baa8.js","./index.7e75edca.js","./Input.553ad305.js","./ListItems.d8bb4ba4.css"],import.meta.url).then(u=>u.default||u)),xe=S(()=>z(()=>import("./ListChildItems.92636a54.js"),["./ListChildItems.92636a54.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Pagination.2fe08f8a.js","./Icon.vue.6d0583a0.js","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./index.b5e393d6.js","./toArray.3561b70e.js","./antInputDirective.8ac36ea7.js","./isMobile.e2e89480.js","./useMemo.dbc63a5f.js","./useState.5a301439.js","./CheckOutlined.3b90c20d.js","./SearchOutlined.c9794270.js","./FormItemContext.b19eb48c.js","./Pagination.fabf8b70.css","./Modal.vue.3dac5189.js","./DeleteModal.7ab6f524.css","./bases.965a49bb.js","./index.0c5b3837.js","./index.9b87fcff.js","./cell.810c4fd3.js","./useLTARStore.444f4bbc.js","./index.e034edbd.js","./useSharedView.9e320acb.js","./useSmartsheetRowStore.9c7d6fc1.js","./deepCompare.d32ec333.js","./dataUtils.fb0a3616.js","./virtualCell.9142cfee.js","./plus.ddb9e9b9.js","./magnify.92946687.js","./inbox.41f0ce87.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./Image.d07b34cf.js","./Element.a2c5baa8.js","./Input.553ad305.js","./ListChildItems.7a5d47c9.css"],import.meta.url).then(u=>u.default||u)),Ce={class:"block flex-shrink truncate"},Le=M("div",{class:"flex-grow"},null,-1),Ie=["onKeydown"],Se=Y({__name:"Links",setup(u){const c=a(ie,s(0)),r=a(ue),U=a(ce),$=a(de,Z()),i=a(pe),H=a(me,s(!1)),g=a(ve,s(!1)),N=a(fe,s(!1)),L=_(()=>{var e;return((e=r.value)==null?void 0:e.title)||""}),o=s(!1),n=s(!1),{isUIAllowed:Q}=ee(),{t:f}=te(),{state:d,isNew:I}=ke(),{relatedTableMeta:q,loadRelatedTableMeta:F,relatedTableDisplayValueProp:G}=ge(r,U,I,$.trigger),b=_(()=>{var e,t;return(t=(e=q.value)==null?void 0:e.columns)==null?void 0:t.find(p=>p.title===G.value)});F();const R=_(()=>{var t,p,y,h,w,m,E,A;if(i!=null&&i.value||I.value)return(p=(t=d.value)==null?void 0:t[L.value])!=null&&p.length?`${+((h=(y=d.value)==null?void 0:y[L.value])==null?void 0:h.length)} ${f("msg.recordsLinked")}`:f("msg.noRecordsLinked");const e=+(c==null?void 0:c.value)||0;return e?e===1?`1 ${((m=(w=r.value)==null?void 0:w.meta)==null?void 0:m.singular)||f("general.link")}`:`${e} ${((A=(E=r.value)==null?void 0:E.meta)==null?void 0:A.plural)||f("general.links")}`:f("msg.noRecordsLinked")}),J=_(()=>{var e,t;return i!=null&&i.value?(t=(e=d.value)==null?void 0:e[L.value])==null?void 0:t.length:+(c==null?void 0:c.value)||0}),W=()=>{n.value=!1,o.value=!0},V=()=>{g.value||(n.value=!0)};ye(a(_e,s(!1)),e=>{switch(e.key){case"Enter":if(o.value)return;n.value=!0,e.stopPropagation();break}});const X=_(()=>{var e;return I.value?((e=d==null?void 0:d.value)==null?void 0:e[r==null?void 0:r.value.title])??[]:[]}),D=()=>{g.value||(o.value=!0)},T=s(null),j=s(null);return P([n],()=>{var e;n.value||(e=j.value)==null||e.focus()}),P([o],()=>{var e;o.value||(e=T.value)==null||e.focus()}),(e,t)=>{const p=he,y=we,h=xe,w=le("e");return v(),B("div",{class:O(["flex w-full group items-center nc-links-wrapper py-1",{"px-2":l(N)}]),onDblclick:k(V,["stop"])},[M("div",Ce,[oe((v(),x(re(l(g)?"span":"a"),{ref_key:"childListDlgRef",ref:j,title:l(R),class:O(["text-center nc-datatype-link underline-transparent",{"!text-gray-300":!l(R)}]),tabindex:"0",onClick:k(V,["stop","prevent"]),onKeydown:K(k(V,["stop","prevent"]),["enter"])},{default:ne(()=>[ae(se(l(R)),1)]),_:1},40,["title","class","onKeydown"])),[[w,["c:cell:links:modal:open"]]])]),Le,l(g)?C("",!0):(v(),B("div",{key:0,ref_key:"plusBtnRef",ref:T,tabindex:"0",class:"!xs:hidden flex group justify-end group-hover:flex items-center",onKeydown:K(k(D,["stop"]),["enter"])},[!l(H)&&l(Q)("dataEdit")||l(i)?(v(),x(p,{key:0,class:"select-none !text-md text-gray-700 nc-action-icon nc-plus invisible group-hover:visible group-focus:visible",onClick:k(D,["stop"])})):C("",!0)],40,Ie)),o.value||n.value?(v(),x(y,{key:1,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=m=>o.value=m),column:l(b)},null,8,["modelValue","column"])):C("",!0),o.value||n.value?(v(),x(h,{key:2,modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=m=>n.value=m),items:l(J),column:l(b),"cell-value":l(X),onAttachRecord:W},null,8,["modelValue","items","column","cell-value"])):C("",!0)],34)}}});export{Se as default};
