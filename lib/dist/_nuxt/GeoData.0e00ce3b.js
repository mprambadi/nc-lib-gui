import{f as j,a5 as q,bb as T,r as w,g as U,N as A,o as i,P as m,w as a,b as s,O as e,a as r,t as d,cb as g,Q as x,R as y,S,T as M,d as b,c as I,ah as K,W as P,a8 as z}from"./entry.5958c07b.js";import{l as H}from"./index.9b87fcff.js";import{l as J}from"./geoDataUtils.62b1d864.js";import"./index.ae235b22.js";import{I as Q}from"./Input.dca3a2bc.js";import{F as W}from"./index.b06c8b67.js";import{D as X}from"./index.dc13a4d6.js";import{_ as Y}from"./FormItem.0bbf90a3.js";import{_ as Z}from"./_plugin-vue_export-helper.c27b6911.js";import"./SearchOutlined.a517903c.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./antInputDirective.8ac36ea7.js";import"./FormItemContext.ddc65fa5.js";import"./Password.f52125e7.js";import"./useSize.fad35fe8.js";import"./identity.34c7640e.js";import"./isSymbol.114fe557.js";import"./_flatRest.39582a58.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./Dropdown.041b2468.js";import"./RightOutlined.7161c742.js";import"./Col.a97e3e76.js";import"./responsiveObserve.0baefba6.js";import"./toArray.fd74ce6f.js";const tt={key:0,class:"group cursor-pointer flex gap-1 items-center mx-auto max-w-64 justify-center active:ring active:ring-accent active:ring-opacity-100 rounded border-1 p-1 shadow-sm hover:bg-primary hover:bg-opacity-10 !dark:bg-slate-500 my-1",tabindex:"0"},et={class:"flex items-center gap-2","data-testid":"nc-geo-data-set-location-button"},ot={class:"group-hover:text-primary text-gray-500 dark:text-gray-200 dark:group-hover:!text-white text-xs"},at={class:"flex mt-4 items-center mx-2"},st={class:"mr-2"},nt={class:"flex items-center mx-2"},lt={class:"mr-2"},it={class:"mr-2 flex flex-col items-end gap-1 text-left"},rt={class:"mr-2 flex flex-row items-end gap-1 text-left"},dt={class:"ml-auto mr-2 w-auto"},pt=j({__name:"GeoData",props:{modelValue:{}},emits:["update:modelValue"],setup(F,{emit:V}){const c=q(F,"modelValue",V),D=T(H,w(!1)),f=w(!1),v=w(!1),k=w(!1),[$,h]=(c.value||"").split(";"),C=U(()=>{const[o,t]=(c.value||"").split(";");return o&&(k.value=!0),o&&t?`${o}; ${t}`:"Set location"}),n=A({latitude:$,longitude:h}),L=()=>{c.value=J(parseFloat(n.latitude),parseFloat(n.longitude)),f.value=!1},N=()=>{f.value=!1,n.latitude=$,n.longitude=h},E=()=>{v.value=!0;const o=l=>{const u=l.coords;n.latitude=`${u.latitude}`,n.longitude=`${u.longitude}`,v.value=!1},t=l=>{console.error(`ERROR(${l.code}): ${l.message}`),v.value=!1},p={enableHighAccuracy:!0,timeout:2e4,maximumAge:2e3};navigator.geolocation.getCurrentPosition(o,t,p)},O=()=>{const[o,t]=(c.value||"").split(";"),p=`https://www.google.com/maps/search/?api=1&query=${o},${t}`;window.open(p,"_blank","noopener,noreferrer")},B=()=>{const[o,t]=(c.value||"").split(";"),p=`https://www.openstreetmap.org/?mlat=${o}&mlon=${t}#map=15/${o}/${t}`;window.open(p,"_blank","'noopener,noreferrer'")};return(o,t)=>{const p=Q,l=Y,u=z,G=W,R=X;return i(),m(R,{is:e(f)?e(K):"div",visible:e(f),"onUpdate:visible":t[8]||(t[8]=_=>P(f)?f.value=_:null),trigger:["click"]},{overlay:a(()=>[s(G,{model:e(n),class:"flex flex-col w-max-64 border-1 border-gray-200",onFinish:L},{default:a(()=>[s(l,null,{default:a(()=>[r("div",at,[r("div",st,d(o.$t("labels.lat"))+":",1),s(p,{value:e(n).latitude,"onUpdate:value":t[0]||(t[0]=_=>e(n).latitude=_),"data-testid":"nc-geo-data-latitude",type:"number",step:"0.0000001",min:-90,required:"",max:90,onKeydown:t[1]||(t[1]=g(()=>{},["stop"])),onSelectstartCapture:t[2]||(t[2]=g(()=>{},["stop"])),onMousedown:t[3]||(t[3]=g(()=>{},["stop"]))},null,8,["value"])])]),_:1}),s(l,null,{default:a(()=>[r("div",nt,[r("div",lt,d(o.$t("labels.lng"))+":",1),s(p,{value:e(n).longitude,"onUpdate:value":t[4]||(t[4]=_=>e(n).longitude=_),"data-testid":"nc-geo-data-longitude",type:"number",step:"0.0000001",required:"",min:-180,max:180,onKeydown:t[5]||(t[5]=g(()=>{},["stop"])),onSelectstartCapture:t[6]||(t[6]=g(()=>{},["stop"])),onMousedown:t[7]||(t[7]=g(()=>{},["stop"]))},null,8,["value"])])]),_:1}),s(l,null,{default:a(()=>[r("div",it,[e(v)?(i(),m(x(e(y).reload),{key:0,class:S({"animate-infinite animate-spin text-gray-500":e(v)})},null,8,["class"])):M("",!0),s(u,{class:"ml-2",onClick:E},{default:a(()=>[(i(),m(x(e(y).currentLocation),{class:"mr-2"})),b(d(o.$t("labels.currentLocation")),1)]),_:1})])]),_:1}),e(c)?(i(),m(l,{key:0},{default:a(()=>[r("div",rt,[s(u,{onClick:B},{default:a(()=>[(i(),m(x(e(y).openInNew),{class:"mr-2"})),b(d(o.$t("activity.map.openInOpenStreetMap")),1)]),_:1}),s(u,{onClick:O},{default:a(()=>[(i(),m(x(e(y).openInNew),{class:"mr-2"})),b(d(o.$t("activity.map.openInGoogleMaps")),1)]),_:1})])]),_:1})):M("",!0),s(l,null,{default:a(()=>[r("div",dt,[s(u,{type:"text",onClick:N},{default:a(()=>[b(d(o.$t("general.cancel")),1)]),_:1}),s(u,{type:"primary","html-type":"submit","data-testid":"nc-geo-data-save"},{default:a(()=>[b(d(o.$t("general.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])]),default:a(()=>[e(k)?(i(),I("div",{key:1,"data-testid":"nc-geo-data-lat-long-set",tabindex:"0",class:S(["h-full w-full flex items-center py-1 focus-visible:!outline-none focus:!outline-none",{"px-2":e(D)}])},d(e(C)),3)):(i(),I("div",tt,[r("div",et,[(i(),m(x(e(y).mapMarker),{class:"transform !dark:text-white !group-hover:text-accent group-hover:scale-120 text-gray-500 text-[0.75rem]"})),r("div",ot,d(e(C)),1)])]))]),_:1},8,["is","visible"])}}});const qt=Z(pt,[["__scopeId","data-v-bc6fdb83"]]);export{qt as default};
