import{f as X,L as Y,r as w,$,g as j,gO as b,e0 as J,O as a,o as s,P as R,c as o,b as O,w as d,T as p,W as A,U as Q,V as Z,a as n,t as r,cy as L,S as ee,d as N,X as te,Y as se,_ as oe,p as ae,e as ne}from"./entry.96205fa0.js";import{p as C}from"./bases.965a49bb.js";import{S as re}from"./index.7e75edca.js";import{C as ie}from"./index.c4d36e30.js";import{_ as pe,C as ce}from"./index.e7262e5b.js";import{a as le,c as _e,_ as de}from"./index.955e0908.js";import{_ as ue}from"./index.339951af.js";import{_ as me}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.0c5b3837.js";import"./Element.a2c5baa8.js";import"./Input.553ad305.js";import"./Image.d07b34cf.js";import"./index.e1ceba77.js";import"./Dropdown.1dedd322.js";import"./useState.5a301439.js";import"./useRefs.3fea1e39.js";import"./identity.309e9ead.js";import"./isSymbol.d46b4957.js";import"./_flatRest.ce557a88.js";import"./isMobile.e2e89480.js";import"./index.208c1883.js";import"./Col.b3c5d725.js";import"./responsiveObserve.358bcfe9.js";import"./isPlainObject.631eb8fb.js";import"./_getPrototype.459a70cf.js";import"./RightOutlined.3ce786f5.js";import"./LeftOutlined.5e2085dd.js";import"./index.b5e393d6.js";import"./toArray.3561b70e.js";import"./antInputDirective.8ac36ea7.js";import"./useMemo.dbc63a5f.js";import"./CheckOutlined.3b90c20d.js";import"./SearchOutlined.c9794270.js";import"./FormItemContext.b19eb48c.js";import"./useBreakpoint.2e009418.js";const g=u=>(ae("data-v-51a3e688"),u=u(),ne(),u),ye={key:1},fe={key:0},ve={key:1},xe={key:2},he={key:0},we={key:1},be=g(()=>n("span",null,[N(" For additional configuration options, please refer the documentation "),n("a",{href:"https://docs.nocodb.com/developer-resources/webhooks#call-log",target:"_blank",rel:"noopener"},"here"),N(". ")],-1)),Oe={key:0},ge={class:"w-full cursor-pointer"},Re={class:"font-weight-medium flex"},Ce={class:"flex-1"},Ee={key:0},Te={key:0,class:"mx-1 px-2 py-1 text-white rounded text-xs bg-red-500"},Ae={key:1,class:"mx-1 px-2 py-1 text-white rounded text-xs bg-green-500"},Ne={key:0},Fe={class:"font-weight-medium text-primary"},Ie={key:0,class:"mb-4"},Se={key:1},Ue={key:0,class:"nc-hook-log-request"},Ve=g(()=>n("div",{class:"nc-hook-pre-title"},"Request",-1)),Ke={class:"nc-hook-pre"},Be={key:1,class:"nc-hook-log-response"},Me=g(()=>n("div",{class:"nc-hook-pre-title"},"Response",-1)),Pe={class:"nc-hook-pre"},ze={key:2,class:"nc-hook-log-payload"},Ge=g(()=>n("div",{class:"nc-hook-pre-title"},"Payload",-1)),ke={class:"nc-hook-pre"},qe={key:2},He={key:0,class:"nc-hook-log-payload"},We=g(()=>n("div",{class:"nc-hook-pre-title"},"Payload",-1)),De={class:"nc-hook-pre"},Xe=X({__name:"CallLog",props:{hook:{}},setup(u){const V=u,{api:K,isLoading:B}=Y(),E=w([]),T=w(),{appInfo:l}=$(),F=w(0),m=w(1),y=w(10),I=j(()=>!(l.value.automationLogLevel===b.OFF||l.value.automationLogLevel===b.ALL&&!l.value.ee));async function S(_=m.value,i=y.value){try{_=_||1;const{list:c,pageInfo:t}=await K.dbTableWebhookLogs.list(V.hook.id,{offset:i*(_-1),limit:i});E.value=M(c),F.value=t.totalRows??0}catch(c){te.error(await se(c))}}function M(_){var i,c;for(const t of _)t!=null&&t.response&&(t.response=C(t.response)),(c=(i=t==null?void 0:t.response)==null?void 0:i.config)!=null&&c.data&&(t.response.config.data=C(t.response.config.data)),t!=null&&t.payload&&(t.payload=C(t.payload)),t!=null&&t.notification&&(t.notification=C(t.notification));return _}return J(async()=>{I.value&&await S(m.value,y.value)}),(_,i)=>{const c=re,t=ie,P=oe,z=pe,G=ce,k=le,q=ue,H=_e,W=de;return a(B)?(s(),R(c,{key:0})):(s(),o("div",ye,[O(t,{class:"!mb-[20px]","body-style":{padding:"10px"}},{default:d(()=>[a(l).automationLogLevel===a(b).OFF?(s(),o("span",fe," The NC_AUTOMATION_LOG_LEVEL is set to “OFF”, no logs will be displayed. ")):p("",!0),a(l).automationLogLevel===a(b).ERROR?(s(),o("span",ve," The NC_AUTOMATION_LOG_LEVEL is set to “ERROR”, only error logs will be displayed. ")):p("",!0),a(l).automationLogLevel===a(b).ALL?(s(),o("span",xe,[a(l).ee?(s(),o("span",he," The NC_AUTOMATION_LOG_LEVEL is set to “ALL”, both error and success logs will be displayed. ")):(s(),o("span",we," Upgrade to Enterprise Edition to show all the logs. "))])):p("",!0),be]),_:1}),a(I)?(s(),o("div",Oe,[a(E).length?(s(),R(W,{key:1},{default:d(()=>[O(k,null,{default:d(()=>[O(G,{activeKey:a(T),"onUpdate:activeKey":i[0]||(i[0]=e=>A(T)?T.value=e:null),class:"nc-hook-log-collapse"},{default:d(()=>[(s(!0),o(Q,null,Z(a(E),(e,D)=>(s(),R(z,{key:D},{header:d(()=>{var f,v,x,h;return[n("div",ge,[n("div",Re,[n("div",Ce,r(e.type)+": records."+r(e.event)+"."+r(e.operation)+" ("+r(a(L)(e.created_at))+") ",1),e.type==="Email"?(s(),o("div",Ee,[e.error_message?(s(),o("div",Te,"ERROR")):(s(),o("div",Ae,"OK"))])):(s(),o("div",{key:1,class:ee(["mx-1 px-2 py-1 text-white rounded bg-red-500 text-xs",{"!bg-green-500":((f=e.response)==null?void 0:f.status)===200}])},r((v=e.response)==null?void 0:v.status)+" "+r(((x=e.response)==null?void 0:x.statusText)||(((h=e.response)==null?void 0:h.status)===200?"OK":"ERROR")),3))]),e.type==="URL"?(s(),o("div",Ne,[n("span",Fe,r(e.payload.method),1),N(" "+r(e.payload.path),1)])):p("",!0)])]}),default:d(()=>{var f,v,x,h,U;return[e.error_message?(s(),o("div",Ie,r(e.error_message),1)):p("",!0),e.type!=="Email"?(s(),o("div",Se,[(v=(f=e==null?void 0:e.response)==null?void 0:f.config)!=null&&v.headers?(s(),o("div",Ue,[Ve,n("pre",Ke,r(e.response.config.headers),1)])):p("",!0),(x=e==null?void 0:e.response)!=null&&x.headers?(s(),o("div",Be,[Me,n("pre",Pe,r(e.response.headers),1)])):p("",!0),(U=(h=e==null?void 0:e.response)==null?void 0:h.config)!=null&&U.data?(s(),o("div",ze,[Ge,n("pre",ke,r(e.response.config.data),1)])):p("",!0)])):(s(),o("div",qe,[e!=null&&e.payload?(s(),o("div",He,[We,n("pre",De,r(e.payload),1)])):p("",!0)]))]}),_:2},1024))),128))]),_:1},8,["activeKey"])]),_:1}),O(H,{class:"!bg-white text-center"},{default:d(()=>[O(q,{current:a(m),"onUpdate:current":i[1]||(i[1]=e=>A(m)?m.value=e:null),"page-size":a(y),"onUpdate:pageSize":i[2]||(i[2]=e=>A(y)?y.value=e:null),total:+a(F),"show-less-items":"",onChange:S},null,8,["current","page-size","total"])]),_:1})]),_:1})):(s(),R(P,{key:0}))])):p("",!0)]))}}});const At=me(Xe,[["__scopeId","data-v-51a3e688"]]);export{At as default};
