import{f as Ue,a5 as qe,$ as Ye,bb as T,bF as Ge,r as w,M as He,H as de,g as ue,eZ as ce,eX as O,gr as me,ad as Ke,c9 as Qe,o,P as m,w as $,O as e,T as v,a as r,S as pe,b as i,cb as Xe,au as Ze,d as fe,t as y,c as h,U as _e,V as ve,d4 as We,W as ye,a0 as j,a1 as B,n as M,X as Je,cZ as et,C as tt}from"./entry.96205fa0.js";import{_ as st}from"./Button.vue.02ce6d5b.js";import{_ as at}from"./Pagination.2fe08f8a.js";import{_ as lt}from"./Modal.vue.3dac5189.js";import{a as ot}from"./bases.965a49bb.js";import{C as nt,b as it,c as rt,p as dt,F as ge}from"./index.9b87fcff.js";import{o as xe,A as ut}from"./cell.810c4fd3.js";import{a as ct}from"./useLTARStore.444f4bbc.js";import{a as mt}from"./useSmartsheetRowStore.9c7d6fc1.js";import{e as pt}from"./dataUtils.fb0a3616.js";import{_ as ft}from"./plus.ddb9e9b9.js";import{_ as _t}from"./magnify.92946687.js";import{I as vt}from"./inbox.41f0ce87.js";import"./index.1431a68b.js";import{I as yt}from"./Input.3f1aaf0c.js";import{_ as gt}from"./Image.d07b34cf.js";import"./index.7e75edca.js";import{_ as xt}from"./Input.553ad305.js";import"./index.9e8f59f4.js";import"./debounce.1d5af9bf.js";import"./toNumber.ed208f2f.js";import"./isSymbol.d46b4957.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Icon.vue.6d0583a0.js";import"./Tooltip.vue.00c0d0fb.js";import"./index.b5e393d6.js";import"./toArray.3561b70e.js";import"./antInputDirective.8ac36ea7.js";import"./isMobile.e2e89480.js";import"./useMemo.dbc63a5f.js";import"./useState.5a301439.js";import"./CheckOutlined.3b90c20d.js";import"./SearchOutlined.c9794270.js";import"./FormItemContext.b19eb48c.js";import"./index.0c5b3837.js";import"./index.e034edbd.js";import"./useSharedView.9e320acb.js";import"./deepCompare.d32ec333.js";import"./virtualCell.9142cfee.js";import"./isPlainObject.631eb8fb.js";import"./_getPrototype.459a70cf.js";import"./TextArea.b81a19ed.js";import"./Password.803cc3dc.js";import"./Element.a2c5baa8.js";const wt=j(()=>B(()=>import("./Header.0e366f19.js"),["./Header.0e366f19.js","./Tooltip.vue.00c0d0fb.js","./entry.96205fa0.js","./entry.d09b2482.css","./Tooltip.b86f91a1.css"],import.meta.url).then(u=>u.default||u)),ht=j(()=>B(()=>import("./ListItem.7258b780.js"),["./ListItem.7258b780.js","./entry.96205fa0.js","./entry.d09b2482.css","./Icon.vue.6d0583a0.js","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./fileUtils.43128440.js","./useAttachment.30d26f9a.js","./urlUtils.15d0b9ce.js","./index.c4d36e30.js","./index.e1ceba77.js","./Dropdown.1dedd322.js","./useState.5a301439.js","./useRefs.3fea1e39.js","./identity.309e9ead.js","./_flatRest.ce557a88.js","./isMobile.e2e89480.js","./index.208c1883.js","./Col.b3c5d725.js","./responsiveObserve.358bcfe9.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./index.c969316f.js","./ListItem.65cb6b25.css"],import.meta.url).then(u=>u.default||u)),kt=j(()=>B(()=>import("./index.3faef5cb.js").then(u=>u.i),["./index.3faef5cb.js","./entry.96205fa0.js","./entry.d09b2482.css","./Button.vue.02ce6d5b.js","./index.9e8f59f4.js","./debounce.1d5af9bf.js","./toNumber.ed208f2f.js","./isSymbol.d46b4957.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Icon.vue.6d0583a0.js","./Menu.vue.55c6ca4d.js","./Menu.eff4a609.css","./Divider.82129fc6.js","./index.c968c966.js","./Divider.3e739d27.css","./Dropdown.vue.93f98e1e.js","./index.6c1d17b6.js","./Dropdown.1dedd322.js","./RightOutlined.3ce786f5.js","./DivDataCell.7110991f.js","./index.9b87fcff.js","./DivDataCell.1a716a1e.css","./Tooltip.vue.00c0d0fb.js","./Tooltip.b86f91a1.css","./UserIcon.7f59375b.js","./UserIcon.fda3e825.css","./config.bc9920dc.js","./sidebar.30294def.js","./bases.965a49bb.js","./index.0c5b3837.js","./views.2c163cf7.js","./useSharedView.9e320acb.js","./dataUtils.fb0a3616.js","./index.e034edbd.js","./useKanbanViewStore.4bcd49a7.js","./deepCompare.d32ec333.js","./useSmartsheetStore.7d51347e.js","./useSmartsheetRowStore.9c7d6fc1.js","./virtualCell.9142cfee.js","./iconify.e008aad7.js","./index.1431a68b.js","./Input.3f1aaf0c.js","./antInputDirective.8ac36ea7.js","./FormItemContext.b19eb48c.js","./SearchOutlined.c9794270.js","./isPlainObject.631eb8fb.js","./_getPrototype.459a70cf.js","./TextArea.b81a19ed.js","./Password.803cc3dc.js","./Modal.vue.3dac5189.js","./DeleteModal.7ab6f524.css","./DeleteModal.vue.49c1a59b.js","./Modal.vue.b787f37f.js","./useDashboard.0f55d174.js","./index.a5de28c1.js","./Input.553ad305.js","./Element.a2c5baa8.js","./index.35cd520e.css"],import.meta.url).then(u=>u.default||u)),bt={class:"flex mt-2 mb-2 items-center gap-2"},It=r("div",{class:"flex-1"},null,-1),Rt={class:"flex items-center gap-1 px-4"},zt={key:1,class:"overflow-scroll nc-scrollbar-md pr-1 cursor-pointer flex flex-col flex-grow"},Lt={class:"flex flex-col m-[.5rem] gap-2 flex-grow justify-center"},Nt={class:"flex flex-row gap-6 w-10/12"},Ct={class:"flex flex-col gap-0.5"},Vt={class:"flex flex-col gap-0.5"},At={class:"flex flex-col gap-0.5"},Et={class:"flex flex-col gap-0.5"},St={key:2,class:"my-auto py-2 flex flex-col gap-3 items-center justify-center text-gray-500"},Tt={key:3,class:"flex flex-row justify-center items-center w-full my-2"},$t=r("div",{class:"mb-2 bg-gray-50 border-gray-50 border-b-2"},null,-1),Ft={class:"flex flex-row justify-between items-center bg-white relative pt-1"},Pt={key:0,class:"flex items-center justify-center px-2 rounded-md text-gray-500 bg-brand-50 h-9.5"},Ot={class:"!xs:hidden flex absolute -mt-0.75 items-center py-2 justify-center w-full"},As=Ue({__name:"ListItems",props:{modelValue:{type:Boolean},column:{}},emits:["update:modelValue","addNewRecord"],setup(u,{emit:we}){const g=qe(u,"modelValue",we),{isMobileMode:k}=Ye(),c=T(nt),{isSharedBase:he}=Ge(ot()),ke=w(),{t:D}=He(),{$e:U}=tt(),{childrenExcludedList:b,isChildrenExcludedListLinked:N,isChildrenExcludedListLoading:be,isChildrenExcludedLoading:q,childrenListCount:Y,loadChildrenExcludedList:G,loadChildrenList:H,childrenExcludedListPagination:n,relatedTableDisplayValueProp:K,displayValueTypeAndFormatProp:Ie,link:Re,relatedTableMeta:d,meta:Q,unlink:ze,row:p,headerDisplayValue:Le}=ct(),{addLTARRef:Ne,isNew:F,removeLTARRef:Ce,state:X}=mt(),Ve=T(it,w(!1)),C=w(!1);q.value=!0;const R=T(rt,w(!1)),Z=T(dt,()=>{}),P=w(!1),Ae=async(s,t)=>{F.value?(Ne(s,c==null?void 0:c.value),N.value[t]=!0,Z(),U("a:links:link")):await Re(s,{},!1,t)},Ee=async(s,t)=>{F.value?(Ce(s,c==null?void 0:c.value),N.value[t]=!1,Z(),U("a:links:unlink")):await ze(s,{},!1,t)};de(g,(s,t)=>{s&&!t&&(n.query="",n.page=1,R.value||H(),G(X.value))},{immediate:!0});const f=w(!1),z=w({}),Se=ue(()=>{var V,A,E,L;if(F.value)return{};const s=(V=c==null?void 0:c.value)==null?void 0:V.colOptions,t=(E=(A=d==null?void 0:d.value)==null?void 0:A.columns)==null?void 0:E.find(I=>{if(!ce(I))return!1;const l=I==null?void 0:I.colOptions;return(l==null?void 0:l.fk_related_model_id)!==Q.value.id?!1:s.type===O.MANY_TO_MANY&&(l==null?void 0:l.type)===O.MANY_TO_MANY?s.fk_parent_column_id===l.fk_child_column_id&&s.fk_child_column_id===l.fk_parent_column_id:s.fk_parent_column_id===l.fk_parent_column_id&&s.fk_child_column_id===l.fk_child_column_id});if(!t)return{};const x=t==null?void 0:t.colOptions;return x?x.type===O.BELONGS_TO?{[t.title]:(L=p==null?void 0:p.value)==null?void 0:L.row}:{[t.title]:(p==null?void 0:p.value)&&[p.value.row]}:{}}),Te=me(ge,s=>(d.value.columns??[]).filter(t=>xe(t))[0]),$e=me(ge,s=>(d.value.columns??[]).filter(t=>!et(t)&&!ut(t)&&!ce(t)&&!xe(t)).slice(0,k.value?1:4)),W=ue(()=>{var s,t;return(t=(s=c.value)==null?void 0:s.colOptions)==null?void 0:t.type});de(f,()=>{f.value||(C.value=!1,R.value||H(),G(X.value))}),Ke("Escape",()=>{g.value=!1});const Fe=(s,t)=>{he.value||(N.value[Number.parseInt(t)]?Ee(s,Number.parseInt(t)):Ae(s,Number.parseInt(t)))},Pe=()=>{z.value={},f.value=!0,C.value=!0},Oe=s=>{var x;const t=M("div",{class:"ml-1 inline-flex flex-col gap-1 items-start"},[M("span",{class:"font-semibold"},D("activity.recordCreatedLinked")),M("span",{class:"text-gray-500"},D("activity.gotSavedLinkedSuccessfully",{tableName:(x=d.value)==null?void 0:x.title,recordTitle:s[K.value]}))]);Je.success(t)};return(s,t)=>{const x=wt,V=_t,A=yt,E=ft,L=st,I=gt,l=xt,Me=ht,J=at,je=kt,Be=lt,De=Qe("e");return o(),m(Be,{visible:e(g),"onUpdate:visible":t[11]||(t[11]=S=>ye(g)?g.value=S:null),class:pe({active:e(g)}),footer:null,width:e(R)?600:800,closable:!1,"body-style":{"max-height":"640px",height:"85vh"},"wrap-class-name":"nc-modal-link-record"},{default:$(()=>{var S,ee,te,se,ae,le,oe,ne,ie,re;return[e(R)?v("",!0):(o(),m(x,{key:0,relation:e(W),"table-title":(S=e(Q))==null?void 0:S.title,"related-table-title":(ee=e(d))==null?void 0:ee.title,"display-value":e(Le),header:s.$t("activity.addNewLink")},null,8,["relation","table-title","related-table-title","display-value","header"])),r("div",bt,[r("div",{class:pe(["flex items-center border-1 p-1 rounded-md w-full border-gray-200",{"!border-primary":e(n).query.length!==0||e(P)}])},[i(V,{class:"w-5 h-5 ml-2 text-gray-500"}),i(A,{ref_key:"filterQueryRef",ref:ke,value:e(n).query,"onUpdate:value":t[0]||(t[0]=a=>e(n).query=a),placeholder:`${s.$t("general.searchIn")} ${(te=e(d))==null?void 0:te.title}`,class:"w-full !rounded-md nc-excluded-search xs:min-h-8",size:"small",bordered:!1,onFocus:t[1]||(t[1]=a=>P.value=!0),onBlur:t[2]||(t[2]=a=>P.value=!1),onKeydownCapture:t[3]||(t[3]=Xe(()=>{},["stop"])),onChange:t[4]||(t[4]=a=>e(n).page=1)},null,8,["value","placeholder"])],2),It,e(Ve)?v("",!0):Ze((o(),m(L,{key:0,type:"secondary",size:e(k)?"medium":"small",class:"!text-brand-500",onClick:Pe},{default:$(()=>[r("div",Rt,[e(k)?v("",!0):(o(),m(E,{key:0})),fe(" "+y(s.$t("activity.newRecord")),1)])]),_:1},8,["size"])),[[De,["c:row-expand:open"]]])]),(ae=(se=e(b))==null?void 0:se.pageInfo)!=null&&ae.totalRows?(o(),h("div",zt,[e(q)?(o(!0),h(_e,{key:0},ve(Array.from({length:10}),(a,_)=>(o(),h("div",{key:_,class:"!border-2 flex flex-row gap-2 mb-2 transition-all !rounded-xl relative !border-gray-200 hover:bg-gray-50"},[i(I,{class:"h-24 w-24 !rounded-xl"}),r("div",Lt,[i(l,{class:"!xs:w-30 !w-48 !rounded-xl",active:"",size:"small"}),r("div",Nt,[r("div",Ct,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})]),r("div",Vt,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})]),r("div",At,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})]),r("div",Et,[i(l,{class:"!h-4 !w-12",active:"",size:"small"}),i(l,{class:"!xs:hidden !h-4 !w-24",active:"",size:"small"})])])])]))),128)):(o(!0),h(_e,{key:1},ve(((le=e(b))==null?void 0:le.list)??[],(a,_)=>(o(),m(Me,{key:_,"data-testid":"nc-excluded-list-item",row:a,fields:e($e),attachment:e(Te),"related-table-display-value-prop":e(K),"display-value-type-and-format-prop":e(Ie),"is-loading":e(be)[Number.parseInt(_)],"is-linked":e(N)[Number.parseInt(_)],onExpand:()=>{z.value=a,f.value=!0},onClick:()=>Fe(a,_)},null,8,["row","fields","attachment","related-table-display-value-prop","display-value-type-and-format-prop","is-loading","is-linked","onExpand","onClick"]))),128))])):(o(),h("div",St,[i(e(vt),{class:"w-16 h-16 mx-auto"}),r("p",null,y(s.$t("msg.thereAreNoRecordsInTable"))+" "+y((oe=e(d))==null?void 0:oe.title),1)])),e(k)?(o(),h("div",Tt,[(ne=e(b))!=null&&ne.pageInfo?(o(),m(J,{key:0,current:e(n).page,"onUpdate:current":t[5]||(t[5]=a=>e(n).page=a),"page-size":e(n).size,"onUpdate:pageSize":t[6]||(t[6]=a=>e(n).size=a),total:+e(b).pageInfo.totalRows,"entity-name":"links-excluded-list"},null,8,["current","page-size","total"])):v("",!0)])):v("",!0),$t,r("div",Ft,[e(R)?v("",!0):(o(),h("div",Pt,y(e(W)==="bt"?e(p).row[(ie=e(d))==null?void 0:ie.title]?"1":0:e(Y)??"No")+" "+y(e(k)?"":s.$t("objects.records"))+" "+y(!e(k)&&e(Y)!==0?"are":"")+" "+y(s.$t("general.linked")),1)),r("div",Ot,[(re=e(b))!=null&&re.pageInfo?(o(),m(J,{key:0,current:e(n).page,"onUpdate:current":t[7]||(t[7]=a=>e(n).page=a),"page-size":e(n).size,"onUpdate:pageSize":t[8]||(t[8]=a=>e(n).size=a),total:+e(b).pageInfo.totalRows,"entity-name":"links-excluded-list",mode:"simple"},null,8,["current","page-size","total"])):v("",!0)]),i(L,{class:"nc-close-btn ml-auto",type:"ghost",onClick:t[9]||(t[9]=a=>g.value=!1)},{default:$(()=>[fe(y(s.$t("general.finish")),1)]),_:1})]),(o(),m(We,null,{default:$(()=>{var a;return[e(f)?(o(),m(je,{key:0,modelValue:e(f),"onUpdate:modelValue":t[10]||(t[10]=_=>ye(f)?f.value=_:null),meta:e(d),row:{row:e(z),oldRow:{},rowMeta:Object.keys(e(z)).length>0?{}:{new:!0}},"row-id":("extractPkFromRow"in s?s.extractPkFromRow:e(pt))(e(z),e(d).columns),state:e(Se),"use-meta-fields":"","close-after-save":e(C),"new-record-header":e(C)?s.$t("activity.tableNameCreateNewRecord",{tableName:(a=e(d))==null?void 0:a.title}):void 0,onCreatedRecord:Oe},null,8,["modelValue","meta","row","row-id","state","close-after-save","new-record-header"])):v("",!0)]}),_:1}))]}),_:1},8,["visible","class","width"])}}});export{As as default};
