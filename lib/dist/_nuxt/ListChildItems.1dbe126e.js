import{f as Ue,a5 as qe,$ as He,bb as M,r as b,bF as Ke,H as O,gs as re,g as C,ad as Ze,c9 as Ge,o as l,P as u,w as L,O as e,T as c,c as p,a,S as de,b as r,cb as Qe,U as ue,V as me,t as d,au as ce,d as B,d4 as We,W as pe,a0 as U,a1 as q,p as Je,e as Xe,cZ as Ye,eZ as et}from"./entry.5958c07b.js";import{_ as tt}from"./Button.vue.c3ca0e8f.js";import{_ as st}from"./Pagination.c0f166a7.js";import{_ as ot}from"./Modal.vue.0f13e4cb.js";import{a as lt}from"./bases.e6c8e3c4.js";import{c as at,b as it,C as nt,i as rt,F as fe}from"./index.9b87fcff.js";import{o as _e,A as dt}from"./cell.165313cd.js";import{a as ut}from"./useLTARStore.59a45d45.js";import{a as mt}from"./useSmartsheetRowStore.5b92cc1b.js";import{e as ct}from"./dataUtils.3f874ca1.js";import{_ as pt}from"./plus.dc1af860.js";import{_ as ft}from"./magnify.3b643360.js";import{I as _t}from"./inbox.954d1e59.js";import"./index.ae235b22.js";import{I as vt}from"./Input.dca3a2bc.js";import{_ as yt}from"./Image.c63a7a56.js";import{_ as gt}from"./Input.8209df88.js";import{_ as ht}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.55641318.js";import"./debounce.7c24f171.js";import"./toNumber.e09cd85a.js";import"./isSymbol.114fe557.js";import"./Icon.vue.129448d5.js";import"./Tooltip.vue.971897f4.js";import"./index.5c6e4286.js";import"./toArray.fd74ce6f.js";import"./antInputDirective.8ac36ea7.js";import"./isMobile.e2e89480.js";import"./useMemo.1dd071d8.js";import"./useState.b891c8bb.js";import"./CheckOutlined.1fe5f230.js";import"./SearchOutlined.a517903c.js";import"./FormItemContext.ddc65fa5.js";import"./index.0feaca99.js";import"./index.e61e381a.js";import"./useSharedView.e8f68616.js";import"./deepCompare.d32ec333.js";import"./virtualCell.427fa223.js";import"./isPlainObject.ccda79fe.js";import"./_getPrototype.c1f3bae2.js";import"./TextArea.9074ff05.js";import"./Password.f52125e7.js";import"./Element.a1e4f356.js";const wt=U(()=>q(()=>import("./Header.941366bc.js"),["./Header.941366bc.js","./Tooltip.vue.971897f4.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Tooltip.b86f91a1.css"],import.meta.url).then(i=>i.default||i)),kt=U(()=>q(()=>import("./ListItem.a1950751.js"),["./ListItem.a1950751.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Icon.vue.129448d5.js","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./index.9b87fcff.js","./fileUtils.43128440.js","./useAttachment.6cac8464.js","./urlUtils.18c797fa.js","./index.f98c1d80.js","./index.912f77e8.js","./Dropdown.041b2468.js","./useState.b891c8bb.js","./useRefs.40c81887.js","./identity.34c7640e.js","./_flatRest.39582a58.js","./isMobile.e2e89480.js","./index.357e1bba.js","./Col.a97e3e76.js","./responsiveObserve.0baefba6.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./index.bed897b5.js","./ListItem.65cb6b25.css"],import.meta.url).then(i=>i.default||i)),bt=U(()=>q(()=>import("./index.caa4cb22.js").then(i=>i.i),["./index.caa4cb22.js","./entry.5958c07b.js","./entry.bdecbb78.css","./Button.vue.c3ca0e8f.js","./index.55641318.js","./debounce.7c24f171.js","./toNumber.e09cd85a.js","./isSymbol.114fe557.js","./_plugin-vue_export-helper.c27b6911.js","./Button.ff10bcb0.css","./Icon.vue.129448d5.js","./Menu.vue.6c65c050.js","./Menu.eff4a609.css","./Divider.7b1fba82.js","./index.07078df6.js","./Divider.3e739d27.css","./Dropdown.vue.0d2ed10f.js","./index.dc13a4d6.js","./Dropdown.041b2468.js","./RightOutlined.7161c742.js","./DivDataCell.7c09732c.js","./index.9b87fcff.js","./DivDataCell.1a716a1e.css","./Tooltip.vue.971897f4.js","./Tooltip.b86f91a1.css","./UserIcon.74e37fbe.js","./UserIcon.fda3e825.css","./config.c8203633.js","./sidebar.f5d81718.js","./bases.e6c8e3c4.js","./index.0feaca99.js","./views.4281cbf1.js","./useSharedView.e8f68616.js","./dataUtils.3f874ca1.js","./index.e61e381a.js","./useKanbanViewStore.9f7f1dc5.js","./deepCompare.d32ec333.js","./useSmartsheetStore.f1a70558.js","./useSmartsheetRowStore.5b92cc1b.js","./virtualCell.427fa223.js","./iconify.e2b5aaa4.js","./index.ae235b22.js","./Input.dca3a2bc.js","./antInputDirective.8ac36ea7.js","./FormItemContext.ddc65fa5.js","./SearchOutlined.a517903c.js","./isPlainObject.ccda79fe.js","./_getPrototype.c1f3bae2.js","./TextArea.9074ff05.js","./Password.f52125e7.js","./Modal.vue.0f13e4cb.js","./DeleteModal.7ab6f524.css","./DeleteModal.vue.0320a9db.js","./Modal.vue.ee5af191.js","./useDashboard.7eae7d45.js","./index.c35df397.js","./Input.8209df88.js","./Element.a1e4f356.js","./index.35cd520e.css"],import.meta.url).then(i=>i.default||i)),xt=i=>(Je("data-v-b60081ae"),i=i(),Xe(),i),It={key:1,class:"flex mt-2 mb-2 items-center gap-2"},Rt={class:"flex flex-col flex-grow nc-scrollbar-md cursor-pointer pr-1"},zt={key:0,class:"mt-2 mb-2"},Ct={class:"cursor-pointer pr-1"},Lt={class:"flex flex-col m-[.5rem] gap-2 flex-grow justify-center"},$t={class:"flex flex-row gap-6 w-10/12"},Vt={class:"flex flex-col gap-0.5"},Tt={class:"flex flex-col gap-0.5"},St={class:"flex flex-col gap-0.5"},Ft={class:"flex flex-col gap-0.5"},Pt={key:1,class:"pt-1 flex flex-col gap-3 my-auto items-center justify-center text-gray-500"},Mt={class:"flex items-center gap-1"},jt={key:2,class:"flex flex-row justify-center items-center w-full my-2"},At=xt(()=>a("div",{class:"my-2 bg-gray-50 border-gray-50 border-b-2"},null,-1)),Et={class:"flex flex-row justify-between bg-white relative pt-1"},Dt={key:0,class:"flex items-center justify-center px-2 rounded-md text-gray-500 bg-brand-50"},Nt={key:1,class:"flex items-center justify-center px-2 rounded-md text-gray-500 bg-brand-50"},Ot={class:""},Bt={class:"!xs:hidden flex absolute -mt-0.75 items-center py-2 justify-center w-full"},Ut={class:"flex flex-row gap-2"},qt={class:"flex items-center gap-1"},Ht=Ue({__name:"ListChildItems",props:{modelValue:{type:Boolean},cellValue:{},column:{},items:{}},emits:["update:modelValue","attachRecord"],setup(i,{emit:ve}){const R=i,j=ve,y=qe(R,"modelValue",j),{isMobileMode:z}=He(),g=M(at,b(!1)),ye=M(it,b(!1)),f=M(nt,b()),$=M(rt,b(!1)),{isSharedBase:ge}=Ke(lt()),{childrenList:h,childrenListCount:_,loadChildrenList:A,childrenListPagination:n,relatedTableDisplayValueProp:he,displayValueTypeAndFormatProp:we,unlink:ke,isChildrenListLoading:be,isChildrenListLinked:H,isChildrenLoading:E,relatedTableMeta:w,link:xe,meta:Ie,headerDisplayValue:Re}=ut(),{isNew:v,state:V,removeLTARRef:ze,addLTARRef:Ce}=mt();O([y,g],s=>{(s[0]||s[1])&&!v.value&&A()},{immediate:!0});const Le=async(s,t)=>{v.value?await ze(s,f==null?void 0:f.value):await ke(s,{},!1,t)},$e=async(s,t)=>{v.value?await Ce(s,f==null?void 0:f.value):await xe(s,{},!1,t)},Ve=re(fe,s=>(w.value.columns??[]).filter(t=>_e(t))[0]),D=b(!1),Te=re(fe,s=>(w.value.columns??[]).filter(t=>!Ye(t)&&!dt(t)&&!et(t)&&!_e(t)).slice(0,z.value?1:4)),k=b(!1),x=b({}),T=C(()=>{var s;return((s=f.value)==null?void 0:s.title)||""}),Se=s=>{$.value||(x.value=s,k.value=!0)},Fe=C(()=>{var s,t;return(t=(s=f.value)==null?void 0:s.colOptions)==null?void 0:t.type});O(()=>R.cellValue,()=>{v.value&&A()}),O(k,()=>{k.value||A()}),Ze("Escape",()=>{y.value=!1});const Pe=C(()=>R.items<10&&n.page===1?R.items:_.value<10&&n.page===1?_.value||10:Math.ceil(_.value/10)===n.page?_.value%10:10),K=C(()=>E.value?R.items:_.value),Me=C(()=>{var s,t,S,F;return((t=(s=h.value)==null?void 0:s.pageInfo)==null?void 0:t.totalRows)||v.value&&((F=(S=V.value)==null?void 0:S[T.value])==null?void 0:F.length)}),je=(s,t)=>{ge.value||$.value||ye.value&&!g.value||(v.value||H.value[parseInt(t)]?Le(s,parseInt(t)):$e(s,parseInt(t)))};return(s,t)=>{const S=wt,F=ft,Ae=vt,Ee=yt,m=gt,De=kt,Z=pt,N=tt,G=st,Ne=bt,Oe=ot,Q=Ge("e");return l(),u(Oe,{visible:e(y),"onUpdate:visible":t[13]||(t[13]=P=>pe(y)?y.value=P:null),class:de({active:e(y)}),footer:null,closable:!1,size:"medium",width:e(g)?600:800,"body-style":{"max-height":"640px",height:"85vh"},"wrap-class-name":"nc-modal-child-list"},{default:L(()=>{var P,W,J,X,Y,ee,te,se,oe,le,ae,ie;return[e(g)?c("",!0):(l(),u(S,{key:0,relation:e(Fe),"linked-records":e(_),"table-title":(P=e(Ie))==null?void 0:P.title,header:s.$t("activity.linkedRecords"),"related-table-title":(W=e(w))==null?void 0:W.title,"display-value":e(Re)},null,8,["relation","linked-records","table-title","header","related-table-title","display-value"])),e(g)?c("",!0):(l(),p("div",It,[a("div",{class:de(["flex items-center border-1 p-1 rounded-md w-full border-gray-200",{"!border-primary":e(n).query.length!==0||e(D)}])},[r(F,{class:"w-5 h-5 ml-2"}),r(Ae,{ref:"filterQueryRef",value:e(n).query,"onUpdate:value":t[0]||(t[0]=o=>e(n).query=o),placeholder:`Search in ${(J=e(w))==null?void 0:J.title}`,class:"w-full !sm:rounded-md xs:min-h-8 !xs:rounded-xl",size:"small",bordered:!1,onFocus:t[1]||(t[1]=o=>D.value=!0),onBlur:t[2]||(t[2]=o=>D.value=!1),onKeydownCapture:t[3]||(t[3]=Qe(()=>{},["stop"])),onChange:t[4]||(t[4]=o=>e(n).page=1)},null,8,["value","placeholder"])],2)])),a("div",Rt,[e(Me)||e(E)?(l(),p("div",zt,[a("div",Ct,[e(E)?(l(!0),p(ue,{key:0},me(Array.from({length:e(Pe)}),(o,I)=>(l(),p("div",{key:I,class:"!border-2 flex flex-row gap-2 mb-2 transition-all !rounded-xl relative !border-gray-200 hover:bg-gray-50"},[r(Ee,{class:"h-24 w-24 !rounded-xl"}),a("div",Lt,[r(m,{class:"!w-48 !rounded-xl",active:"",size:"small"}),a("div",$t,[a("div",Vt,[r(m,{class:"!h-4 !w-12",active:"",size:"small"}),r(m,{class:"!h-4 !w-24",active:"",size:"small"})]),a("div",Tt,[r(m,{class:"!h-4 !w-12",active:"",size:"small"}),r(m,{class:"!h-4 !w-24",active:"",size:"small"})]),a("div",St,[r(m,{class:"!h-4 !w-12",active:"",size:"small"}),r(m,{class:"!h-4 !w-24",active:"",size:"small"})]),a("div",Ft,[r(m,{class:"!h-4 !w-12",active:"",size:"small"}),r(m,{class:"!h-4 !w-24",active:"",size:"small"})])])])]))),128)):(l(!0),p(ue,{key:1},me(((X=e(h))==null?void 0:X.list)??((Y=e(V))==null?void 0:Y[e(T)])??[],(o,I)=>{var ne;return l(),u(De,{key:I,row:o,fields:e(Te),"data-testid":"nc-child-list-item",attachment:e(Ve),"related-table-display-value-prop":e(he),"display-value-type-and-format-prop":e(we),"is-linked":(ne=e(h))!=null&&ne.list?e(H)[Number.parseInt(I)]:!0,"is-loading":e(be)[Number.parseInt(I)],onExpand:Be=>Se(o),onClick:Be=>je(o,I)},null,8,["row","fields","attachment","related-table-display-value-prop","display-value-type-and-format-prop","is-linked","is-loading","onExpand","onClick"])}),128))])])):(l(),p("div",Pt,[r(e(_t),{class:"w-16 h-16 mx-auto"}),a("p",null,d(s.$t("msg.noRecordsAreLinkedFromTable"))+" "+d((ee=e(w))==null?void 0:ee.title),1),!e($)&&e(_)<1?ce((l(),u(N,{key:0,"data-testid":"nc-child-list-button-link-to",onClick:t[5]||(t[5]=o=>j("attachRecord"))},{default:L(()=>[a("div",Mt,[r(Z),B(" "+d(s.$t("title.linkMoreRecords")),1)])]),_:1})),[[Q,["c:links:link"]]]):c("",!0)]))]),e(z)?(l(),p("div",jt,[!e(v)&&((te=e(h))!=null&&te.pageInfo)?(l(),u(G,{key:0,current:e(n).page,"onUpdate:current":t[6]||(t[6]=o=>e(n).page=o),"page-size":e(n).size,"onUpdate:pageSize":t[7]||(t[7]=o=>e(n).size=o),total:+e(h).pageInfo.totalRows},null,8,["current","page-size","total"])):c("",!0)])):c("",!0),At,a("div",Et,[e(g)?(l(),p("div",Nt,[a("span",Ot,d(((oe=(se=e(V))==null?void 0:se[e(T)])==null?void 0:oe.length)||0)+" "+d(s.$t("objects.records"))+" "+d(((ae=(le=e(V))==null?void 0:le[e(T)])==null?void 0:ae.length)!==0?s.$t("general.are"):"")+" "+d(s.$t("general.linked")),1)])):(l(),p("div",Dt,d(e(K)||0)+" "+d(e(z)?"":s.$t("objects.records"))+" "+d(!e(z)&&e(K)!==0?s.$t("general.are"):"")+" "+d(s.$t("general.linked")),1)),a("div",Bt,[!e(v)&&((ie=e(h))!=null&&ie.pageInfo)?(l(),u(G,{key:0,current:e(n).page,"onUpdate:current":t[8]||(t[8]=o=>e(n).page=o),"page-size":e(n).size,"onUpdate:pageSize":t[9]||(t[9]=o=>e(n).size=o),total:+e(h).pageInfo.totalRows,mode:"simple"},null,8,["current","page-size","total"])):c("",!0)]),a("div",Ut,[e(g)?c("",!0):(l(),u(N,{key:0,type:"ghost",class:"nc-close-btn",onClick:t[10]||(t[10]=o=>y.value=!1)},{default:L(()=>[B(d(s.$t("general.finish")),1)]),_:1})),!e($)&&e(_)>0?ce((l(),u(N,{key:1,"data-testid":"nc-child-list-button-link-to",onClick:t[11]||(t[11]=o=>j("attachRecord"))},{default:L(()=>[a("div",qt,[r(Z,{class:"!xs:hidden"}),B(" "+d(e(z)?s.$t("title.linkMore"):s.$t("title.linkMoreRecords")),1)])]),_:1})),[[Q,["c:links:link"]]]):c("",!0)])]),(l(),u(We,null,{default:L(()=>[e(x)&&e(k)?(l(),u(Ne,{key:0,modelValue:e(k),"onUpdate:modelValue":t[12]||(t[12]=o=>pe(k)?k.value=o:null),meta:e(w),row:{row:e(x),oldRow:e(x),rowMeta:Object.keys(e(x)).length>0?{}:{new:!0}},"row-id":("extractPkFromRow"in s?s.extractPkFromRow:e(ct))(e(x),e(w).columns),"use-meta-fields":""},null,8,["modelValue","meta","row","row-id"])):c("",!0)]),_:1}))]}),_:1},8,["visible","class","width"])}}});const Ms=ht(Ht,[["__scopeId","data-v-b60081ae"]]);export{Ms as default};
